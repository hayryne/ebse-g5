<!DOCTYPE html><html><div class="item-title">
        Item 10
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
   * Copy the byte array given in parameter and return an instance 
   * of a new byte array with the same length and the same content.
   * @param bytes the byte array to duplicate
   * @return a copy of the given byte array 
   
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HBASE-6352 Add copy method in Bytes
                </div><div><b>message:</b> HBASE-6352 Add copy method in Bytes

git-svn-id: https://svn.apache.org/repos/asf/hbase/trunk@1381670 13f79535-47bb-0310-9956-ffa450edef68

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Add copy method in Bytes
                </div><div><b>description:</b> Having a "copy" method into Bytes might be nice to reduce client code size and improve readability.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                Patch to add a copy method into the Bytes class
              </div></li><li><div>
                Patch to add a copy method into the Bytes class
              </div></li><li><div>
                -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12535518/HBASE_JIRA_6352.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/2343//console

This message is automatically generated.
              </div></li><li><div><div><b>body:</b> Patch looks good.  The formatting is off.  No tabs in hbase codebase.  We use two spaces instead.  Follow also the spacing you see in the rest of the code base: i.e. a space between ')' and the opening '{'.  Good stuff Jean-Marc.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Updated version based on Stack's comments.
              </div></li><li><div>
                -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12535522/HBASE_JIRA_6352_v2.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/2344//console

This message is automatically generated.
              </div></li><li><div>
                @Jean-Marc:
Can you include a small example of how the copy method reduces client size ?
              </div></li><li><div>
                [~zhihyu@ebaysf.com]Here is a simple example:
byte[] endKey = Bytes.copy (startKey);
endKey[endKey.length - 1]++;
Scan scan = new Scan (startKey, endKey);

I know that if the last byte is 255 this will cause and issue but it's just for the example. Also, I will provide soon another suggestion to have a methode that increase the last byte of the array safely. It's usefull when workin with the scans (I think).
              </div></li><li><div><div><b>body:</b> I wasn't able to find the above code snippet under src/main or src/test
Can you point me to the file ?

It would be nice if you use the copy method to simplify that code.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Patch looks good Jean-Marc.
              </div></li><li><div><div><b>body:</b> @Zhihong: I don't have an specific place to point to. Bytes is used a lot on the client side to access HBase. So the idea there was to simplify this client side. Not really the server side.

Attached is an updated version with the spaces added before the [] and a test for null.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12535538/HBASE_JIRA_6352_v3.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/2345//console

This message is automatically generated.
              </div></li><li><div><div><b>body:</b> {code}
+   * @param source the byte array do duplicate
+   */
{code}
Please add @return for the return value.
{code}
+    System.arraycopy(source, source.length, result, 0, source.length);   
+ return tail (source, source.length);
{code}
Indentation for return statement is off.

Since this JIRA is marked as improvement, a patch for trunk should be generated.

Thanks
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>body:</b> Updated patch with one typo corrected in the comments, @return added and test procedure.

Also applied it to the trunk.
                </div><div><b>label:</b> documentation
                </div></div></li><li><div>
                -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12535546/HBASE_JIRA_6352_v4.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    -1 javac.  The applied patch generated 5 javac compiler warnings (more than the trunk's current 4 warnings).

    -1 findbugs.  The patch appears to introduce 7 new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

     -1 core tests.  The patch failed these unit tests:
                       org.apache.hadoop.hbase.replication.TestReplication
                  org.apache.hadoop.hbase.regionserver.TestSplitLogWorker

Test results: https://builds.apache.org/job/PreCommit-HBASE-Build/2347//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/2347//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/2347//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html
Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/2347//console

This message is automatically generated.
              </div></li><li><div>
                Can this be closed?
              </div></li><li><div>
                Hi Michael,

I don't know if the patch has been applied, so I don't know if it can be closed or not.

JM
              </div></li><li><div>
                What I applied.
              </div></li><li><div>
                Applied to trunk.  Thanks for the patch Jean-Marc.  I was unconvinced it added anything at first but looking through code, it could save us a couple of lines in lots of places. I added you as a contributor.  I assigned this issue to you.  Are there others we should assign you?  Thanks Michael for bringing this back to our attention.
              </div></li><li><div>
                Integrated in HBase-TRUNK #3310 (See [https://builds.apache.org/job/HBase-TRUNK/3310/])
    HBASE-6352 Add copy method in Bytes (Revision 1381670)

     Result = FAILURE
stack : 
Files : 
* /hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/util/Bytes.java
* /hbase/trunk/hbase-common/src/test/java/org/apache/hadoop/hbase/util/TestBytes.java

              </div></li><li><div>
                Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #163 (See [https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/163/])
    HBASE-6352 Add copy method in Bytes (Revision 1381670)

     Result = FAILURE
stack : 
Files : 
* /hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/util/Bytes.java
* /hbase/trunk/hbase-common/src/test/java/org/apache/hadoop/hbase/util/TestBytes.java

              </div></li><li><div>
                Long time I have not looked at this JIRA. Thanks stack to have added me as a contributor. On the 2 status from Sep 6th and 7th, the result is FAILURE, but I can see on the trunk that the change is there. Is it normal to have a failure status then? Regarding taking other JIRAs, I will take a look at see what is open..
              </div></li><li><div>
                [~jmspaggi] Ignore the FAILURE state.  Unit test failures unrelated to your patch.  The FAILURE is more frequent than we would like.  Regards other JIRAs, I was just wondering if you had fixed others and if so I need to assign them retroactively to you so you get your credit for contribs done (I wasn't poking you to do more work -- smile).
              </div></li><li><div>
                Marking closed.
              </div></li></ol></div></div></html>