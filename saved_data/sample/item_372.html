<!DOCTYPE html><html><div class="item-title">
        Item 372
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                ***
 * ##################################################################
 *  API functions for user-defined processor
 * ##################################################################
 
              </div></li><li><div>
                 OnTrigger method, implemented by MiNiFi CallbackProcessor
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> MINIFICPP-694 - Ensure that processor consist of proper phases
                </div><div><b>message:</b> MINIFICPP-694 - Ensure that processor consist of proper phases

This closes #536.

Signed-off-by: Marc Parisi &lt;phrocker@apache.org&gt;

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> MINIFICPP-694 - Ensure that processor consist of proper phases
                </div><div><b>body:</b> Thank you for submitting a contribution to Apache NiFi - MiNiFi C++.

In order to streamline the review of the contribution we ask you
to ensure the following steps have been taken:

### For all changes:
- [ ] Is there a JIRA ticket associated with this PR? Is it referenced
     in the commit message?

- [ ] Does your PR title start with MINIFICPP-XXXX where XXXX is the JIRA number you are trying to resolve? Pay particular attention to the hyphen "-" character.

- [ ] Has your PR been rebased against the latest commit within the target branch (typically master)?

- [ ] Is your initial contribution a single, squashed commit?

### For code changes:
- [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
- [ ] If applicable, have you updated the LICENSE file?
- [ ] If applicable, have you updated the NOTICE file?

### For documentation related changes:
- [ ] Have you ensured that format looks appropriate for the output in which it is rendered?

### Note:
Please ensure that once the PR is submitted, you check travis-ci for build issues and submit an update to your PR as soon as possible.

                </div></div></li><li><div><div><b>title:</b> MINIFICPP-694 - Ensure that processor consist of proper phases
                </div><div><b>body:</b> Thank you for submitting a contribution to Apache NiFi - MiNiFi C++.

In order to streamline the review of the contribution we ask you
to ensure the following steps have been taken:

### For all changes:
- [ ] Is there a JIRA ticket associated with this PR? Is it referenced
     in the commit message?

- [ ] Does your PR title start with MINIFICPP-XXXX where XXXX is the JIRA number you are trying to resolve? Pay particular attention to the hyphen "-" character.

- [ ] Has your PR been rebased against the latest commit within the target branch (typically master)?

- [ ] Is your initial contribution a single, squashed commit?

### For code changes:
- [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
- [ ] If applicable, have you updated the LICENSE file?
- [ ] If applicable, have you updated the NOTICE file?

### For documentation related changes:
- [ ] Have you ensured that format looks appropriate for the output in which it is rendered?

### Note:
Please ensure that once the PR is submitted, you check travis-ci for build issues and submit an update to your PR as soon as possible.

                </div></div></li><li><div><div><b>title:</b> MINIFICPP-694 - Ensure that processor consist of proper phases
                </div><div><b>body:</b> Thank you for submitting a contribution to Apache NiFi - MiNiFi C++.

In order to streamline the review of the contribution we ask you
to ensure the following steps have been taken:

### For all changes:
- [ ] Is there a JIRA ticket associated with this PR? Is it referenced
     in the commit message?

- [ ] Does your PR title start with MINIFICPP-XXXX where XXXX is the JIRA number you are trying to resolve? Pay particular attention to the hyphen "-" character.

- [ ] Has your PR been rebased against the latest commit within the target branch (typically master)?

- [ ] Is your initial contribution a single, squashed commit?

### For code changes:
- [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
- [ ] If applicable, have you updated the LICENSE file?
- [ ] If applicable, have you updated the NOTICE file?

### For documentation related changes:
- [ ] Have you ensured that format looks appropriate for the output in which it is rendered?

### Note:
Please ensure that once the PR is submitted, you check travis-ci for build issues and submit an update to your PR as soon as possible.

                </div></div></li><li><div><div><b>title:</b> MINIFICPP-694 - Ensure that processor consist of proper phases
                </div><div><b>body:</b> Thank you for submitting a contribution to Apache NiFi - MiNiFi C++.

In order to streamline the review of the contribution we ask you
to ensure the following steps have been taken:

### For all changes:
- [ ] Is there a JIRA ticket associated with this PR? Is it referenced
     in the commit message?

- [ ] Does your PR title start with MINIFICPP-XXXX where XXXX is the JIRA number you are trying to resolve? Pay particular attention to the hyphen "-" character.

- [ ] Has your PR been rebased against the latest commit within the target branch (typically master)?

- [ ] Is your initial contribution a single, squashed commit?

### For code changes:
- [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
- [ ] If applicable, have you updated the LICENSE file?
- [ ] If applicable, have you updated the NOTICE file?

### For documentation related changes:
- [ ] Have you ensured that format looks appropriate for the output in which it is rendered?

### Note:
Please ensure that once the PR is submitted, you check travis-ci for build issues and submit an update to your PR as soon as possible.

                </div></div></li><li><div><div><b>title:</b> MINIFICPP-694 - Ensure that processor consist of proper phases
                </div><div><b>body:</b> Thank you for submitting a contribution to Apache NiFi - MiNiFi C++.

In order to streamline the review of the contribution we ask you
to ensure the following steps have been taken:

### For all changes:
- [ ] Is there a JIRA ticket associated with this PR? Is it referenced
     in the commit message?

- [ ] Does your PR title start with MINIFICPP-XXXX where XXXX is the JIRA number you are trying to resolve? Pay particular attention to the hyphen "-" character.

- [ ] Has your PR been rebased against the latest commit within the target branch (typically master)?

- [ ] Is your initial contribution a single, squashed commit?

### For code changes:
- [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?
- [ ] If applicable, have you updated the LICENSE file?
- [ ] If applicable, have you updated the NOTICE file?

### For documentation related changes:
- [ ] Have you ensured that format looks appropriate for the output in which it is rendered?

### Note:
Please ensure that once the PR is submitted, you check travis-ci for build issues and submit an update to your PR as soon as possible.

                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div>
                I know it looks weird, although this way I could extend the C API with an optional argument, so this change doesn't break anything. (For eg. the hash_file example, that uses this call)
Moreover it supports funny signatures, like:
```
add_custom_processor("myproc2", .onsc_cb = custom_onschedule_logic);
```

              </div></li><li><div>
                is it not feasible to add those arguments to processor_logic?
              </div></li><li><div>
                That was just typedef for a function pointer, so not really. 
I have to admit that the first signature was not really future-proof, at least this one is definitely is. 
              </div></li></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Ensure that processor consist of proper phases
                </div><div><b>description:</b> Ensure that processor consist of proper phases – such as "onSchedule" – that is when it is scheduled and onTrigger, when it is invoked. Ensure consistent naming and that custom processors provide this capability.&nbsp;
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div><div><b>body:</b> [~phrocker]: I started working on this last week, did most of the things needed, although I'm less and less sure about this being the right way forward. The two main concerns I have:&nbsp;

-OnSchedule's main purpose is to get and store value of static properties, but those are not supported for custom processors. Doing so would require further API extension to be able to register them, which is definitely possible, but I don't really see a lot of value added by doing this.&nbsp;

-Communication. Whatever we do "onSchedule" should result in some data accessible in "onTrigger", although in pure C the callbacks cannot be member functions, we don't have lambda captures, etc... So communication can happen by either accessing some global structures or extending the callback signatures with some additional argument. The latter is a bit better, but still seems to be a bit overcomplicated in my opinion.&nbsp;
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                For some processors this may not make sense – but as we transition to minifi using nanofi, python processors, and other similar&nbsp;bound languages will serve well from this effort. Communication will likely have to be within the structures for that class.&nbsp;

&nbsp;

This ticket will also become important within the confines of&nbsp;scheduling. If someone wants their C or python processor to be run within minifi as part of a deployed flow, they will then need to implement these callbacks, but that is not always the case.&nbsp;&nbsp;
              </div></li><li><div>
                Python is a fair point, thanks!

Will create the PR soon, API details can be discussed in scope of that.&nbsp;
              </div></li></ol></div></div></html>