<!DOCTYPE html><html><div class="item-title">
        Item 166
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * Get the &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an application attempt.
   *
   * @return &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an application attempt
   
              </div></li><li><div>
                *
   * Set the &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an application attempt
   *
   * @param applicationAttemptId &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an
   *  application attempt
   
              </div></li><li><div>
                *
 * &lt;p&gt;The request sent by a client to the &lt;code&gt;ResourceManager&lt;/code&gt; to get
 * an {@link ApplicationAttemptReport} for an application attempt.&lt;/p&gt;
 *
 * &lt;p&gt;The request should include the {@link ApplicationAttemptId} of the
 * application attempt.&lt;/p&gt;
 *
 * @see ApplicationAttemptReport
 * @see ApplicationHistoryProtocol#getApplicationAttemptReport(GetApplicationAttemptReportRequest)
 
              </div></li><li><div>
                *
   * Get the &lt;code&gt;ApplicationAttemptReport&lt;/code&gt; for the application attempt.
   * 
   * @return &lt;code&gt;ApplicationAttemptReport&lt;/code&gt; for the application attempt
   
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * Get the &lt;code&gt;ApplicationAttemptReport&lt;/code&gt; for the application attempt.
   *
   * @param ApplicationAttemptReport &lt;code&gt;ApplicationAttemptReport&lt;/code&gt; for
   * the application attempt
   
              </div></li><li><div>
                *
 * &lt;p&gt;The response sent by the &lt;code&gt;ResourceManager&lt;/code&gt; to a client requesting
 * an application attempt report.&lt;/p&gt;
 *
 * &lt;p&gt;The response includes an {@link ApplicationAttemptReport} which has the
 * details about the particular application attempt&lt;/p&gt;
 *
 * @see ApplicationAttemptReport
 * @see ApplicationHistoryProtocol#getApplicationAttemptReport(GetApplicationAttemptReportRequest)
 
              </div></li><li><div>
                *
   * Get the &lt;code&gt;ApplicationId&lt;/code&gt; of an application
   *
   * @return &lt;code&gt;ApplicationId&lt;/code&gt; of an application
   
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * &lt;p&gt;The request from clients to get a list of application attempt reports of
 * an application from the &lt;code&gt;ResourceManager&lt;/code&gt;.&lt;/p&gt;
 *
 * @see ApplicationHistoryProtocol#getApplicationAttempts(GetApplicationAttemptsRequest)
 
              </div></li><li><div>
                *
   * Set the &lt;code&gt;ApplicationId&lt;/code&gt; of an application
   *
   * @param ApplicationId &lt;code&gt;ApplicationId&lt;/code&gt; of an application
   
              </div></li><li><div>
                *
 * &lt;p&gt;The response sent by the &lt;code&gt;ResourceManager&lt;/code&gt; to a client
 * requesting a list of {@link ApplicationAttemptReport} for application
 * attempts.&lt;/p&gt;
 *
 * &lt;p&gt;The &lt;code&gt;ApplicationAttemptReport&lt;/code&gt; for each application includes
 * the details of an application attempt.&lt;/p&gt;
 *
 * @see ApplicationAttemptReport
 * @see ApplicationHistoryProtocol#getApplicationAttempts(GetApplicationAttemptsRequest) 
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * Get a list of &lt;code&gt;ApplicationReport&lt;/code&gt; of an application.
   * 
   * @param applicationAttempts a list of &lt;code&gt;ApplicationReport&lt;/code&gt; of an
   * application
   
              </div></li><li><div>
                *
   * Get a list of &lt;code&gt;ApplicationReport&lt;/code&gt; of an application.
   * 
   * @return a list of &lt;code&gt;ApplicationReport&lt;/code&gt; of an application
   
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * Get the &lt;code&gt;ContainerId&lt;/code&gt; of the Container.
   * 
   * @return &lt;code&gt;ContainerId&lt;/code&gt; of the Container
   
              </div></li><li><div>
                *
 * &lt;p&gt;The request sent by a client to the &lt;code&gt;ResourceManager&lt;/code&gt; to 
 * get an {@link ContainerReport} for a container.&lt;/p&gt;
 
              </div></li><li><div>
                *
   * Set the &lt;code&gt;ContainerId&lt;/code&gt; of the container
   * 
   * @param ContainerId
   *          &lt;code&gt;ContainerId&lt;/code&gt; of the container
   
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * &lt;p&gt;The response sent by the &lt;code&gt;ResourceManager&lt;/code&gt; to a client
 * requesting a container report.&lt;/p&gt;
 * 
 * &lt;p&gt;The response includes a {@link ContainerReport} which has details of a
 * container.&lt;/p&gt;
 * 
 
              </div></li><li><div>
                *
   * Get the &lt;code&gt;ContainerReport&lt;/code&gt; for the container.
   * 
   * @return &lt;code&gt;ContainerReport&lt;/code&gt; for the container
   
              </div></li><li><div>
                *
   * Set the &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an application attempt
   * 
   * @param applicationAttemptId &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an
   * application attempt
   
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * Get the &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an application attempt.
   * 
   * @return &lt;code&gt;ApplicationAttemptId&lt;/code&gt; of an application attempt
   
              </div></li><li><div>
                *
 * &lt;p&gt;The request from clients to get a list of container reports, which belong
 * to an application attempt from the &lt;code&gt;ResourceManager&lt;/code&gt;.&lt;/p&gt;
 *
 * @see ApplicationHistoryProtocol#getContainers(GetContainersRequest)
 
              </div></li><li><div>
                *
 * &lt;p&gt;The response sent by the &lt;code&gt;ResourceManager&lt;/code&gt; to a client
 * requesting a list of {@link ContainerReport} for containers.&lt;/p&gt;
 *
 * &lt;p&gt;The &lt;code&gt;ContainerReport&lt;/code&gt; for each container includes the container
 * details.&lt;/p&gt;
 *
 * @see ContainerReport
 * @see ApplicationHistoryProtocol#getContainers(GetContainersRequest)
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * Get a list of &lt;code&gt;ContainerReport&lt;/code&gt; for all the containers of an
   * application attempt.
   * 
   * @return a list of &lt;code&gt;ContainerReport&lt;/code&gt; for all the containers of
   * an application attempt
   *
   
              </div></li><li><div>
                *
   * Set a list of &lt;code&gt;ContainerReport&lt;/code&gt; for all the containers of an
   * application attempt.
   * 
   * @param containers a list of &lt;code&gt;ContainerReport&lt;/code&gt; for all the
   * containers of an application attempt
   *
   
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 Once this is called. containerList will never be null - until a getProto
 is called.
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 Once this is called. containerList will never be null - until a getProto
 is called.
              </div></li><li><div>
                 TODO Auto-generated method stub
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> YARN-979. Added more APIs for getting information about ApplicationAttempts and Containers from ApplicationHistoryProtocol. Contributed by Mayank Bansal and Zhijie Shen.
                </div><div><b>message:</b> YARN-979. Added more APIs for getting information about ApplicationAttempts and Containers from ApplicationHistoryProtocol. Contributed by Mayank Bansal and Zhijie Shen.
svn merge --ignore-ancestry -c 1556731 ../YARN-321


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/branch-2@1562187 13f79535-47bb-0310-9956-ffa450edef68

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> [YARN-321] Add more APIs related to ApplicationAttempt and Container in ApplicationHistoryProtocol
                </div><div><b>description:</b> ApplicationHistoryProtocol should have the following APIs as well:

* getApplicationAttemptReport
* getApplicationAttempts
* getContainerReport
* getContainers

The corresponding request and response classes need to be added as well.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                Attaching patch for the protocol change and adding supporting classes.

Thanks,
Mayank
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12597216/YARN-979-1.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-YARN-Build/1686//console

This message is automatically generated.
              </div></li><li><div>
                There're some high-level comments on the patch:

1. To make the protocol work, it is required to define the corresponding protos in yarn_service.proto and update pplication_history_service.proto

2. The setter of the request/response APIs should be @Public, shouldn't it?

3. It's required to mark ApplicationHistoryProtocol as well.
              </div></li><li><div>
                Take it over. Thanks!
              </div></li><li><div>
                Based on [~mayank_bansal]'s initial patch, I addressed my previous comments and created a new one. The major modifications are:

1. Polishing the javadoc
2. Defining the corresponding protos in application_history_client.proto, yarn_protos.proto and yarn_service_protos.proto
3. Annotate the APIs where it is necessary

I've verified that patch can build correctly with branch YARN-321.

It is worth mentioning that I've created the empty ApplicationAttemptReport and ContainerReport. They are client oriented. What fields should be put into these two classes will be discussed in separate jiras.

In fact, ApplicationAttemptReport has been discussed in YARN-978. Similarly, ContainerReport should be proposed as well because either Container and RMContainer is the good class to be exposed to the client. Will open another jira for it.
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12600703/YARN-979.2.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-YARN-Build/1801//console

This message is automatically generated.
              </div></li><li><div>
                Thanks [~zjshen] for updating the patch. 
Let me reassign this to me and take it forward. 
Looks like we don't need ApplicationAttemptReport and ContainerReport and those are already covered in seprate jiras.

Working on this now.

Thanks,
Mayank

              </div></li><li><div>
                Removing Unwanted classes, fixing compilation.

Thanks,
Mayank
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12604077/YARN-979-3.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-YARN-Build/1971//console

This message is automatically generated.
              </div></li><li><div>
                Attaching the patch for latest YARN-321 branch.

Thanks,
Mayank
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12611519/YARN-979-4.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-YARN-Build/2339//console

This message is automatically generated.
              </div></li><li><div>
                The patch is almost good with the following minor issues:

* The following javadoc is inconsistent with ApplicationAttemptReport (YARN-978)
{code}
+   * &lt;li&gt;host - set to "N/A"&lt;/li&gt;
+   * &lt;li&gt;RPC port - set to -1&lt;/li&gt;
+   * &lt;li&gt;client token - set to "N/A"&lt;/li&gt;
+   * &lt;li&gt;diagnostics - set to "N/A"&lt;/li&gt;
+   * &lt;li&gt;tracking URL - set to "N/A"&lt;/li&gt;
{code}

* As is mentioned in the other two jiras, please move "GetApplicationAttemptReportRequestProtoOrBuilder p = viaProto ? proto : builder;" later.
{code}
+  @Override
+  public ApplicationAttemptId getApplicationAttemptId() {
+    GetApplicationAttemptReportRequestProtoOrBuilder p
+        = viaProto ? proto : builder;
+    if (this.applicationAttemptId != null) {
+      return this.applicationAttemptId;
+    }
+    if (!p.hasApplicationAttemptId()) {
+      return null;
+    }
+    this.applicationAttemptId =
+        convertFromProtoFormat(p.getApplicationAttemptId());
+    return this.applicationAttemptId;
+  }
{code}

* You need to change hadoop-yarn-api/pom.xml to make application_history_client.proto to be compiled.

In addition to the patch's issues, I'd like to raise one design issue here, projecting some future problems. This patch makes different APIs for application/attempt/container, which is going to be a super set of the APIs of ApplicationClientProtocol. Now it's OK if we restrict our problem with the AHS domain. However, probably in the future, we'd like to integrate the ApplicationHistoryProtocol with ApplicationClientProtocol. In other word, from the view of users, they may inquiry any application use a client, which makes it transparent whether the application report is received via ApplicationClientProtocol if the application is running or via ApplicationHistoryProtocol if it is done. Then, ApplicationClientProtocol's and ApplicationHistoryProtocol's APIs mismatch. Users can inquiry finished attempts/containers, but not the running ones. ApplicationClientProtocol may need to add the APIs for attempt/container as well.

In addition, another choice of the API design is to still have the only getApplicationReport(), but have the options to load all attempts/containers reports or not. Just think it out aloud. Personally, I incline to the current API design, which is more flexible, but I'm a bit concerned about the future integration. Thoughts?
              </div></li><li><div><div><b>body:</b> [~zjshen] Thanks for the review.

bq. You need to change hadoop-yarn-api/pom.xml to make application_history_client.proto to be compiled.

Its already there.


bq. In addition to the patch's issues, I'd like to raise one design issue here, projecting some future problems. This patch makes different APIs for application/attempt/container, which is going to be a super set of the APIs of ApplicationClientProtocol. Now it's OK if we restrict our problem with the AHS domain. However, probably in the future, we'd like to integrate the ApplicationHistoryProtocol with ApplicationClientProtocol. In other word, from the view of users, they may inquiry any application use a client, which makes it transparent whether the application report is received via ApplicationClientProtocol if the application is running or via ApplicationHistoryProtocol if it is done. Then, ApplicationClientProtocol's and ApplicationHistoryProtocol's APIs mismatch. Users can inquiry finished attempts/containers, but not the running ones. ApplicationClientProtocol may need to add the APIs for attempt/container as well.
In addition, another choice of the API design is to still have the only getApplicationReport(), but have the options to load all attempts/containers reports or not. Just think it out aloud. Personally, I incline to the current API design, which is more flexible, but I'm a bit concerned about the future integration. Thoughts?

I will create the jira for making applicationclientprotocol similar to applicationHistoryProtocol

Thanks,
Mayank

                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Rest of the comments incorporated.

Thanks,
Mayank
              </div></li><li><div>
                Updating the latest patch.

Thanks,
Mayank
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12612013/YARN-979-5.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-YARN-Build/2363//console

This message is automatically generated.
              </div></li><li><div>
                I still have one question w.r.t. the annotations of the getter/setter of GetXXXXRequest/Response. Some of them are marked as \@Stable, and some are marked as \@Unstable. In addition, some setters are marked as \@Private, and some are marked as \@Public. Do you have special consideration here? Maybe we should mark all as \@Unstable for the initial AHS?

bq. I will create the jira for making applicationclientprotocol similar to applicationHistoryProtocol

Thanks for file the ticket.  Ideally, we'd like to have to paired ApplicationClientProtocol and ApplicationHistoryProtocol. Then YarnClient can implement to query running application/attempt/container from ApplicationClientProtocol and the finished from ApplicationHistoryProtocol, making it transparent to users.
              </div></li><li><div>
                bq. I still have one question w.r.t. the annotations of the getter/setter of GetXXXXRequest/Response. Some of them are marked as @Stable, and some are marked as @Unstable. In addition, some setters are marked as @Private, and some are marked as @Public. Do you have special consideration here? Maybe we should mark all as @Unstable for the initial AHS?

Fixed the annotations

Thanks,
Mayank
              </div></li><li><div>
                Attaching the latest patch.

Thanks,
Mayank
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12612134/YARN-979-6.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-YARN-Build/2373//console

This message is automatically generated.
              </div></li><li><div>
                +1
              </div></li><li><div>
                Committed this to YARN-321 branch. Thanks Mayank and Zhijie for the patch!
              </div></li><li><div>
                Created an updated patch that applies to the latest trunk.
              </div></li><li><div>
                YARN-321 branch is merged into trunk and branch-2. Setting fix-version of all committed patches under YARN-321 to be 2.4.0.
              </div></li></ol></div></div></html>