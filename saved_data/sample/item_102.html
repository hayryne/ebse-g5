<!DOCTYPE html><html><div class="item-title">
        Item 102
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Fix Empty InDimFilter Failure (#6330)
                </div><div><b>message:</b> Fix Empty InDimFilter Failure (#6330)

* fix empty InDimFilter failure (#6101)

* Add test case for empty values input

* Add documentation for empty values in InDimFilter

                </div></div></li></ol></div><div><b>github_issues:</b> <ol><li><div><div><b>title:</b> Druid InDimFilter Fails on Empty Values
                </div><div><b>body:</b> ### Use Case:
We dynamically build Druid queries by allowing the user to filter the UI. Sometimes this results in the user filtering out all options (sometimes unintentionally), and is something we want to allow for.

### Problem:
In https://github.com/apache/incubator-druid/blob/04ea3c9f8c1f5ea34b023217bd709509ace4d30d/processing/src/main/java/io/druid/query/filter/InDimFilter.java#L78
Druid fails when filtering on empty values, though I see no reason why it should since the result should just be empty. e.g. in pseudocode,

```
 mydatasource.filter(mycolumn in []) = []
```

Is there a better reason for this, or can I submit a PR to remove that restriction?
                </div></div></li><li><div><div><b>title:</b> Druid InDimFilter Fails on Empty Values
                </div><div><b>body:</b> ### Use Case:
We dynamically build Druid queries by allowing the user to filter the UI. Sometimes this results in the user filtering out all options (sometimes unintentionally), and is something we want to allow for.

### Problem:
In https://github.com/apache/incubator-druid/blob/04ea3c9f8c1f5ea34b023217bd709509ace4d30d/processing/src/main/java/io/druid/query/filter/InDimFilter.java#L78
Druid fails when filtering on empty values, though I see no reason why it should since the result should just be empty. e.g. in pseudocode,

```
 mydatasource.filter(mycolumn in []) = []
```

Is there a better reason for this, or can I submit a PR to remove that restriction?
                </div></div></li></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Fix Empty InDimFilter Failure
                </div><div><b>body:</b> Fixes #6101 

While it may be more efficient to not process an empty filter, it is not wrong logically and should be supported for correctness.

A use case of this would be auto-filtering UIs which might happen to generate empty filters. It should be up to the application programmer to determine whether or not they want to incur that extra processing or add more complexity to their application to shortcut the request to Druid.
                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                It's not in line with SQL (which doesn't allow empty IN clause) but it seems that this behaviour receives complaints, so the change makes sense.

              </div></li><li><div><div><b>body:</b> Hi @robertervin, is this patch still interesting to you? Could you please add a test?
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>body:</b> @gianm Yep I'll add a test this weekend, thanks
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                @gianm Added a test case and updated docs to reflect new logic. Let me know if there are other places I should be concerned about testing too. 

Also the build failed with what appears to be a timeout. Could this be restarted please?
              </div></li><li><div>
                @robertervin I just restarted those two.
              </div></li><li><div>
                @gianm I just ran the full processing test suite locally and all tests passed in ~9 min. The build keeps failing due to timeouts, so I think it might be purely a build issue. Is continuously restarting it the best way to handle this right now?
              </div></li><li><div>
                @gianm Thanks for restarting the build if you did that. This should be ready for a final review.
              </div></li><li><div>
                +1
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>