<!DOCTYPE html><html><div class="item-title">
        Item 305
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
 * Return a simple greeting message for someone.
 *
 * @param name A person's name.
 * @param place Where the person is from.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 +build integration
              </div></li><li><div>
                *
 * Return a simple greeting message for someone.
 *
 * @param name A person's name.
 * @param place Where the person is from.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 +build integration
              </div></li><li><div>
                 a single package is specified in deployment YAML file with "package" key
              </div></li><li><div>
                 being deprecated, used in deployment.yaml
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Adding deprecation warning for using package in deployment file (#418)
                </div><div><b>message:</b> Adding deprecation warning for using package in deployment file (#418)

* Adding deprecation warning for using package in deployment file

* Converting array of packages to map

* updating integration tests deployment files

* binding input values instead of param struct

* Adding integration tests

* git is forcing to rename integration tests as previous commit created some
discrepancy

                </div></div></li></ol></div><div><b>github_issues:</b> <ol><li><div><div><b>title:</b> Deployment.yaml files all use "package" key, spec. has "packages"
                </div><div><b>body:</b> In every test's Deployment.yaml (and of course the code supports this) the key "package:" is used; however, the spec. has always had the plural "packages:" this key name change will impact all files.

I would be happy to support both "package" (singular) and "packages" (plural) as long as we display a warning, but our tests should use what is in the spec.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Deployment.yaml files all use "package" key, spec. has "packages"
                </div><div><b>body:</b> In every test's Deployment.yaml (and of course the code supports this) the key "package:" is used; however, the spec. has always had the plural "packages:" this key name change will impact all files.

I would be happy to support both "package" (singular) and "packages" (plural) as long as we display a warning, but our tests should use what is in the spec.
                </div></div></li><li><div><div><b>title:</b> Deployment.yaml files all use "package" key, spec. has "packages"
                </div><div><b>body:</b> In every test's Deployment.yaml (and of course the code supports this) the key "package:" is used; however, the spec. has always had the plural "packages:" this key name change will impact all files.

I would be happy to support both "package" (singular) and "packages" (plural) as long as we display a warning, but our tests should use what is in the spec.
                </div></div></li><li><div><div><b>title:</b> Deployment.yaml files all use "package" key, spec. has "packages"
                </div><div><b>body:</b> In every test's Deployment.yaml (and of course the code supports this) the key "package:" is used; however, the spec. has always had the plural "packages:" this key name change will impact all files.

I would be happy to support both "package" (singular) and "packages" (plural) as long as we display a warning, but our tests should use what is in the spec.
                </div></div></li><li><div><div><b>title:</b> Deployment.yaml files all use "package" key, spec. has "packages"
                </div><div><b>body:</b> In every test's Deployment.yaml (and of course the code supports this) the key "package:" is used; however, the spec. has always had the plural "packages:" this key name change will impact all files.

I would be happy to support both "package" (singular) and "packages" (plural) as long as we display a warning, but our tests should use what is in the spec.
                </div></div></li></ol></div><div><b>github_issues_comments:</b> <ol><li><div><div><b>body:</b> @pritidesai can you please look at changing this globally; see if we can allow (in some deprecated manner, perhaps issue a WARNING message) and allow the "package" (singular) to be supported for some period of time and mark/comment the code to indicated we should remove this at a later date (perhaps open a low priority issue as well to remind us).
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Please close this as its fixed with PR #418 
              </div></li><li><div>
                Priti fixed in PR 418 not only fixed the warning, but also the actual root of the problem.  WTG!
              </div></li></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> Adding deprecation warning for using package in deployment file
                </div><div><b>body:</b> Closes issue #393 

**Fix 1: Produce WARNING when deployment file has `package` instead of `packages`:**

```
wskdeploy -p /Users/pritidesai/Documents/goworkspace/src/github.com/apache/incubator-openwhisk-wskdeploy/tests/src/integration/flagstests/
==&gt; Output: 2017/08/30 01:42:19 Unmarshal Openwhisk info from internet
2017/08/30 01:42:19 Using /Users/pritidesai/Documents/goworkspace/src/github.com/apache/incubator-openwhisk-wskdeploy/tests/src/integration/flagstests/manifest.yaml for deployment 
2017/08/30 01:42:19 The URL is https://openwhisk.ng.bluemix.net/api, selected from .wskprops
2017/08/30 01:42:19 The auth key is set, selected from .wskprops
2017/08/30 01:42:19 The namespace is ****, selected from .wskprops
2017/08/30 01:42:19 WARNING: The package YAML key in deployment file will soon be deprecated. Please use packages instead as described in specifications.
2017/08/30 01:42:19 Deploying package helloWorldFlags ... 
2017/08/30 01:42:20 Done!
2017/08/30 01:42:20 Deploying action helloWorldFlags/greeting ... 
2017/08/30 01:42:20 Done!
Done!
Deploying rule myRule ... Done!
2017/08/30 01:42:20 
Deployment completed successfully.
```

**Fix 2: Update all the deployment files we have, replacing `package` with `packages`:**

Original:

```
application:
  name: sampleApp
  package:
    name: samplePackage
    actions:
```

Updated to:

```
application:
  name: sampleApp
  packages:
    samplePackage:
      actions:
```

**Fix 3: wskdeploy was failing to provide parameters from deployment file while deploying actions, they were inserted as "string" instead of actual value:**

```
/wskdeploy -m tests/src/integration/flagstests/manifest.yaml -d tests/src/integration/flagstests/deployment.yml -i -v
2017/08/30 13:16:27 Unmarshal Openwhisk info from internet
2017/08/30 13:16:27 The URL is https://openwhisk.ng.bluemix.net/api, selected from .wskprops
2017/08/30 13:16:27 The auth key is set, selected from .wskprops
2017/08/30 13:16:27 The namespace is *****, selected from .wskprops
         ____      ___                   _    _ _     _     _
        /\   \    / _ \ _ __   ___ _ __ | |  | | |__ (_)___| | __
   /\  /__\   \  | | | | '_ \ / _ \ '_ \| |  | | '_ \| / __| |/ /
  /  \____ \  /  | |_| | |_) |  __/ | | | |/\| | | | | \__ \   &lt;
  \   \  /  \/    \___/| .__/ \___|_| |_|__/\__|_| |_|_|___/_|\_\ 
   \___\/              |_|

Packages:
Name: helloWorldFlags
    bindings: 

  * action: greeting
    bindings: 
        - place : "string"
        - name : "string"
    annotations: 


Triggers:
* trigger: locationUpdateFlags
    bindings: 
    annotations: 

 Rules
* rule: myRule
    - trigger: locationUpdateFlags
    - action: helloWorldFlags/greeting

Do you really want to deploy this? (y/N): 
```

With this PR:

```
./wskdeploy -m tests/src/integration/flagstests/manifest.yaml -d tests/src/integration/flagstests/deployment.yml -i -v
2017/08/30 13:11:04 Unmarshal Openwhisk info from internet
2017/08/30 13:11:04 The URL is https://openwhisk.ng.bluemix.net/api, selected from .wskprops
2017/08/30 13:11:04 The auth key is set, selected from .wskprops
2017/08/30 13:11:04 The namespace is ****, selected from .wskprops
         ____      ___                   _    _ _     _     _
        /\   \    / _ \ _ __   ___ _ __ | |  | | |__ (_)___| | __
   /\  /__\   \  | | | | '_ \ / _ \ '_ \| |  | | '_ \| / __| |/ /
  /  \____ \  /  | |_| | |_) |  __/ | | | |/\| | | | | \__ \   &lt;
  \   \  /  \/    \___/| .__/ \___|_| |_|__/\__|_| |_|_|___/_|\_\ 
   \___\/              |_|

Packages:
Name: helloWorldFlags
    bindings: 

  * action: greeting
    bindings: 
        - name : "Bernie"
        - place : "Vermont"
    annotations: 


Triggers:
* trigger: locationUpdateFlags
    bindings: 
    annotations: 

 Rules
* rule: myRule
    - trigger: locationUpdateFlags
    - action: helloWorldFlags/greeting

Do you really want to deploy this? (y/N): 
```
                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                this is ready to review :)
              </div></li><li><div>
                @pritidesai @lzbj 
Please do not use log. any more. We need to get rid of it for our message management.
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div>
                Amy?
              </div></li><li><div>
                :)
              </div></li></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>