<!DOCTYPE html><html><div class="item-title">
        Item 235
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                * Cached lower-case characters. 
              </div></li><li><div>
                *
     * Get type ID.
     *
     * @param typeName Type name.
     * @return Type ID.
     
              </div></li><li><div>
                *
 * Base binary ID mapper implementation.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
     * Gets whether to use strings in lower case or not.
     *
     * @return Whether to use strings in lower case or not.
     
              </div></li><li><div>
                *
     * Routine to calculate string hash code an
     *
     * @param str String.
     * @return Hash code for given string converted to lower case.
     
              </div></li><li><div>
                *
     * Static initializer.
     
              </div></li><li><div>
                * Default lower case flag setting. 
              </div></li><li><div>
                *
     * Default constructor.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * Get field ID.
     *
     * @param typeId Type ID.
     * @param fieldName Field name.
     * @return Field ID.
     
              </div></li><li><div>
                * Maximum lower-case character. 
              </div></li><li><div>
                *
     * @param isLowerCase Whether to use strings in lower case or not.
     * &lt;p&gt;
     * Defaults to {@link #DFLT_LOWER_CASE}.
     
              </div></li><li><div>
                *
     * Sets whether to use strings in lower case or not.
     *
     * @param isLowerCase Whether to use strings in lower case or not.
     
              </div></li><li><div>
                * Default use simple name flag setting. 
              </div></li><li><div>
                *
 * Base binary name mapper implementation.
 
              </div></li><li><div>
                *
     * Sets whether to use simple name of class or not.
     *
     * @param isSimpleName Whether to use simple name of class or not.
     
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
     * Gets whether to use simple name of class or not.
     *
     * @return Whether to use simple name of class or not.
     
              </div></li><li><div>
                *
     * Default constructor.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * @param isSimpleName Whether to use simple name of class or not.
     * &lt;p&gt;
     * Defaults to {@link #DFLT_SIMPLE_NAME}.
     
              </div></li><li><div>
                 No-op.
              </div></li><li><div>
                *
     * Gets type clsName.
     *
     * @param clsName Class came
     * @return Type name.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * Gets field name.
     *
     * @param fieldName Field name.
     * @return Field name.
     
              </div></li><li><div>
                *
 * Maps type and field names to different names. Prepares class/type names
 * and field names before pass them to {@link BinaryIdMapper}.
 * &lt;p&gt;
 * Binary name mapper can be configured for all binary objects via
 * {@link BinaryConfiguration#getNameMapper()} method,
 * or for a specific binary type via {@link BinaryTypeConfiguration#getNameMapper()} method.
 * @see BinaryIdMapper
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
     * @param typeId Type ID.
     * @param fieldName Field name.
     * @return Field ID.
     
              </div></li><li><div>
                *
     * @return Name mapper.
     
              </div></li><li><div>
                *
     * @param clsName Class name.
     * @return Type ID.
     
              </div></li><li><div>
                *
     * @param nameMapper Name mapper.
     * @param idMapper Id mapper.
     * @param checkOnZeroId Whether checks on zero id or not.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Internal binary mapper.
 
              </div></li><li><div>
                *
     * @return ID mapper.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
     * @return Custom BinaryConfiguration.
     * @param compactFooter Compact footer.
     
              </div></li><li><div>
                *
 * Tests a check of binary configuration consistency.
 
              </div></li><li><div>
                 Wrong usage of Ignite (done only in test purposes).
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * @param bCfg1 BinaryConfiguration 1.
     * @param bCfg2 BinaryConfiguration 2.
     * @throws Exception If failed.
     
              </div></li><li><div>
                 No-op.
              </div></li><li><div>
                *
 * Binary builder test.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
 * Tests testing framewrok, epecially BINARY_MARSHALLER_USE_SIMPLE_NAME_MAPPER test property.
 
              </div></li><li><div>
                *
     * @param expTypeName Type name.
     * @throws Exception If failed.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
 * Binary meta data test.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                *
 * Binary builder test for objects with non-compact footer.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
 * Tests for cache store with binary.
 
              </div></li><li><div>
                *
     * @return Test suite.
     * @throws Exception Thrown in case of the failure.
     
              </div></li><li><div>
                *
 * Basic test suite.
 
              </div></li><li><div><div><b>comment:</b>  TODO: check and delete if pass.
                </div><div><b>label:</b> requirement
                </div></div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 Tests that are not ready to be used with PortableMarshaller
              </div></li><li><div>
                *
     * @return Test suite.
     * @throws Exception If failed.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                *
     * @return Test suite.
     * @throws Exception Thrown in case of the failure.
     
              </div></li><li><div>
                *
 * Basic test suite.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * @return Suite.
     * @throws Exception In case of error.
     
              </div></li><li><div>
                *
 * Cache full API suite with binary marshaller and simple name mapper.
 
              </div></li><li><div>
                *
 * Cache query suite with binary marshaller.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * @return Suite.
     * @throws Exception In case of error.
     
              </div></li><li><div>
                *
     * @param fullClsName Class name.
     * @return Expected type name according to configuration.
     
              </div></li><li><div>
                *
     * @return Expected hash code.
     * @param fullName Full name of type.
     
              </div></li><li><div>
                *
     * Gets name mapper.
     *
     * @return Name mapper.
     
              </div></li><li><div>
                * Name mapper. 
              </div></li><li><div>
                *
     * Sets name mapper.
     *
     * @param nameMapper Name mapper.
     
              </div></li><li><div>
                *
     * Gets name mapper.
     *
     * @return Name mapper.
     
              </div></li><li><div>
                * Name mapper. 
              </div></li><li><div>
                *
     * Sets name mapper.
     *
     * @param nameMapper Name mapper.
     
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                * Binary configuration. 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                * Mapper. 
              </div></li><li><div>
                 Resolve serializer.
              </div></li><li><div>
                *
     * @param nameMapper Name mapper.
     * @param idMapper ID mapper.
     * @return Mapper.
     
              </div></li><li><div>
                *
     * @return Intenal mpper used as default.
     
              </div></li><li><div>
                * Maps typeId to mappers. 
              </div></li><li><div>
                *
     * @param clsName Type name.
     * @param cfg Binary configuration.
     * @return Mapper according to configuration.
     
              </div></li><li><div>
                *
     * @return ID mapper used as default.
     
              </div></li><li><div>
                * Maps className to mapper 
              </div></li><li><div>
                 Resolve mapper.
              </div></li><li><div>
                 Pattern.
              </div></li><li><div>
                *
     * @return Name mapper used as default.
     
              </div></li><li><div>
                * Name mapper. 
              </div></li><li><div>
                * Mapper. 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                 Check marshaller.
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                *
     
              </div></li><li><div>
                 Full name hashCode.
              </div></li><li><div>
                 Custom types.
              </div></li><li><div>
                *
         * @param val1 Val1
         * @param val2 Val2
         
              </div></li><li><div>
                 BinaryIdMapper.typeId() contract.
              </div></li><li><div>
                *
     * @param fullClsName Class name.
     * @return Expected type name according to configuration.
     
              </div></li><li><div>
                *
     * @return Expected hash code.
     * @param fullName Full name of type.
     
              </div></li><li><div>
                *
     * @param typeName Type name.
     * @param nameMapper Name mapper.
     * @param mapper ID mapper.  @return Type ID.
     
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                *
     *
     * @param nameMapper Name mapper.
     * @param idMapper Mapper.
     * @throws IgniteCheckedException If failed.
     
              </div></li><li><div>
                *
     *
     * @param nameMapper Name mapper.
     * @param idMapper ID mapper.
     * @throws IgniteCheckedException If failed.
     
              </div></li><li><div>
                *
     *
     * @param nameMapper
     * @param idMapper Mapper.
     * @throws IgniteCheckedException If failed.
     
              </div></li><li><div>
                *
     *
     
              </div></li><li><div>
                *
     *
     * @param nameMapper Name mapper.
     * @param mapper Mapper.
     * @throws IgniteCheckedException If failed.
     
              </div></li><li><div><div><b>comment:</b> TODO: the following tests= was never tested with binary. Exclude or pass?
        suite.addTestSuite(IgniteSqlSchemaIndexingTest.class);
                </div><div><b>label:</b> test
                </div></div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> IGNITE-2191 - Support classes with the same simple name for Binary marshaller - Fixes #398.
                </div><div><b>message:</b> IGNITE-2191 - Support classes with the same simple name for Binary marshaller - Fixes #398.

Signed-off-by: Alexey Goncharuk &lt;alexey.goncharuk@gmail.com&gt;

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> IGNITE-2191: Binary marshaller: support user classes with the same simple name
                </div><div><b>body:</b> https://issues.apache.org/jira/browse/IGNITE-2191

                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Binary marshaller: support user classes with the same simple name
                </div><div><b>description:</b> Presently the user won't be able to use across the cluster object that have a single simple name.

As an example if the user has 'org.comp.MyObject' and 'org.apache.comp.MyObject' then he won't be able to have them both in a cluster because marshalling mechanism supports uniqueness at simple name level only.

There are several reasons for that:
- interoperability with other platforms;
- queries that use simple name is their 'where' clause.

In general according to the API as a workaround the user can implement its own BinaryIdMapper returning a precise id for every class. However there is a bug in BinaryContext that passes simple name rather than a full name to a BinaryIdMapper implementation. BinaryIdMapper must be fixed as well.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                GitHub user ashutakGG opened a pull request:

    https://github.com/apache/ignite/pull/398

    IGNITE-2191: Binary marshaller: support user classes with the same simple name

    https://issues.apache.org/jira/browse/IGNITE-2191

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/ashutakGG/incubator-ignite ignite-2191-simple-name

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/ignite/pull/398.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #398
    
----
commit fa70b383e4ccad00482d74a796c8c1dc2041448a
Author: ashutak &lt;ashutak@gridgain.com&gt;
Date:   2016-01-12T14:56:57Z

    ignite-2191:

----

              </div></li><li><div>
                Root cause:
- {{BinaryContext}} uses a simple name as a type name. As a result we pass a simple name to {{BinaryIdMapper.typeId(clsName)}} method.

Proposal:
# {{BinaryContext}} should use a full name as a type name.
# We should have 2 different {{BinaryIdMapper}} implementations: 
#* {{BinaryInternalIdMapper}} - should use full names of classes to calculate typeId.
#* {{BinaryPlatformIdMapper}} - should use simple names of classes to calculate typeId. This mapper is required for working .Net.
# We should have configuration paramether to set which mapper will be used. Also, need to have a check that all nodes have an equal BinaryConfiguration.

I've tried point 1 from the proposal and run some binary tests. Looks good. Waiting for full run on TC. One big open issue is a work of queries with full names (I expect problems with inner classes at least).

Scope of works:
- The points 2 and 3 from the proposal.
- Fix tests after point 1.
- Add tests for new mappers.
- Queries and full names of classes.
              </div></li><li><div>
                I didn't see new failed tests in queries related to changes described above. Also, I played with queries by yourself. So I don't expect big problems with queries.
              </div></li><li><div>
                Found that BinaryIdMapper has the following contract:

{code}
    /**
     * Gets type ID for provided class name.
     * &lt;p&gt;
     * If {@code 0} is returned, hash code of class simple name will be used.
     *
     * @param clsName Class name.
     * @return Type ID.
     */
    public int typeId(String clsName);
{code}

So, If a user uses a custom implementation for id mapper we have to delegate a calculation of typeId to BinarySimpleNameIdMapper if the custom implementation returns 'zero'.
              </div></li><li><div>
                Finished with implementation. 

Also found and fixed the following bug: {{BinaryContext.typeId(typeName)}} method uses the default IdMapper for not registered types in process of initialization instead of calculating idMapper according to configuration.

Waiting for TC results. WIll fix tests and will write new ones.
              </div></li><li><div>
                Reverted fix for the bug described above. Created a separate issue for the bug: https://issues.apache.org/jira/browse/IGNITE-2395.

Finished with tests (fixed old and wrote new).

Left:
- Fix .Net tests (by providing right configuration).
- Add check on right IdMapper configuration when .Net enabled.
- Javadocs.
              </div></li><li><div>
                Set SimpleNameIdMapper in configuration automatically if .Net/Cpp enabled - implemented.

In process of fixing .Net tests I faced with the following issues:
# We cannot set FullNameIdMapper as default before 2395 will be fixed. So, set SimpleNameIdMapper as default.
# In current implementation we cannot use the same classes in .Net and Java (enum for example). The root cause of the issue is that 'typeName' is used as ID for all information about marshalling. Possible solutions:
#* Add {{BinaryConfiguration.setUseSimpleTypeName(boolean b)}} property.
#* Add {{BinaryIdMapper.typeName(String fullClassName)}} method
#* Reimplement internals to use typeId as ID for all information about marshalling.
              </div></li><li><div>
                The issue at point 2 has been discussed with Alexey G. and Vladimir. As a result, it was decided to add {{BinaryNameMapper}} property to {{BinaryConfiguration}} (as we already have for .Net).

The new property implemented. As a result, all .Net tests pass. Will fix java tests and new tests for the property.
              </div></li><li><div>
                In bound of this task, IGNITE-2395 has been fixed too.

All tests fixed. 

Reviewed with Alexey G. Fixed review comments.

TC passed.
              </div></li><li><div>
                Added new test suites for binary marshaller with simple name mapper:
- basic
- full api
- compute
- query (old binary test suite refactored)

The suites added on TC. Muted known failures. Investigating hanging of Binary Basic suite.

Added one more check on right mappers configuration.
              </div></li><li><div>
                Github user asfgit closed the pull request at:

    https://github.com/apache/ignite/pull/398

              </div></li><li><div>
                Merged by Alexey G.
              </div></li><li><div>
                Github user ashutakGG closed the pull request at:

    https://github.com/apache/ignite/pull/419

              </div></li></ol></div></div></html>