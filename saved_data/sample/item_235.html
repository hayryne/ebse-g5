<!DOCTYPE html><html><div class="item-title">
        Item 235
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
 * A Cache continuous query entry event.
 *
 * @param &lt;K&gt; the type of key
 * @param &lt;V&gt; the type of value
 
              </div></li><li><div>
                *
     * Constructs a cache entry event from a given cache as source.
     *
     * @param source the cache that originated the event
     * @param eventType Event type.
     
              </div></li><li><div>
                *
     * Each cache update increases partition counter. The same cache updates have on the same value of counter
     * on primary and backup nodes. This value can be useful to communicate with external applications.
     *
     * @return Value of counter for this event.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     * @return Peer class loading enabled flag.
     
              </div></li><li><div>
                 No-op.
              </div></li><li><div>
                *
     * @return Distribution.
     
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
     * Store.
     
              </div></li><li><div>
                * IP finder. 
              </div></li><li><div>
                *
     * @return Cache mode.
     
              </div></li><li><div>
                 count continues queries
              </div></li><li><div>
                *
     * @return Cache configuration.
     
              </div></li><li><div>
                *
     * @param evnts Events.
     * @param iter Iteration.
     
              </div></li><li><div>
                *
 * Continuous queries counter tests.
 
              </div></li><li><div>
                *
     * @return Grids count.
     
              </div></li><li><div>
                 Check put 1
              </div></li><li><div>
                 Check put 3
              </div></li><li><div>
                * 
              </div></li><li><div>
                *
     * @return Atomicity mode.
     
              </div></li><li><div>
                 count operation 
              </div></li><li><div>
                 Check remove 1
              </div></li><li><div>
                 Check remove 3
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
     *
     
              </div></li><li><div>
                 Check remove 2
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                 Check put 2
              </div></li><li><div>
                * Latch timeout. 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                 log.info("Random operation [key=" + key + ", op=" + op + ']');
              </div></li><li><div>
                *
     * @param rnd {@link Random}.
     * @return {@link TransactionConcurrency}.
     
              </div></li><li><div>
                *
         * @param val Value.
         
              </div></li><li><div>
                *
     *
     * @param cacheMode Cache mode.
     * @param backups Number of backups.
     * @param atomicityMode Cache atomicity mode.
     * @param memoryMode Cache memory mode.
     * @param store If {@code true} configures dummy cache store.
     * @return Cache configuration.
     
              </div></li><li><div>
                 No-op.
              </div></li><li><div>
                *
     * @param rnd Random generator.
     * @return Cache value.
     
              </div></li><li><div>
                *
     * @param evtsQueues Event queue.
     * @param partCntrs Partition counters.
     * @param aff Affinity function.
     * @param key Key.
     * @param val Value.
     * @param oldVal Old value.
     * @throws Exception If failed.
     
              </div></li><li><div>
                *
     * @param rnd {@link Random}.
     * @return {@link TransactionIsolation}.
     
              </div></li><li><div>
                *
     * @param cache Cache.
     * @param key Key
     * @param cntrs Partition counters.
     
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
         * @param key Key.
         
              </div></li><li><div>
                *
     * @param rnd Random generator.
     * @param evtsQueues Events queue.
     * @param expData Expected cache data.
     * @param partCntr Partition counter.
     * @param cache Cache.
     * @throws Exception If failed.
     
              </div></li><li><div>
                * 
              </div></li><li><div>
                *
     * @param ccfg Cache configuration.
     * @param deploy The place where continuous query will be started.
     * @throws Exception If failed.
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 *
 
              </div></li><li><div>
                *
     *
     
              </div></li><li><div>
                *
     * @throws Exception If failed.
     
              </div></li><li><div>
                *
         * @param val Value to set.
         * @param retOld Return old value flag.
         
              </div></li><li><div>
                *
     *  @param evtsQueues Queue.
     * @param partCntrs Counters.
     * @param aff Affinity.
     * @param vals Values.
     * @param expData Expected data.
     
              </div></li><li><div>
                *
     * @param evtsQueues Event queue.
     * @throws Exception If failed.
     
              </div></li><li><div>
                * {@inheritDoc} 
              </div></li><li><div>
                *
     * @param key Entry key.
     * @param partId Partition id.
     * @param updCntr Updated counter.
     * @param topVer Topology version.
     * @param primary Primary.
     
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Fixed "IGNITE-2515 Make 'updateCntr' available through CacheContinuousQueryEvent public API"
                </div><div><b>message:</b> Fixed "IGNITE-2515 Make 'updateCntr' available through CacheContinuousQueryEvent public API"

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li><li><div><div><b>summary:</b> Make 'updateCntr' available through CacheContinuousQueryEvent public API 
                </div><div><b>description:</b> Make {{updateCntr}} available through {{CacheContinuousQueryEvent}}.
This may be useful when the user want to leverage this parameter for his custom logic.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                Nick, what do you think, is it possible to add {{updateCntr}} to events that are passed to cache interceptors as well? Is it feasible? 

If it's quite easy to implement we can open another one ticket for this task.
              </div></li><li><div>
                Yes, this can be implemented but I think only for `onAfterPut`and `onAfterRemove` methods. User can obtain the counter by Entry.unwrap(CounterClass.class) method.
              </div></li><li><div>
                Could you create a ticket then leaving your thoughts there?
              </div></li><li><div>
                Yes. I've created ticket https://issues.apache.org/jira/browse/IGNITE-2630.
              </div></li><li><div>
                Implemented access to partition counter by {{CacheEntryEvent.unwrap(Long.class)}}.
              </div></li><li><div><div><b>body:</b> Reviewed, have some comments:
- let's add new abstract class {{CacheQueryEntryEvent}} which will have {{getPartitionUpdateCounter}} method and will be implemented by {{ContinuousQueryEvent}} class. Access to this interface by {{unwrap}} method on {{CacheEntryEvent}};
- please improve tests: use different transaction types, deploy query on all nodes.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Fixed review notes: improved tests, implemented access to update counter by {{CacheQueryEntryEvent}} API.
              </div></li></ol></div></div></html>