<!DOCTYPE html><html><div class="item-title">
        Item 318
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 implements thrift_transport_open 
              </div></li><li><div>
                 implements thrift_transport_flush 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 
              </div></li><li><div>
                 satisfy -Wall 
              </div></li><li><div>
                 initializes the instance 
              </div></li><li><div>
                 implements thrift_transport_write 
              </div></li><li><div>
                 implements thrift_transport_is_open 
              </div></li><li><div>
                 implements thrift_transport_write_end
 * called when write is complete.  nothing to do on our end. 
              </div></li><li><div>
                 destructor 
              </div></li><li><div>
                 implements thrift_transport_read_end
 * called when write is complete.  nothing to do on our end. 
              </div></li><li><div>
                 min 
              </div></li><li><div>
                 implements thrift_transport_read 
              </div></li><li><div>
                 implements thrift_transport_close 
              </div></li><li><div>
                 property accessor 
              </div></li><li><div>
                 default value 
              </div></li><li><div>
                 object properties 
              </div></li><li><div>
                 setup accessors and mutators 
              </div></li><li><div>
                 property mutator 
              </div></li><li><div>
                 initializes the class 
              </div></li><li><div>
                 max, 1024*1024 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 
              </div></li><li><div>
                 _THRIFT_FD_TRANSPORT_H 
              </div></li><li><div>
                 used by THRIFT_TYPE_FD_TRANSPORT 
              </div></li><li><div>
                ! \file thrift_fd_transport.h
 *  \brief Class for Thrift file descriptor transports.
 
              </div></li><li><div>
                !
 * Thrift Transport class
 
              </div></li><li><div>
                 protected 
              </div></li><li><div>
                 type macros 
              </div></li><li><div>
                 write 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 
              </div></li><li><div><div><b>comment:</b>  clean up 
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>comment:</b>  test bad fd 
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                 open is no-op 
              </div></li><li><div>
                 already closed 
              </div></li><li><div>
                 read 
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> THRIFT-3556 c_glib file descriptor transport
                </div><div><b>message:</b> THRIFT-3556 c_glib file descriptor transport
Client: C (GLib)
Patch: Chandler May &lt;cjmay4754@gmail.com&gt;

This closes #810

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> THRIFT-3556 Implement file descriptor transport for c_glib.
                </div><div><b>body:</b> Add a basic file descriptor transport to the c_glib library.

                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> c_glib file descriptor transport
                </div><div><b>description:</b> c_glib library does not have any filesystem transports, including a file descriptor transport
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                GitHub user cjmay opened a pull request:

    https://github.com/apache/thrift/pull/810

    THRIFT-3556 Implement file descriptor transport for c_glib.

    Add a basic file descriptor transport to the c_glib library.

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/cjmay/thrift THRIFT-3556

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/thrift/pull/810.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #810
    
----
commit f0fe5d9931da130ed6682436489ff31de7848bfb
Author: Chandler May &lt;cjmay4754@gmail.com&gt;
Date:   2016-01-12T23:40:37Z

    THRIFT-3556 Implement file descriptor transport for c_glib.

----

              </div></li><li><div>
                [~simonsouth], any comments from your side?
              </div></li><li><div>
                I haven't had a chance to take a close look at this yet, but I will soon.
              </div></li><li><div><div><b>body:</b> This looks really good. Thank you, [~cjmay], for the work you're doing.

The only potential issue I see with this code is that it uses {{[g_close|https://developer.gnome.org/glib/stable/glib-File-Utilities.html#g-close]}}, which wasn't available in GLib until version 2.36. This will break support for (at least) CentOS 6, which is still on version 2.28. This may not be a strict requirement but I'd suggest testing the GLib version with a preprocessor macro and providing a separate implementation that uses {{close}} and handles error reporting "manually".

My only other comment is that it would be nice if {{thrift_fd_transport_set_property}} and {{thrift_fd_transport_get_property}} issued a warning when passed an unrecognized property ID (as [the example|https://developer.gnome.org/gobject/2.26/gobject-properties.html] shows), though surprisingly this isn't done in the existing code either so it isn't really an omission.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Thank you!  Pull request updated.
              </div></li><li><div>
                Github user asfgit closed the pull request at:

    https://github.com/apache/thrift/pull/810

              </div></li><li><div>
                Committed. Thanks again, [~cjmay]!

So you're aware, I made two small changes to your work before committing:
* Explicitly clearing the error condition with {{[g_clear_error|https://developer.gnome.org/glib/stable/glib-Error-Reporting.html#g-clear-error]}} when {{close}} succeeds, and
* Adding the generated test driver to {{.gitignore}}.
              </div></li><li><div>
                Great!  And thanks for the tips.
              </div></li><li><div>
                FAILURE: Integrated in Thrift-precommit #77 (See [https://builds.apache.org/job/Thrift-precommit/77/])
THRIFT-3556 c_glib file descriptor transport Client: C (GLib) Patch: (simonsouth: [https://github.com/apache/thrift/commit/e71f20cd3ee9e812a064e492a7e692e2f2f98d35])
* lib/c_glib/test/Makefile.am
* lib/c_glib/src/thrift/c_glib/transport/thrift_fd_transport.c
* lib/c_glib/src/thrift/c_glib/transport/thrift_fd_transport.h
* .gitignore
* lib/c_glib/test/testfdtransport.c
* lib/c_glib/CMakeLists.txt
* lib/c_glib/Makefile.am
* lib/c_glib/test/CMakeLists.txt

              </div></li></ol></div></div></html>