<!DOCTYPE html><html><div class="item-title">
        Item 294
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 we don't project into union as shuffle key.
              </div></li><li><div>
                 There are totally 5 types of non-primitive. If falling into this branch, it means it is a TIMESTAMP_INSTANT
 and we will by default treated it as eligible.
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> [GOBBLIN-1212] Handle non-Primitive type eligibility-check for shuffle key properly
                </div><div><b>message:</b> [GOBBLIN-1212] Handle non-Primitive type eligibility-check for shuffle key properly

Closes #3060 from autumnust/embeddedHiveDistcp

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> [GOBBLIN-1212] Handle non-Primitive type eligibility-check for shuffle key properly
                </div><div><b>body:</b> Dear Gobblin maintainers,

Please accept this PR. I understand that it will not be reviewed until I have checked off all the steps below!


### JIRA
- [ ] My PR addresses the following [Gobblin JIRA](https://issues.apache.org/jira/browse/GOBBLIN/) issues and references them in the PR title. For example, "[GOBBLIN-XXX] My Gobblin PR"
    - https://issues.apache.org/jira/browse/GOBBLIN-1212

### Description
- [ ] Here are some details about my PR, including screenshots (if applicable):

Before this change, the handling for non-primitive types like map,array and union will hit NPE since they don't have `fieldNames`. This fixed that and making sure the eligibility check happens recursively into those types.

### Tests
- [ ] My PR adds the following unit tests __OR__ does not need testing for this extremely good reason:


### Commits
- [ ] My commits all reference JIRA issues in their subject lines, and I have squashed multiple commits if they address the same issue. In addition, my commits follow the guidelines from "[How to write a good git commit message](http://chris.beams.io/posts/git-commit/)":
    1. Subject is separated from body by a blank line
    2. Subject is limited to 50 characters
    3. Subject does not end with a period
    4. Subject uses the imperative mood ("add", not "adding")
    5. Body wraps at 72 characters
    6. Body explains "what" and "why", not "how"


                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div>
                Should we do a null check here? What happens if originalSchema.getChildren() returns null?
              </div></li><li><div>
                Two points: 1. Maybe avoid exposing LinkedIn internal schemas outside, and 2. From the schema definitions, it is hard to see what exactly is being tested. Can you add a comment explaining the difference between struct_a and struct_b and why eligibileForUpConvert should return true?
              </div></li><li><div>
                Will add a safety-guard. 
              </div></li><li><div><div><b>body:</b> minor typo: complextType -&gt; complexType.
                </div><div><b>label:</b> documentation
                </div></div></li><li><div>
                Should the error message be: "Illegal format of ORC schema as:" + originalSchema?
              </div></li></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Handle shuffle-key eligibility check properly 
                </div><div><b>description:</b> 
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                Issue resolved by pull request #3060
[https://github.com/apache/incubator-gobblin/pull/3060]
              </div></li></ol></div></div></html>