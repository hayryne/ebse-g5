<!DOCTYPE html><html><div class="item-title">
        Item 333
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div><div><b>comment:</b> *
 * Ozone contract tests creating files.
 
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div><div><b>comment:</b> *
 * Ozone contract tests covering deletes.
 
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
 * Contract test suite covering S3A integration with DistCp.
 * Uses the block output stream, buffered to disk. This is the
 * recommended output mechanism for DistCP due to its scalability.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div><div><b>comment:</b> *
 * Ozone contract tests covering getFileStatus.
 
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                *
 * Test dir operations on Ozone.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div><div><b>comment:</b> *
 * Ozone contract tests opening files.
 
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div><div><b>comment:</b> *
 * Ozone contract tests covering rename.
 
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div>
                 OFS doesn't support creating files directly under root
              </div></li><li><div>
                *
 * Ozone contract test for ROOT directory operations.
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div><div><b>comment:</b> *
 * Ozone contract tests covering file seek.
 
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div>
                 insert the base features
              </div></li><li><div>
                *
 * The contract of Rooted Ozone FileSystem (OFS).
 
              </div></li><li><div>
                assumes cluster is not null
              </div></li><li><div>
                 Note: FileSystem#loadFileSystems doesn't load OFS class because
  META-INF points to org.apache.hadoop.fs.ozone.OzoneFileSystem
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 *  or more contributor license agreements.  See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership.  The ASF licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 
              </div></li><li><div>
                 Handle DistCp /NONE path
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HDDS-2969. Implement ofs://: Add contract test (#865)
                </div><div><b>message:</b> HDDS-2969. Implement ofs://: Add contract test (#865)


                </div><div><b>label:</b> test
                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div></div></li><li><div><div><b>title:</b> HDDS-2969. Implement ofs://: Add contract test
                </div><div><b>body:</b> ## What changes were proposed in this pull request?

Add OFS contract tests.

## What is the link to the Apache JIRA

https://issues.apache.org/jira/browse/HDDS-2969

## How was this patch tested?

By the patch itself.
                </div><div><b>label:</b> test
                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                Comments:

1. I tried to reuse the existing contract test files but it Hadoop Common didn't pass parameters to `getTestFileSystem()` or `getTestPath()`. Hence the copy and paste classes.

Questions:

1. RootDir test doesn't seem to pass for the current state of OFS. e.g. rm /* doesn't really work in OFS at the moment:
&lt;img width="1415" alt="ContractRootDir" src="https://user-images.githubusercontent.com/50227127/80141341-41779f00-855e-11ea-9665-66f3dbd311aa.png"&gt;

~~Maybe I can set the "root" to a bucket to pass the test?~~
To be fully compliant with RootDir contract test, OFS needs to support deleting volumes with `rm` command.

I think we should learn from RBF which [disables some RootDir tests](https://github.com/apache/hadoop/blob/ffbb6b6557f4eb8587c7d57cda38f2a0de573f8b/hadoop-hdfs-project/hadoop-hdfs-rbf/src/test/java/org/apache/hadoop/fs/contract/router/TestRouterHDFSContractRootDirectory.java#L50-L73).
              </div></li><li><div>
                Update:

Out of the 5 tests I disabled in RootDir, 3 of them are able to pass with my (tentative) recursive delete root(`rm -r /`) and recursive delete volumes support:
- testRmEmptyRootDirNonRecursive
- testListEmptyRootDirectory
- testMkDirDepth1

But still 2 of them won't be able to run because they are trying to create file directly under root:
- testRmRootRecursive
- testRmNonEmptyRootDirNonRecursive

I will post the diff here just to run some checks first.
              </div></li><li><div>
                @xiaoyuyao 
The volume and bucket deletion support work will be done in HDDS-3494 (https://github.com/apache/hadoop-ozone/pull/906).

I will remove the commits in this PR that tentatively support volume and bucket deletion.

~I believe we can push the contract tests without volume and bucket deletion support at the moment. When HDDS-3494 is committed, I can re-enable those disabled RootDir contract tests.~
After an offline discussion with @xiaoyuyao we think it's better to merge HDDS-3494 before this one.

Marking this one blocked by #906 .
              </div></li><li><div><div><b>body:</b> Opened #928 for HA contract tests.
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                #906 is merged. Rebasing this patch in a moment
              </div></li><li><div>
                `TestOMRatisLogParser` failure looks unrelated.
              </div></li><li><div>
                Seems HDDS-3373 still not fix the issue completely on TestOMRatisLogParser. Agree this does not seem to relate to the change here. I will trigger another CI just in case. 
              </div></li><li><div>
                Retest failed to download artifact. Retriggering again.
```
[ERROR] Failed to execute goal on project hadoop-hdds-common: Could not resolve dependencies for project org.apache.hadoop:hadoop-hdds-common:jar:0.6.0-SNAPSHOT: Failed to collect dependencies at org.apache.ratis:ratis-server:jar:0.6.0-490b689-SNAPSHOT: Failed to read artifact descriptor for org.apache.ratis:ratis-server:jar:0.6.0-490b689-SNAPSHOT: Could not transfer artifact org.apache.ratis:ratis-server:pom:0.6.0-490b689-SNAPSHOT from/to apache.snapshots.https (https://repository.apache.org/content/repositories/snapshots): Failed to transfer file https://repository.apache.org/content/repositories/snapshots/org/apache/ratis/ratis-server/0.6.0-490b689-SNAPSHOT/ratis-server-0.6.0-490b689-SNAPSHOT.pom with status code 503 -&gt; [Help 1]
```
              </div></li><li><div>
                @smengcl Please rebase the branch to pick up this change from master #867. That should fix the CI issue. 
HDDS-3373. Intermittent failure in TestOMRatisLogParser (#867)

This seems to be an addendum commit in addition to the one that is currently in HDDS-2665-ofs branch. 
HDDS-3373. Intermittent failure in TestDnRatisLogParser and TestOMRatisLogParser (#858)
              </div></li><li><div>
                &gt; @smengcl Please rebase the branch to pick up this change from master #867. That should fix the CI issue.
&gt; [HDDS-3373](https://issues.apache.org/jira/browse/HDDS-3373). Intermittent failure in TestOMRatisLogParser (#867)
&gt; 
&gt; This seems to be an addendum commit in addition to the one that is currently in [HDDS-2665](https://issues.apache.org/jira/browse/HDDS-2665)-ofs branch.
&gt; [HDDS-3373](https://issues.apache.org/jira/browse/HDDS-3373). Intermittent failure in TestDnRatisLogParser and TestOMRatisLogParser (#858)

I attempted to rebase the OFS branch a few day ago locally but unfortunately it won't compile, implying changes to OFS classes is required due to other master branch work. I will do the rebase in another jira.

In the mean time I have picked up the addendum patch for HDDS-3373 in another dev branch just to run the tests:
https://github.com/smengcl/hadoop-ozone/commits/HDDS-2969-with-HDDS-3373-addendum
              </div></li><li><div>
                @xiaoyuyao I believe we can merge this PR now into OFS dev branch.
As [my dev branch with HDDS-3373 cherry-picked](https://github.com/smengcl/hadoop-ozone/commits/HDDS-2969-with-HDDS-3373-addendum) logs a [successful run](https://github.com/smengcl/hadoop-ozone/runs/721783494). This should prove the test failure in this PR is unrelated.

Will rebase the OFS dev branch after (involves manual changes to OFS classes due to master branch changes in the o3fs classes).
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div><div><b>body:</b> Do we need to override teardown and createConfiguration or it is just for the additional LOG?
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                listEmptyRoot should be OK for OFS?
              </div></li><li><div>
                mkdirDepth1 should be OK for admin? Can we add some configuration to allow this?
              </div></li><li><div><div><b>body:</b> Is it possible to add contract test in the context of HA setup as well as the non-HA?
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>body:</b> Copied from o3fs contract test. I believe it is just for the log.

Will remove this.
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                It fails because the test tries to delete dirs(volumes) at root:
```java
  @Test
  public void testListEmptyRootDirectory() throws IOException {
    skipIfUnsupported(TEST_ROOT_TESTS_ENABLED);
    FileSystem fs = getFileSystem();
    Path root = new Path("/");
    FileStatus[] statuses = fs.listStatus(root);
    for (FileStatus status : statuses) {
      ContractTestUtils.assertDeleted(fs, status.getPath(), true);
    }
```

```java
  public static void assertDeleted(FileSystem fs,
      Path file,
      boolean recursive,
      boolean allowRootOperations) throws IOException {
    rejectRootOperation(file, allowRootOperations);
    assertPathExists(fs, "about to be deleted file", file);
    boolean deleted = fs.delete(file, recursive);

```
              </div></li><li><div>
                It failed during clean up (assertDeleted):
```java
  @Test
  public void testMkDirDepth1() throws Throwable {
    FileSystem fs = getFileSystem();
    Path dir = new Path("/testmkdirdepth1");
    assertPathDoesNotExist("directory already exists", dir);
    fs.mkdirs(dir);
    assertIsDirectory(dir);
    assertPathExists("directory already exists", dir);
    assertDeleted(dir, true);
  }
```
              </div></li><li><div>
                I think we need another set of classes to do this but initialize with `MiniOzoneHAClusterImpl` instead.
              </div></li><li><div>
                are you seeing the root is not empty even though the test claim to list empty root dir?
              </div></li><li><div>
                this should be like create and delete an empty volume? why do we fail here?
              </div></li><li><div>
                Yes. I see `testvol1`, which is specified in `RootedOzoneContract#getTestPath`.
              </div></li><li><div>
                Because OFS doesn't support deleting volumes (or buckets) at the moment. Even if they are empty.
              </div></li></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Implement ofs://: Add contract test
                </div><div><b>description:</b> 
                </div></div></li><li><div><div><b>summary:</b> Implement ofs://: Add contract test
                </div><div><b>description:</b> 
                </div><div><b>label:</b> test
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>