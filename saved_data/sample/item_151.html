<!DOCTYPE html><html><div class="item-title">
        Item 151
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 set up conf to have a cred provider
              </div></li><li><div>
                 and that KMS lookup finds it
              </div></li><li><div>
                *
   * Set the SSE Key via the provision API, not the config itself.
   * @param conf config
   * @param option option name
   * @param key key to set
   * @throws Exception failure
   
              </div></li><li><div>
                *
   * Assert that the exception text from a config contains the expected string
   * @param expected expected substring
   * @param alg algorithm to ask for
   * @param key optional key value
   * @throws Exception anything else which gets raised
   
              </div></li><li><div>
                *
 * Test SSE setup operations and errors raised.
 
              </div></li><li><div>
                 let's set the password in config and ensure that it uses the credential
 provider provisioned value instead.
conf.set(OLD_S3A_SERVER_SIDE_ENCRYPTION_KEY, "oldKeyInConf");
              </div></li><li><div>
                 add our password to the provider
              </div></li><li><div>
                 let's set the password in config and ensure that it uses the credential
 provider provisioned value instead.
              </div></li><li><div>
                 verify key round trip
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 test the internal logic of the test setup code
              </div></li><li><div>
                *
   * Add a temp file provider to the config.
   * @param conf config
   * @throws Exception failure
   
              </div></li><li><div>
                *
   * Very that the old key is picked up via the properties
   * @throws Exception failure
   
              </div></li><li><div>
                *
   * The original key name. Never used in ASF releases,
   * but did get into downstream products.
   
              </div></li><li><div>
                *
   * Get the encryption mechanism from the value provided.
   * @param name algorithm name
   * @return the method
   * @throws IOException if the algorithm is unknown
   
              </div></li><li><div>
                * Add any deprecated keys. 
              </div></li><li><div>
                 never shipped in an ASF release, but did get into the wild.
              </div></li><li><div>
                *
   * Provide a password diagnostics string.
   * This aims to help diagnostics without revealing significant password details
   * @param pass password
   * @param description description for text, e.g "key" or "password"
   * @return text for use in messages.
   
              </div></li><li><div>
                *
   * Encryption SSE-C used but the config lacks an encryption key.
   
              </div></li><li><div>
                *
   * Get the server-side encryption algorithm.
   * This includes validation of the configuration, checking the state of
   * the encryption key given the chosen algorithm.
   * @param conf configuration to scan
   * @return the encryption mechanism (which will be {@code NONE} unless
   * one is set.
   * @throws IOException on any validation problem.
   
              </div></li><li><div>
                *
   * Get a password from a configuration, or, if a value is passed in,
   * pick that up instead.
   * @param conf configuration
   * @param key key to look up
   * @param val current value: if non empty this is used instead of
   * querying the configuration.
   * @param defVal default value if nothing is set
   * @return a password or "".
   * @throws IOException on any problem
   
              </div></li><li><div>
                *
   * Encryption SSE-S3 is used but the caller also set an encryption key.
   
              </div></li><li><div>
                *
   * Get any SSE key from a configuration/credential provider.
   * This operation handles the case where the option has been
   * set in the provider or configuration to the option
   * {@code OLD_S3A_SERVER_SIDE_ENCRYPTION_KEY}.
   * @param conf configuration to examine
   * @return the encryption key or null
   
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HADOOP-14324. Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics. Contributed by Steve Loughran
                </div><div><b>message:</b> HADOOP-14324. Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics. Contributed by Steve Loughran

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div><div><b>label:</b> documentation
                </div></div></li><li><div><div><b>summary:</b> Refine S3 server-side-encryption key as encryption secret; improve error reporting and diagnostics
                </div><div><b>description:</b> Before this ships, can we rename {{fs.s3a.server-side-encryption-key}} to {{fs.s3a.server-side-encryption.key}}.

This makes it consistent with all other .key secrets in S3A. so
* simplifies documentation
* reduces confusion "is it a - or a ."? This confusion is going to surface in config and support

I know that CDH is shipping with the old key, but it'll be easy for them to add a deprecation property to handle the migration. I do at least what the ASF release to be stable before it ships.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                [~moist] :I'm not doing this to deliberately to break your release, it's just that I'm already having problems with the naming scheme, looking at HADOOP-14243 to make sure the key is being stripped securely, etc. 

Renaming it now avoids the problem getting into the ASF releases, and it's straight forward for you add config options in core-default to (a) move the option and (b) add the old key to {{hadoop.security.sensitive-config-keys}}
              </div></li><li><div>
                patch 001
* switch keyname in Constants and docs
* add deprecation logic to S3AFS static init to pull in the old key
*   add fs.s3a.server-side-encryption.key as a redacted key in source and XML, with tests for the base property, and one under a bucket

I've not added the deprecated key to the list of redactables; if we'd shipped it
I would have. As it is the deprecation is in the source, and anyone who has shipped a version of Hadoop with the old key only has core-default.xml to patch.
              </div></li><li><div>
                Tested: S3 ireland.

+[~liuml07]: can you have a quick look @ this?

+ [~jzhuge] this covers a secret which the existing patterns don't catch, hence the tests. Comments welcome. Also: Make sure the version you are shipping filters this.
              </div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 15s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 49s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red}  3m 50s{color} | {color:red} root in branch-2 failed. {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m  8s{color} | {color:green} branch-2 passed with JDK v1.8.0_121 {color} |
| {color:red}-1{color} | {color:red} compile {color} | {color:red}  3m 36s{color} | {color:red} root in branch-2 failed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 29s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 25s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 27s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 22s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  1s{color} | {color:green} branch-2 passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  6s{color} | {color:green} branch-2 passed with JDK v1.7.0_121 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 17s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  1s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  7m  6s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  7m  6s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} compile {color} | {color:red}  3m 51s{color} | {color:red} root in the patch failed with JDK v1.7.0_121. {color} |
| {color:red}-1{color} | {color:red} javac {color} | {color:red}  3m 51s{color} | {color:red} root in the patch failed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 30s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 33s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green}  0m  0s{color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 53s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  6s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 17s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 49s{color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 29s{color} | {color:green} hadoop-aws in the patch passed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 26s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 88m  8s{color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| JDK v1.8.0_121 Failed junit tests | hadoop.ha.TestZKFailoverController |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:8515d35 |
| JIRA Issue | HADOOP-14324 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12864022/HADOOP-14324-branch-2-001.patch |
| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  xml  |
| uname | Linux cddb0b2d59bd 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | branch-2 / 1ae6be4 |
| Default Java | 1.7.0_121 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |
| mvninstall | https://builds.apache.org/job/PreCommit-HADOOP-Build/12125/artifact/patchprocess/branch-mvninstall-root.txt |
| compile | https://builds.apache.org/job/PreCommit-HADOOP-Build/12125/artifact/patchprocess/branch-compile-root-jdk1.7.0_121.txt |
| findbugs | v3.0.0 |
| compile | https://builds.apache.org/job/PreCommit-HADOOP-Build/12125/artifact/patchprocess/patch-compile-root-jdk1.7.0_121.txt |
| javac | https://builds.apache.org/job/PreCommit-HADOOP-Build/12125/artifact/patchprocess/patch-compile-root-jdk1.7.0_121.txt |
| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/12125/testReport/ |
| modules | C: hadoop-common-project/hadoop-common hadoop-tools/hadoop-aws U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/12125/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                Your patch suffers the same issue described in https://issues.apache.org/jira/browse/HADOOP-14038?focusedCommentId=15905605&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15905605.
To reproduce, add the deprecated key {{fs.s3a.server-side-encryption-key}} to {{core-site.xml}}, and run {{hadoop fs -Dfs.s3a.server-side-encryption-algorithm=SSE-C -cat s3a://sse-c-file}}.

To fix, call {{Configuration.reloadExistingConfigurations}} at end of {{addDeprecatedKeys}}.

I uploaded patch 002 with the fix and conflicts caused by my HADOOP-14241 resolved.
              </div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 17s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 40s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:red}-1{color} | {color:red} mvninstall {color} | {color:red}  3m 53s{color} | {color:red} root in branch-2 failed. {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m  4s{color} | {color:green} branch-2 passed with JDK v1.8.0_121 {color} |
| {color:red}-1{color} | {color:red} compile {color} | {color:red}  3m 38s{color} | {color:red} root in branch-2 failed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 29s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 31s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 35s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 20s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  1s{color} | {color:green} branch-2 passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 12s{color} | {color:green} branch-2 passed with JDK v1.7.0_121 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 17s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  5s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 57s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  5m 57s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} compile {color} | {color:red}  3m 43s{color} | {color:red} root in the patch failed with JDK v1.7.0_121. {color} |
| {color:red}-1{color} | {color:red} javac {color} | {color:red}  3m 43s{color} | {color:red} root in the patch failed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 31s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 32s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green}  0m  1s{color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 50s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  4s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 15s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 18s{color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 29s{color} | {color:green} hadoop-aws in the patch passed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 28s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 93m 51s{color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| JDK v1.8.0_121 Timed out junit tests | org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:8515d35 |
| JIRA Issue | HADOOP-14324 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12864209/HADOOP-14324-branch-2-002.patch |
| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  xml  |
| uname | Linux 381806cf013b 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | branch-2 / 6865746 |
| Default Java | 1.7.0_121 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |
| mvninstall | https://builds.apache.org/job/PreCommit-HADOOP-Build/12133/artifact/patchprocess/branch-mvninstall-root.txt |
| compile | https://builds.apache.org/job/PreCommit-HADOOP-Build/12133/artifact/patchprocess/branch-compile-root-jdk1.7.0_121.txt |
| findbugs | v3.0.0 |
| compile | https://builds.apache.org/job/PreCommit-HADOOP-Build/12133/artifact/patchprocess/patch-compile-root-jdk1.7.0_121.txt |
| javac | https://builds.apache.org/job/PreCommit-HADOOP-Build/12133/artifact/patchprocess/patch-compile-root-jdk1.7.0_121.txt |
| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/12133/testReport/ |
| modules | C: hadoop-common-project/hadoop-common hadoop-tools/hadoop-aws U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/12133/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                thanks for this [~jzhuge]. I'll apply and retest.

I didn't know about that reload thing. Makes we think: should we move the deprecation listings into hadoop-common, just to save on the hit of a reload of everything?
              </div></li><li><div><div><b>body:</b> Also want to tweak the exception strings slightly

This one, in particular, is confusing. There should be a "but" and the name of the key property
{code}
java.io.IOException: AES256 is configured and an encryption key is provided
	at org.apache.hadoop.fs.s3a.S3AFileSystem.initialize(S3AFileSystem.java:269)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:3242)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:467)
	at org.apache.hadoop.fs.contract.AbstractBondedFSContract.init(AbstractBondedFSContract.java:72)
	at org.apache.hadoop.fs.contract.AbstractFSContractTestBase.setup(AbstractFSContractTestBase.java:177)
	at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:168)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)
{code}

                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                +need to make sure that {{getServerSideEncryptionKey}} goes via the credential provider, ideally through a test.

it looks like it does, but given I had to read the code 2x to make sure, I'd like the test. Easiest if I pull out the whole config validation logic into S3AUtils for isolated testage
              </div></li><li><div>
                There is a known issue tracked by HADOOP-14251: if an old key is stored in cred store, it can not be read by a new key.
              </div></li><li><div>
                bq.  didn't know about that reload thing. Makes we think: should we move the deprecation listings into hadoop-common, just to save on the hit of a reload of everything?

Unfortunately moving deprecation listing to hadoop-common will force us to use a string literal for the new key because the constant for the new key is defined in hadoop-tools.
              </div></li><li><div><div><b>body:</b> I'm going to highlight that pickup via getPassword() doesn't seem to pick up property deprecation. This is going to be consistent across all uses...probably something nobody has noticed
before.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                HADOOP-14324 Patch 003

* Error strings improved with (secure) diagnostics
* Old keyname handled in credential provider as well as conf file
* Tests for all of this

I'm happy with this; tests make sure credentials get picked up, and
I've made sure that the old keyname is picked up from the conf file
and credential provider.
              </div></li><li><div>
                I'm pretty happy with the new code; this is the first place I'm adding a hint of diagnostics on secrets too

cases
* null password =&gt; "null password"
* len == 1 =&gt; "password of length 1"
* len &gt; 1 =&gt; "password of length $len ending with ${password[len-1]}"

That is: the length of a non-null password is returned, and the last char of it is returned if length &gt;1. 

The pass is returned; the cost of guess it is reduced by 1 byte, while providing a hint of details on what the pwd is. for any long secret (SSE-C, ultimately *and not in this JIRA* any AWS ID/Key)) doesn't get weakened much. I'm assuming that there are never secrets of just a few bytes, which holds for anything you actually want to secure.
              </div></li><li><div>
                Example stack trace of the new error. This is running the integration tests against a bucket in AWS london set to mandate AES256; auth-keys enables it too. This breaks the SSEC test setup, which is a separate issue.

{code}
testEncryption(org.apache.hadoop.fs.s3a.ITestS3AEncryptionSSECBlockOutputStream)  Time elapsed: 0.07 sec  &lt;&lt;&lt; ERROR!
java.io.IOException: AES256 is enabled but an encryption key was set in fs.s3a.server-side-encryption.key (key of length 44 ending with =)
	at org.apache.hadoop.fs.s3a.S3AUtils.getEncryptionAlgorithm(S3AUtils.java:797)
	at org.apache.hadoop.fs.s3a.S3AFileSystem.initialize(S3AFileSystem.java:260)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:3242)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:467)
	at org.apache.hadoop.fs.contract.AbstractBondedFSContract.init(AbstractBondedFSContract.java:72)
	at org.apache.hadoop.fs.contract.AbstractFSContractTestBase.setup(AbstractFSContractTestBase.java:177)
	at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)
{code}
              </div></li><li><div><div><b>body:</b> +1  Patch 003 LGTM with a nit:

TestConfigRedcator.java:67-68:  Move them to where the existing "fs.s3a" lines are?
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 18s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 3 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  1m  5s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 34s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 38s{color} | {color:green} branch-2 passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m 46s{color} | {color:green} branch-2 passed with JDK v1.7.0_121 {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 28s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 29s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 30s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 15s{color} | {color:green} branch-2 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  3s{color} | {color:green} branch-2 passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  8s{color} | {color:green} branch-2 passed with JDK v1.7.0_121 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 16s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  2s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m 33s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  6m 33s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  7m 10s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  7m 10s{color} | {color:green} the patch passed {color} |
| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  1m 31s{color} | {color:orange} root: The patch generated 3 new + 115 unchanged - 0 fixed = 118 total (was 115) {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 34s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} xml {color} | {color:green}  0m  0s{color} | {color:green} The patch has no ill-formed XML file. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 58s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  6s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 22s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 27s{color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  0m 29s{color} | {color:green} hadoop-aws in the patch passed with JDK v1.7.0_121. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 29s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 96m 34s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:8515d35 |
| JIRA Issue | HADOOP-14324 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12864351/HADOOP-14324-branch-2-003.patch |
| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  xml  |
| uname | Linux 18a1c057a7d4 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | branch-2 / f5a9287 |
| Default Java | 1.7.0_121 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |
| findbugs | v3.0.0 |
| checkstyle | https://builds.apache.org/job/PreCommit-HADOOP-Build/12135/artifact/patchprocess/diff-checkstyle-root.txt |
| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/12135/testReport/ |
| modules | C: hadoop-common-project/hadoop-common hadoop-tools/hadoop-aws U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/12135/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                +1
              </div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |
| {color:red}-1{color} | {color:red} patch {color} | {color:red}  0m  8s{color} | {color:red} HADOOP-14324 does not apply to trunk. Rebase required? Wrong Branch? See https://wiki.apache.org/hadoop/HowToContribute for help. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Issue | HADOOP-14324 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12864397/HADOOP-14324-trunk-003.patch |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/12141/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                Committed to {{trunk}} and {{branch-2}} branches. Also uploaded the patch for {{trunk}} branch for information.

Thanks [~stevel@apache.org] for your contribution. Thanks [~jzhuge] for reviewing.
              </div></li><li><div>
                I fixed [~jzhuge]'s last comment about test when committing.
              </div></li><li><div>
                SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #11617 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/11617/])
HADOOP-14324. Refine S3 server-side-encryption key as encryption secret; (liuml07: rev 667966c13c1e09077c2e2088bd66c9d7851dd14e)
* (edit) hadoop-common-project/hadoop-common/src/main/resources/core-default.xml
* (edit) hadoop-tools/hadoop-aws/src/site/markdown/tools/hadoop-aws/index.md
* (edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/CommonConfigurationKeysPublic.java
* (edit) hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/Constants.java
* (edit) hadoop-common-project/hadoop-common/src/site/markdown/DeprecatedProperties.md
* (add) hadoop-tools/hadoop-aws/src/test/java/org/apache/hadoop/fs/s3a/TestSSEConfiguration.java
* (edit) hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AEncryptionMethods.java
* (edit) hadoop-tools/hadoop-aws/src/test/java/org/apache/hadoop/fs/s3a/ITestS3AEncryptionAlgorithmValidation.java
* (edit) hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/conf/TestConfigRedactor.java
* (edit) hadoop-tools/hadoop-aws/src/site/markdown/tools/hadoop-aws/testing.md
* (edit) hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AFileSystem.java
* (edit) hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AUtils.java

              </div></li><li><div>
                thanks for everyone who reviewed this, esp [~jzhuge] for showing me more about how deprecated key handling works.

Given we had to tweak credential file loading to handle the new names, is this something we should do for the dfs. -&gt; fs.adl migration too?
              </div></li><li><div>
                Also, someone should sit down and implement HADOOP-7482  : there's no need registering configs which don't load in deprecated values, not as far as I can tell
              </div></li><li><div>
                [~jzhuge] OK, I see HADOOP-12451: you're aware of it, and it looks like I've seen it at one point. This patch does do the hoops of deprecation by looking for the old one, and using that as the default for the new one. Even though the ASF hasn't shipped this code and we could opt not to care, having CDH's S3 in sync with the ASF one can only be good all round: consistent stack traces, etc.
              </div></li><li><div><div><b>body:</b> This patch is the cause of warning messages telling users off for using a deprecated key, something we didnt' see in the logs. I think I'd like to clean up the code in the apache branches in HADOOP-14324;  no need to tell off all users for something we never shipped.
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div></div></html>