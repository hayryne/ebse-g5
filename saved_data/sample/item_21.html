<!DOCTYPE html><html><div class="item-title">
        Item 21
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 rowkey is same, need to compare the content of the row
              </div></li><li><div>
                 reach the region end of peer table, row only in source table
              </div></li><li><div>
                 row only exists in source table
              </div></li><li><div>
                 row only exists in peer table
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HBASE-10153 improve VerifyReplication to compute BADROWS more accurately (Jianwei)
                </div><div><b>message:</b> HBASE-10153 improve VerifyReplication to compute BADROWS more accurately (Jianwei)

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> improve VerifyReplication to compute BADROWS more accurately
                </div><div><b>description:</b> VerifyReplicaiton could compare the source table with its peer table and compute BADROWS. However, the current BADROWS computing method might not be accurate enough. For example, if source table contains rows as {r1, r2, r3, r4} and peer table contains rows as {r1, r3, r4} BADROWS will be 3 because 'r2' in source table will make all the later row comparisons fail. Will it be better if the BADROWS is computed to 1 in this situation? Maybe, we can compute the BADROWS more accurately in merge comparison?
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                This patch try to improve BADROWS computing including:
1. BADROWS is refined to ONLY_IN_SOURCE_TABLE_ROWS, ONLY_IN_PEER_TABLE_ROWS and CONTENT_DIFFERENT_ROWS. 
2. compute these counters in merge comparison between source and peer table.
              </div></li><li><div><div><b>body:</b> Without this improvement, there're so many BADROWS while these tow tables are consistent. It's a little misleading.

Please have a look. [~stack] [~lhofhansl]
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Can you provide patch for trunk ?
              </div></li><li><div>
                [~tedyu], thanks for your concern, I add a patch for trunk, please have a look.
              </div></li><li><div>
                This looks like nice utility.

This looks like a 'fix', an important change?

-            scan.setStartRow(value.getRow());
+            scan.setStartRow(tableSplit.getStartRow());
+            scan.setStopRow(tableSplit.getEndRow());

Patch LGTM.

Anyone more familiar with this tool want to chime in?
              </div></li><li><div>
                There was no additional comment. Will commit shortly.
              </div></li><li><div>
                Current patch is stale. Any chance of an update [~cuijianwei] ? I promise a quick commit after.
              </div></li><li><div>
                Rebased patch
              </div></li><li><div><div><b>body:</b> {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12672577/10153-v2-trunk.txt
  against trunk revision .
  ATTACHMENT ID: 12672577

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 lineLengths{color}.  The patch does not introduce lines longer than 100

  {color:green}+1 site{color}.  The mvn site goal succeeds with this patch.

     {color:red}-1 core tests{color}.  The patch failed these unit tests:
                       org.apache.hadoop.hbase.master.TestDistributedLogSplitting

     {color:red}-1 core zombie tests{color}.  There are 2 zombie test(s): 	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFilesSplitRecovery.testSplitWhileBulkLoadPhase(TestLoadIncrementalHFilesSplitRecovery.java:339)
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testSimpleLoad(TestLoadIncrementalHFiles.java:100)

Test results: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html
Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/11190//console

This message is automatically generated.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Patch for 0.98
[~apurtell]:
Do you want to take one more look ?
              </div></li><li><div>
                Skimmed it, lgtm
              </div></li><li><div>
                Thanks for the patch, Jianwei

Thanks for the reviews.
              </div></li><li><div>
                FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #537 (See [https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/537/])
HBASE-10153 improve VerifyReplication to compute BADROWS more accurately (Jianwei) (tedyu: rev a3cfd5233dfbfdd57ac445acd0886df2f8bae895)
* hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/replication/VerifyReplication.java

              </div></li><li><div>
                FAILURE: Integrated in HBase-0.98 #565 (See [https://builds.apache.org/job/HBase-0.98/565/])
HBASE-10153 improve VerifyReplication to compute BADROWS more accurately (Jianwei) (tedyu: rev a3cfd5233dfbfdd57ac445acd0886df2f8bae895)
* hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/replication/VerifyReplication.java

              </div></li><li><div>
                FAILURE: Integrated in HBase-1.0 #266 (See [https://builds.apache.org/job/HBase-1.0/266/])
HBASE-10153 improve VerifyReplication to compute BADROWS more accurately (Jianwei) (tedyu: rev a2fe4d6700c83a467b053f2d04115c69a27f3c79)
* hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/replication/VerifyReplication.java

              </div></li><li><div>
                FAILURE: Integrated in HBase-TRUNK #5613 (See [https://builds.apache.org/job/HBase-TRUNK/5613/])
HBASE-10153 improve VerifyReplication to compute BADROWS more accurately (Jianwei) (tedyu: rev 8dbf7b22381dab18f9af13318c16181c42824d46)
* hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/replication/VerifyReplication.java

              </div></li><li><div>
                Closing this issue after 0.99.1 release.
              </div></li></ol></div></div></html>