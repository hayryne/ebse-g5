<!DOCTYPE html><html><div class="item-title">
        Item 234
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                * 
              </div></li><li><div>
                * 
              </div></li><li><div>
                * @throws Exception if failed. 
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> IGNITE-13845 Add checkpoint metrics (#8572)
                </div><div><b>message:</b> IGNITE-13845 Add checkpoint metrics (#8572)


                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> IGNITE-13845 Add checkpoint metrics
                </div><div><b>body:</b> Thank you for submitting the pull request to the Apache Ignite.

In order to streamline the review of the contribution 
we ask you to ensure the following steps have been taken:

### The Contribution Checklist
- [ ] There is a single JIRA ticket related to the pull request. 
- [ ] The web-link to the pull request is attached to the JIRA ticket.
- [ ] The JIRA ticket has the _Patch Available_ state.
- [ ] The pull request body describes changes that have been made. 
The description explains _WHAT_ and _WHY_ was made instead of _HOW_.
- [ ] The pull request title is treated as the final commit message. 
The following pattern must be used: `IGNITE-XXXX Change summary` where `XXXX` - number of JIRA issue.
- [ ] A reviewer has been mentioned through the JIRA comments 
(see [the Maintainers list](https://cwiki.apache.org/confluence/display/IGNITE/How+to+Contribute#HowtoContribute-ReviewProcessandMaintainers)) 
- [ ] The pull request has been checked by the Teamcity Bot and 
the `green visa` attached to the JIRA ticket (see [TC.Bot: Check PR](https://mtcga.gridgain.com/prs.html))

### Notes
- [How to Contribute](https://cwiki.apache.org/confluence/display/IGNITE/How+to+Contribute)
- [Coding abbreviation rules](https://cwiki.apache.org/confluence/display/IGNITE/Abbreviation+Rules)
- [Coding Guidelines](https://cwiki.apache.org/confluence/display/IGNITE/Coding+Guidelines)
- [Apache Ignite Teamcity Bot](https://cwiki.apache.org/confluence/display/IGNITE/Apache+Ignite+Teamcity+Bot)

If you need any help, please email dev@ignite.apache.org or ask an—É advice on http://asf.slack.com _#ignite_ channel.

                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                Hello.

AFAICS, for now, we don't expose as metrics the following checkpoint numbers:

* `beforeLockDuration`
* `listenersExecuteDuration`
* `lockHoldDuration`
* `walCpRecordFsyncDuration`
* `writeCheckpointEntryDuration`
* `splitAndSortCpPagesDuration`

Can we add the altogether with this PR?
If yes, please, modify the ticket description and update the PR.
              </div></li><li><div>
                @nizhikov Hello. I have updated the ticket and added these metrics and new histograms. Could you take a look, please?
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Add checkpoint metrics
                </div><div><b>description:</b> Add last checkpoint duration metrics:
* beforeLockDuration
* listenersExecuteDuration
* lockHoldDuration
* walCpRecordFsyncDuration
* writeCheckpointEntryDuration
* splitAndSortCpPagesDuration

Add durations histograms:
* CheckpointBeforeLockHistogram
* CheckpointLockWaitHistogram
* CheckpointListenersExecuteHistogram
* CheckpointMarkHistogram
* CheckpointLockHoldHistogram
* CheckpointPagesWriteHistogram
* CheckpointFsyncHistogram
* CheckpointWalRecordFsyncHistogram
* CheckpointWriteEntryHistogram
* CheckpointSplitAndSortPagesHistogram
* CheckpointHistogram

                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                {panel:title=Branch: [pull/8572/head] Base: [master] : No blockers found!|borderStyle=dashed|borderColor=#ccc|titleBGColor=#D6F7C1}{panel}
{panel:title=Branch: [pull/8572/head] Base: [master] : New Tests (1)|borderStyle=dashed|borderColor=#ccc|titleBGColor=#D6F7C1}
{color:#00008b}PDS 2{color} [[tests 1|https://ci.ignite.apache.org/viewLog.html?buildId=5790030]]
* {color:#013220}IgnitePdsTestSuite2: IgniteDataStorageMetricsSelfTest.testCheckpointMetrics - PASSED{color}

{panel}
[TeamCity *--&amp;gt; Run :: All* Results|https://ci.ignite.apache.org/viewLog.html?buildId=5790058&amp;amp;buildTypeId=IgniteTests24Java8_RunAll]
              </div></li><li><div>
                [~NSAmelchev] 

Do you need any help here? Can we proceed?
              </div></li><li><div>
                Hello, [~mmuzaf], [~NSAmelchev]

I will do review shortly.
              </div></li><li><div>
                Merged to master.

[~NSAmelchev] Thanks for the contribution!
              </div></li><li><div><div><b>body:</b> Hello, [~NSAmelchev].
Please, don't forget to document those new metrics.
                </div><div><b>label:</b> documentation
                </div></div></li><li><div>
                Cherry-picked to 2.10
              </div></li></ol></div></div></html>