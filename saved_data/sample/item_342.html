<!DOCTYPE html><html><div class="item-title">
        Item 342
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> ACCUMULO-4067 Avoid repeatedly fetching the NetUtils#getInputStream method.
                </div><div><b>message:</b> ACCUMULO-4067 Avoid repeatedly fetching the NetUtils#getInputStream method.

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> TTimeoutTransport repeatedly uses reflection to obtain method
                </div><div><b>description:</b> Noticed the following in TTimeoutTransport while looking at ACCUMULO-4065:

{code}
  private static InputStream getInputStream(Socket socket, long timeout) {
    try {
      Method m = NetUtils.class.getMethod("getInputStream", Socket.class, Long.TYPE);
      return (InputStream) m.invoke(null, socket, timeout);
    } catch (Exception e) {
      throw new RuntimeException(e);
    }
  }
{code}

We should really just invoke {{getMethod}} once and cache the {{Method}} instance instead of repeatedly getting it every time we create a new connection (which is often).

Not sure if this is a "hot" enough code path to have a noticeable performance impact, but it should be good to fix regardless.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>summary:</b> TTimeoutTransport repeatedly uses reflection to obtain method
                </div><div><b>description:</b> Noticed the following in TTimeoutTransport while looking at ACCUMULO-4065:

{code}
  private static InputStream getInputStream(Socket socket, long timeout) {
    try {
      Method m = NetUtils.class.getMethod("getInputStream", Socket.class, Long.TYPE);
      return (InputStream) m.invoke(null, socket, timeout);
    } catch (Exception e) {
      throw new RuntimeException(e);
    }
  }
{code}

We should really just invoke {{getMethod}} once and cache the {{Method}} instance instead of repeatedly getting it every time we create a new connection (which is often).

Not sure if this is a "hot" enough code path to have a noticeable performance impact, but it should be good to fix regardless.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>summary:</b> TTimeoutTransport repeatedly uses reflection to obtain method
                </div><div><b>description:</b> Noticed the following in TTimeoutTransport while looking at ACCUMULO-4065:

{code}
  private static InputStream getInputStream(Socket socket, long timeout) {
    try {
      Method m = NetUtils.class.getMethod("getInputStream", Socket.class, Long.TYPE);
      return (InputStream) m.invoke(null, socket, timeout);
    } catch (Exception e) {
      throw new RuntimeException(e);
    }
  }
{code}

We should really just invoke {{getMethod}} once and cache the {{Method}} instance instead of repeatedly getting it every time we create a new connection (which is often).

Not sure if this is a "hot" enough code path to have a noticeable performance impact, but it should be good to fix regardless.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div><div><b>body:</b> Reduce down to major after a quick microbenchmark showed getMethod only taking about .5millis. Not going to be a big performance hit :)
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div></div></html>