<!DOCTYPE html><html><div class="item-title">
        Item 25
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HBASE-13578 Remove Arrays.asList().subList() from FSHLog.offer()
                </div><div><b>message:</b> HBASE-13578 Remove Arrays.asList().subList() from FSHLog.offer()

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Remove Arrays.asList().subList() from FSHLog.offer()
                </div><div><b>description:</b> while doing a run with a profiler I noticed this:
{code}
FSHLog.java
void offer(final long sequence, final SyncFuture [] syncFutures, final int syncFutureCount) {
  ...
  this.syncFutures.addAll(Arrays.asList(syncFutures).subList(0, syncFutureCount));
}
{code}
it is creating an Arrays.ArrayList then a RandomAccessSubList, 
and then addAll() is using creating an iterator and call the syncFutures.add() for each item.

a simpler for loop adding the items directly is not too ugly and it will avoid all this stuff.
I've attached a simple test to compare the two, it will not make huge difference but since we are in the core path any tiny bit probably helps.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div><div><b>body:</b> {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12728755/HBASE-13578-v0.patch
  against master branch at commit 75bb815d9954e538488c4c549f7261b5be80551b.
  ATTACHMENT ID: 12728755

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 hadoop versions{color}. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 protoc{color}.  The applied patch does not increase the total number of protoc compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 checkstyle{color}.  The applied patch does not increase the total number of checkstyle errors

    {color:green}+1 findbugs{color}.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 lineLengths{color}.  The patch does not introduce lines longer than 100

  {color:green}+1 site{color}.  The mvn site goal succeeds with this patch.

     {color:red}-1 core tests{color}.  The patch failed these unit tests:
                       org.apache.hadoop.hbase.TestJMXListener

Test results: https://builds.apache.org/job/PreCommit-HBASE-Build/13860//testReport/
Release Findbugs (version 2.0.3) 	warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/13860//artifact/patchprocess/newFindbugsWarnings.html
Checkstyle Errors: https://builds.apache.org/job/PreCommit-HBASE-Build/13860//artifact/patchprocess/checkstyle-aggregate.html

  Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/13860//console

This message is automatically generated.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                +1

That is a weird failure. Can't see how related.
              </div></li><li><div>
                It's broken in master on my box so not related to the patch.
              </div></li><li><div>
                +1 
              </div></li><li><div>
                Test failure is because of my patch on HBASE-13564, not related to this. Sorry for that. 
              </div></li><li><div>
                FAILURE: Integrated in HBase-1.1 #440 (See [https://builds.apache.org/job/HBase-1.1/440/])
HBASE-13578 Remove Arrays.asList().subList() from FSHLog.offer() (matteo.bertozzi: rev 3fba9de03e63fbf4b60734c32a75b00e2f892411)
* hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java

              </div></li><li><div>
                FAILURE: Integrated in HBase-1.2 #37 (See [https://builds.apache.org/job/HBase-1.2/37/])
HBASE-13578 Remove Arrays.asList().subList() from FSHLog.offer() (matteo.bertozzi: rev 3a9304e98f7e5a72649ad2aa45574a6f6e53db4d)
* hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java

              </div></li><li><div>
                FAILURE: Integrated in HBase-TRUNK #6429 (See [https://builds.apache.org/job/HBase-TRUNK/6429/])
HBASE-13578 Remove Arrays.asList().subList() from FSHLog.offer() (matteo.bertozzi: rev ee562faeb3cd0b7a49a1319fdc775f1d43e32341)
* hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java

              </div></li><li><div>
                Closing issues released in 1.1.0.
              </div></li></ol></div></div></html>