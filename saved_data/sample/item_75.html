<!DOCTYPE html><html><div class="item-title">
        Item 75
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div><div><b>comment:</b>  TODO: prevent parsing filters each time!
                </div><div><b>label:</b> requirement
                </div></div></li><li><div>
                 Check filters... if we do have filters they apply after domain changes.
 We still calculate them first because we can use it in a parent-&gt;child domain change.
              </div></li><li><div><div><b>comment:</b> * factory method for invoking json facet framework as whole.
   * Note: this is currently only used from SimpleFacets, not from JSON Facet API itself. 
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>comment:</b>  additional filters specified by "filter"  // TODO: do these need to be on the context to support recomputing during multi-select?
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                 test access to qparser and other query parameters
              </div></li><li><div>
                 empty filter list
              </div></li><li><div>
                 test filter
              </div></li><li><div>
                 also tests a top-level negative filter
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> SOLR-9681: add filters to any facet command
                </div><div><b>message:</b> SOLR-9681: add filters to any facet command

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> add filter to any facet
                </div><div><b>description:</b> For the JSON Facet API, we should be able to add a list of filters to any facet.  These would be applied after any domain changes, hence useful for parent-&gt;child mapping that would otherwise match all children of any parent (SOLR-9510)

The API should also be consistent with "filter" at the top level of the JSON Request API (examples at http://yonik.com/solr-json-request-api/ )

                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                Here's the patch I plan on committing soon.
              </div></li><li><div>
                Commit 650276e14bd85cdd12a77956f2403369ff3465ac in lucene-solr's branch refs/heads/master from [~yonik@apache.org]
[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=650276e ]

SOLR-9681: add filters to any facet command

              </div></li><li><div>
                Commit 05ea64a665d390d4ebbb985d0505941ef15f6d85 in lucene-solr's branch refs/heads/branch_6x from [~yonik@apache.org]
[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=05ea64a ]

SOLR-9681: add filters to any facet command

              </div></li><li><div>
                Commit d8d3a8b9b8e7345c4a02a62f7e321c4e9a2440bf in lucene-solr's branch refs/heads/master from [~yonik@apache.org]
[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d8d3a8b ]

SOLR-9681:tests: add filter after block join test

              </div></li><li><div>
                Commit 3ada3421cda4c9d5275b559f084dbc886eee4d72 in lucene-solr's branch refs/heads/branch_6x from [~yonik@apache.org]
[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3ada342 ]

SOLR-9681:tests: add filter after block join test

              </div></li><li><div><div><b>body:</b> [~yseeley@gmail.com], wouldn't be better to nest {{filter}} under {{domain}} as well it impacts input docset for faceting? 
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                I could go either way...
I was sort of viewing "domain" to be just about non-narrowing domain switches (filter exclusions, parent/child, block join)
              </div></li><li><div>
                ok. Agree. Now it can be seen as {{domain}} executed strictly before filtering and faceting.  
              </div></li><li><div><div><b>body:</b> Now that you've made me think about it... I'm definitely on the fence, and perhaps closer to the "just put it in domain" side.  Anyone else have thoughts?  This is the right time to think about this minor API stuff, and then stick to it for the long haul!

Thoughts about both sides:
"domain" is only for non-narrowing domain changes:
- If filtering will be used a lot by itself, then it's simpler not to have to enclose it in an extra "domain"

"domain" is for *all* domain changes prior to faceting:
- If filtering will primarily be used with things like blockChildren, "domain" will already exist, and it's natural for the additional child filters to go right there.
- The *only* "narrowing" way to change the domain (other than faceting itself), is "filter".  There are unlikely to be others in the future, and thus having a separate class/distinction at the syntactic level does not seem important.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                I think I like "filter" underneath "domain".  It's clearer *what* is being filtered -- the domain.  Granted that raises the question to users as to what the "domain" is but it's something.
              </div></li><li><div>
                OK, unless there are objections, I'll move "filter" to be within "domain".
              </div></li><li><div>
                Patch attached
              </div></li><li><div>
                Commit 359f981b0e2737c3d019d0097e5be3bf76874407 in lucene-solr's branch refs/heads/master from [~yonik@apache.org]
[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=359f981 ]

SOLR-9681: move "filter" inside "domain" block

              </div></li><li><div>
                Commit 8c42045f2781e44b22bf9ac8faca0b32346e5cc3 in lucene-solr's branch refs/heads/branch_6x from [~yonik@apache.org]
[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8c42045 ]

SOLR-9681: move "filter" inside "domain" block

              </div></li><li><div>
                Change is in, thanks for the input!
              </div></li><li><div>
                Commit 359f981b0e2737c3d019d0097e5be3bf76874407 in lucene-solr's branch refs/heads/apiv2 from [~yonik@apache.org]
[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=359f981 ]

SOLR-9681: move "filter" inside "domain" block

              </div></li></ol></div></div></html>