<!DOCTYPE html><html><div class="item-title">
        Item 356
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 1 TOTALSIZE
              </div></li><li><div>
                 8 SYSFLAG
              </div></li><li><div>
                 11 STORETIMESTAMP
              </div></li><li><div>
                 14 Prepared Transaction Offset
              </div></li><li><div>
                 Exceeds the maximum message
              </div></li><li><div>
                 4 FLAG
              </div></li><li><div>
                 5 BODY
              </div></li><li><div>
                Do not return flush_slave_timeout to the client, for the ons client will ignore it.
              </div></li><li><div>
                 10 BORNHOST
              </div></li><li><div>
                 15 BODY
              </div></li><li><div>
                 13 RECONSUMETIMES
              </div></li><li><div>
                 Set the storage time
              </div></li><li><div>
                 3 BODYCRC
              </div></li><li><div>
                spin or ReentrantLock ,depending on store config
              </div></li><li><div>
                 6 properties
              </div></li><li><div>
                 Determines whether there is sufficient free space
              </div></li><li><div>
                 Initialization of storage space
              </div></li><li><div>
                 7 PHYSICALOFFSET
              </div></li><li><div>
                 2 MAGICCODE
              </div></li><li><div>
                 5 FLAG
              </div></li><li><div>
                 17 PROPERTIES
              </div></li><li><div>
                 Back to Results
              </div></li><li><div>
                 16 TOPIC
              </div></li><li><div>
                 4 QUEUEID
              </div></li><li><div>
                 6 QUEUEOFFSET
              </div></li><li><div>
                 Statistics
              </div></li><li><div>
                 12 STOREHOSTADDRESS
              </div></li><li><div>
                 9 BORNTIMESTAMP
              </div></li><li><div>
                 should be less than 4
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> [ISSUE #690] Support batch msgs in dledger mode (#2406)
                </div><div><b>message:</b> [ISSUE #690] Support batch msgs in dledger mode (#2406)

* implement issue-690

* add unit test

* fix version

* fix wroteOffset;update version;polish

* polish

* fix wrong wroteOffset of AppendMessageResult

* move serialization out of lock in async method
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>github_issues:</b> <ol><li><div><div><b>title:</b> Method DLedgerCommitLog.putMessages(MessageExtBatch) not implemented
                </div><div><b>body:</b> Method `org.apache.rocketmq.store.dledger.DLedgerCommitLog.putMessages(MessageExtBatch)` is not implemented.

I built the new dledger-implemented rocketmq from branch _store_with_dledger_ and wanted to try the new HA solution. But the client keeps getting "**MQBrokerException: CODE: 13  DESC: the message is illegal**" when I try to send a batch of messages. After debugging and making sure that there is nothing wrong with the client code, I read the server-side code and found that the batch-message putting method of `DledgerCommitLog` is under development and it is returning error code of `MESSAGE_ILLEGAL`.

```
package org.apache.rocketmq.store.dledger;

public class DLedgerCommitLog extends CommitLog {
    @Override
    public PutMessageResult putMessages(final MessageExtBatch messageExtBatch) {
        return new PutMessageResult(PutMessageStatus.MESSAGE_ILLEGAL, null);
    }
}
```
                </div></div></li><li><div><div><b>title:</b> Method DLedgerCommitLog.putMessages(MessageExtBatch) not implemented
                </div><div><b>body:</b> Method `org.apache.rocketmq.store.dledger.DLedgerCommitLog.putMessages(MessageExtBatch)` is not implemented.

I built the new dledger-implemented rocketmq from branch _store_with_dledger_ and wanted to try the new HA solution. But the client keeps getting "**MQBrokerException: CODE: 13  DESC: the message is illegal**" when I try to send a batch of messages. After debugging and making sure that there is nothing wrong with the client code, I read the server-side code and found that the batch-message putting method of `DledgerCommitLog` is under development and it is returning error code of `MESSAGE_ILLEGAL`.

```
package org.apache.rocketmq.store.dledger;

public class DLedgerCommitLog extends CommitLog {
    @Override
    public PutMessageResult putMessages(final MessageExtBatch messageExtBatch) {
        return new PutMessageResult(PutMessageStatus.MESSAGE_ILLEGAL, null);
    }
}
```
                </div></div></li><li><div><div><b>title:</b> Method DLedgerCommitLog.putMessages(MessageExtBatch) not implemented
                </div><div><b>body:</b> Method `org.apache.rocketmq.store.dledger.DLedgerCommitLog.putMessages(MessageExtBatch)` is not implemented.

I built the new dledger-implemented rocketmq from branch _store_with_dledger_ and wanted to try the new HA solution. But the client keeps getting "**MQBrokerException: CODE: 13  DESC: the message is illegal**" when I try to send a batch of messages. After debugging and making sure that there is nothing wrong with the client code, I read the server-side code and found that the batch-message putting method of `DledgerCommitLog` is under development and it is returning error code of `MESSAGE_ILLEGAL`.

```
package org.apache.rocketmq.store.dledger;

public class DLedgerCommitLog extends CommitLog {
    @Override
    public PutMessageResult putMessages(final MessageExtBatch messageExtBatch) {
        return new PutMessageResult(PutMessageStatus.MESSAGE_ILLEGAL, null);
    }
}
```
                </div></div></li><li><div><div><b>title:</b> Method DLedgerCommitLog.putMessages(MessageExtBatch) not implemented
                </div><div><b>body:</b> Method `org.apache.rocketmq.store.dledger.DLedgerCommitLog.putMessages(MessageExtBatch)` is not implemented.

I built the new dledger-implemented rocketmq from branch _store_with_dledger_ and wanted to try the new HA solution. But the client keeps getting "**MQBrokerException: CODE: 13  DESC: the message is illegal**" when I try to send a batch of messages. After debugging and making sure that there is nothing wrong with the client code, I read the server-side code and found that the batch-message putting method of `DledgerCommitLog` is under development and it is returning error code of `MESSAGE_ILLEGAL`.

```
package org.apache.rocketmq.store.dledger;

public class DLedgerCommitLog extends CommitLog {
    @Override
    public PutMessageResult putMessages(final MessageExtBatch messageExtBatch) {
        return new PutMessageResult(PutMessageStatus.MESSAGE_ILLEGAL, null);
    }
}
```
                </div></div></li><li><div><div><b>title:</b> Method DLedgerCommitLog.putMessages(MessageExtBatch) not implemented
                </div><div><b>body:</b> Method `org.apache.rocketmq.store.dledger.DLedgerCommitLog.putMessages(MessageExtBatch)` is not implemented.

I built the new dledger-implemented rocketmq from branch _store_with_dledger_ and wanted to try the new HA solution. But the client keeps getting "**MQBrokerException: CODE: 13  DESC: the message is illegal**" when I try to send a batch of messages. After debugging and making sure that there is nothing wrong with the client code, I read the server-side code and found that the batch-message putting method of `DledgerCommitLog` is under development and it is returning error code of `MESSAGE_ILLEGAL`.

```
package org.apache.rocketmq.store.dledger;

public class DLedgerCommitLog extends CommitLog {
    @Override
    public PutMessageResult putMessages(final MessageExtBatch messageExtBatch) {
        return new PutMessageResult(PutMessageStatus.MESSAGE_ILLEGAL, null);
    }
}
```
                </div></div></li><li><div><div><b>title:</b> Method DLedgerCommitLog.putMessages(MessageExtBatch) not implemented
                </div><div><b>body:</b> Method `org.apache.rocketmq.store.dledger.DLedgerCommitLog.putMessages(MessageExtBatch)` is not implemented.

I built the new dledger-implemented rocketmq from branch _store_with_dledger_ and wanted to try the new HA solution. But the client keeps getting "**MQBrokerException: CODE: 13  DESC: the message is illegal**" when I try to send a batch of messages. After debugging and making sure that there is nothing wrong with the client code, I read the server-side code and found that the batch-message putting method of `DledgerCommitLog` is under development and it is returning error code of `MESSAGE_ILLEGAL`.

```
package org.apache.rocketmq.store.dledger;

public class DLedgerCommitLog extends CommitLog {
    @Override
    public PutMessageResult putMessages(final MessageExtBatch messageExtBatch) {
        return new PutMessageResult(PutMessageStatus.MESSAGE_ILLEGAL, null);
    }
}
```
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Method DLedgerCommitLog.putMessages(MessageExtBatch) not implemented
                </div><div><b>body:</b> Method `org.apache.rocketmq.store.dledger.DLedgerCommitLog.putMessages(MessageExtBatch)` is not implemented.

I built the new dledger-implemented rocketmq from branch _store_with_dledger_ and wanted to try the new HA solution. But the client keeps getting "**MQBrokerException: CODE: 13  DESC: the message is illegal**" when I try to send a batch of messages. After debugging and making sure that there is nothing wrong with the client code, I read the server-side code and found that the batch-message putting method of `DledgerCommitLog` is under development and it is returning error code of `MESSAGE_ILLEGAL`.

```
package org.apache.rocketmq.store.dledger;

public class DLedgerCommitLog extends CommitLog {
    @Override
    public PutMessageResult putMessages(final MessageExtBatch messageExtBatch) {
        return new PutMessageResult(PutMessageStatus.MESSAGE_ILLEGAL, null);
    }
}
```
                </div><div><b>label:</b> requirement
                </div></div></li></ol></div><div><b>github_issues_comments:</b> <ol><li><div>
                i meet the same  problem，when will support this future @vongosling 
              </div></li><li><div>
                I meet the same problem,when will support this future @vongosling   , thanks ~
              </div></li><li><div>
                I've done this.
This feature relies on dledger, and the PR has been submited.

https://github.com/openmessaging/openmessaging-storage-dledger/issues/64
              </div></li><li><div>
                &gt; I've done this.
&gt; This feature relies on dledger, and the PR has been submited.
&gt; 
&gt; [openmessaging/openmessaging-storage-dledger#64](https://github.com/openmessaging/openmessaging-storage-dledger/issues/64)

Hi @TerrellChen  I will review the pr ASAP.
              </div></li><li><div>
                i meet the same problem，when will support this future @RongtongJin
              </div></li></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>