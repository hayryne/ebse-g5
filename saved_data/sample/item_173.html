<!DOCTYPE html><html><div class="item-title">
        Item 173
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
 * This ScanLabelGenerator enforces a set of predefined authorizations for a
 * given user, the set defined by the admin using the VisibilityClient admin
 * interface or the set_auths shell command. Any authorizations requested with
 * Scan#authorizations will be ignored.
 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 Wait for the labels table to become available
              </div></li><li><div>
                 Set up for the test
              </div></li><li><div>
                 setup configuration
              </div></li><li><div>
                 Test that we enforce the defined set
              </div></li><li><div>
                 Test that we also enforce the defined set for the user if no auths are provided
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HBASE-10918 [VisibilityController] System table backed ScanLabelGenerator
                </div><div><b>message:</b> HBASE-10918 [VisibilityController] System table backed ScanLabelGenerator

git-svn-id: https://svn.apache.org/repos/asf/hbase/branches/0.98@1590181 13f79535-47bb-0310-9956-ffa450edef68

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> [VisibilityController] System table backed ScanLabelGenerator 
                </div><div><b>description:</b> A ScanLabelGenerator that retrieves a static set of authorizations for a user or group from a new HBase system table, and insures these auths are part of the effective set.

Useful for forcing a baseline set of auths for a user.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                This could also be useful as a replacement of the default SLG if the system designer does not want to consider user supplied auths.
              </div></li><li><div>
                Can i take this after delete on Visibility Labels is done?
              </div></li><li><div>
                Critical for 0.98.2.
              </div></li><li><div>
                Set up the effective authorization set for the user as the maximal set of auths defined for the user by the 'setauths' command.

As a stacked SLG we will assume we are at the bottom of the stack. Therefore we should also WARN if we find any auths passed in to us from the RPC context and drop them. 

Consider extending the 'setauths' command and its server side support for defining auths for groups using @group notation. The effective authorization set for a user would then be the union of user auths and auths for each group. 
              </div></li><li><div>
                If we punt the group support until later, then this becomes as simple as the addition of a trivial SLG. We already have the VisibilityLabelsManager to work with. See patch. Just needs a test. Let me know what you think. 
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12641635/HBASE-10918.patch
  against trunk revision .
  ATTACHMENT ID: 12641635

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 lineLengths{color}.  The patch does not introduce lines longer than 100

  {color:green}+1 site{color}.  The mvn site goal succeeds with this patch.

    {color:green}+1 core tests{color}.  The patch passed unit tests in .

Test results: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html
Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/9386//console

This message is automatically generated.
              </div></li><li><div>
                Patch looks good to me.  
bq.Just needs a test
Yes please. That will be better.

              </div></li><li><div>
                The name of the new generator can be changed?  Else looks good.  +1 for testcase.
              </div></li><li><div>
                bq. The name of the new generator can be changed

I chose the name because it describes what it does [~ram_krish]. Sorry, I don't have a better idea. Suggestion? Otherwise I will add a test and commit. 
              </div></li><li><div>
                UserAuthScanLabelEnforcer?  But this does not have the suffix generator in it.
If you feel its not better, pls go ahead with the commit.
              </div></li><li><div>
                Patch 10918_1 adds a new test. Passes locally. What I will commit soon.
              </div></li><li><div>
                Committed to trunk and 0.98. Thanks for the reviews Ram and Anoop.
              </div></li><li><div>
                SUCCESS: Integrated in HBase-0.98 #296 (See [https://builds.apache.org/job/HBase-0.98/296/])
HBASE-10918 [VisibilityController] System table backed ScanLabelGenerator (apurtell: rev 1590181)
* /hbase/branches/0.98/hbase-client/src/main/java/org/apache/hadoop/hbase/security/visibility/Authorizations.java
* /hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/DefaultScanLabelGenerator.java
* /hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/EnforcingScanLabelGenerator.java
* /hbase/branches/0.98/hbase-server/src/test/java/org/apache/hadoop/hbase/security/visibility/TestEnforcingScanLabelGenerator.java

              </div></li><li><div>
                SUCCESS: Integrated in HBase-0.98-on-Hadoop-1.1 #281 (See [https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/281/])
HBASE-10918 [VisibilityController] System table backed ScanLabelGenerator (apurtell: rev 1590181)
* /hbase/branches/0.98/hbase-client/src/main/java/org/apache/hadoop/hbase/security/visibility/Authorizations.java
* /hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/DefaultScanLabelGenerator.java
* /hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/EnforcingScanLabelGenerator.java
* /hbase/branches/0.98/hbase-server/src/test/java/org/apache/hadoop/hbase/security/visibility/TestEnforcingScanLabelGenerator.java

              </div></li><li><div>
                SUCCESS: Integrated in HBase-TRUNK #5120 (See [https://builds.apache.org/job/HBase-TRUNK/5120/])
HBASE-10918 [VisibilityController] System table backed ScanLabelGenerator (apurtell: rev 1590180)
* /hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/security/visibility/Authorizations.java
* /hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/DefaultScanLabelGenerator.java
* /hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/EnforcingScanLabelGenerator.java
* /hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/security/visibility/TestEnforcingScanLabelGenerator.java

              </div></li><li><div>
                Closing this issue after 0.99.0 release. 
              </div></li></ol></div></div></html>