<!DOCTYPE html><html><div class="item-title">
        Item 323
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 Ensure intended state for autoSkipNonRecoverableData
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Attempt to fix flakyness of BrokerBkEnsemblesTests.testSkipCorruptDataLedger (#2318)
                </div><div><b>message:</b> Attempt to fix flakyness of BrokerBkEnsemblesTests.testSkipCorruptDataLedger (#2318)


                </div><div><b>label:</b> test
                </div></div></li></ol></div><div><b>github_issues:</b> <ol><li><div><div><b>title:</b> Intermittent test failures in BrokerBkEnsemblesTests.testSkipCorruptDataLedger()
                </div><div><b>body:</b> https://builds.apache.org/job/pulsar-pull-request/org.apache.pulsar$pulsar-broker/2119/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

```
Error Message

Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000

Stacktrace

org.testng.internal.thread.ThreadTimeoutException: Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000
	at java.util.concurrent.FutureTask.run(FutureTask.java:271)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```
                </div></div></li><li><div><div><b>title:</b> Intermittent test failures in BrokerBkEnsemblesTests.testSkipCorruptDataLedger()
                </div><div><b>body:</b> https://builds.apache.org/job/pulsar-pull-request/org.apache.pulsar$pulsar-broker/2119/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

```
Error Message

Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000

Stacktrace

org.testng.internal.thread.ThreadTimeoutException: Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000
	at java.util.concurrent.FutureTask.run(FutureTask.java:271)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```
                </div></div></li><li><div><div><b>title:</b> Intermittent test failures in BrokerBkEnsemblesTests.testSkipCorruptDataLedger()
                </div><div><b>body:</b> https://builds.apache.org/job/pulsar-pull-request/org.apache.pulsar$pulsar-broker/2119/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

```
Error Message

Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000

Stacktrace

org.testng.internal.thread.ThreadTimeoutException: Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000
	at java.util.concurrent.FutureTask.run(FutureTask.java:271)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```
                </div></div></li><li><div><div><b>title:</b> Intermittent test failures in BrokerBkEnsemblesTests.testSkipCorruptDataLedger()
                </div><div><b>body:</b> https://builds.apache.org/job/pulsar-pull-request/org.apache.pulsar$pulsar-broker/2119/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

```
Error Message

Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000

Stacktrace

org.testng.internal.thread.ThreadTimeoutException: Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000
	at java.util.concurrent.FutureTask.run(FutureTask.java:271)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```
                </div></div></li><li><div><div><b>title:</b> Intermittent test failures in BrokerBkEnsemblesTests.testSkipCorruptDataLedger()
                </div><div><b>body:</b> https://builds.apache.org/job/pulsar-pull-request/org.apache.pulsar$pulsar-broker/2119/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

```
Error Message

Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000

Stacktrace

org.testng.internal.thread.ThreadTimeoutException: Method org.apache.pulsar.broker.service.BrokerBkEnsemblesTests.testSkipCorruptDataLedger() didn't finish within the time-out 6000
	at java.util.concurrent.FutureTask.run(FutureTask.java:271)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```
                </div></div></li></ol></div><div><b>github_issues_comments:</b> <ol><li><div>
                @rdhabalia I'm seeing this multiple times. Would it make sense to increase the timeout from 6seconds to something like 30?
              </div></li><li><div>
                you need to specify -DtestRetryCount=0 to see the failure
              </div></li><li><div>
                This seems to be fixed by #2318 
              </div></li></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> Attempt to fix flakyness of BrokerBkEnsemblesTests.testSkipCorruptDataLedger
                </div><div><b>body:</b> ### Motivation

`BrokerBkEnsemblesTests.testSkipCorruptDataLedger` has been intermettently failiing for a while. See #1388 #1126

eg:
https://builds.apache.org/job/pulsar_precommit_java8/2977/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

Tests appears to timeout. The most probably cause of the failures (which are 6seconds timeouts) is that entries are skipped in the first part of the test. This PR attempts to make sure the `autoSkipNonRecoverableData` setting is reset to false at the beginning of the test. This should ensure that the test can be executed multiple.

                </div></div></li><li><div><div><b>title:</b> Attempt to fix flakyness of BrokerBkEnsemblesTests.testSkipCorruptDataLedger
                </div><div><b>body:</b> ### Motivation

`BrokerBkEnsemblesTests.testSkipCorruptDataLedger` has been intermettently failiing for a while. See #1388 #1126

eg:
https://builds.apache.org/job/pulsar_precommit_java8/2977/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

Tests appears to timeout. The most probably cause of the failures (which are 6seconds timeouts) is that entries are skipped in the first part of the test. This PR attempts to make sure the `autoSkipNonRecoverableData` setting is reset to false at the beginning of the test. This should ensure that the test can be executed multiple.

                </div></div></li><li><div><div><b>title:</b> Attempt to fix flakyness of BrokerBkEnsemblesTests.testSkipCorruptDataLedger
                </div><div><b>body:</b> ### Motivation

`BrokerBkEnsemblesTests.testSkipCorruptDataLedger` has been intermettently failiing for a while. See #1388 #1126

eg:
https://builds.apache.org/job/pulsar_precommit_java8/2977/testReport/junit/org.apache.pulsar.broker.service/BrokerBkEnsemblesTests/testSkipCorruptDataLedger/

Tests appears to timeout. The most probably cause of the failures (which are 6seconds timeouts) is that entries are skipped in the first part of the test. This PR attempts to make sure the `autoSkipNonRecoverableData` setting is reset to false at the beginning of the test. This should ensure that the test can be executed multiple.

                </div><div><b>label:</b> test
                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                run cpp tests
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>