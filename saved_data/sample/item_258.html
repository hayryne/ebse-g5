<!DOCTYPE html><html><div class="item-title">
        Item 258
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
   * Initiate a non-sasl connection. The session hook will verfiy the user name
   * set correctly
   *
   * @throws Exception
   
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                 enable the hook check after the server startup,
              </div></li><li><div>
                 Store the user name in the open request in case no non-sasl authentication
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HIVE-6715 : Hive JDBC should include username into open session request for non-sasl connection (Prasad Mujumdar, reviewed by Vaibhav Gumashta, Thejas Nair)
                </div><div><b>message:</b> HIVE-6715 : Hive JDBC should include username into open session request for non-sasl connection (Prasad Mujumdar, reviewed by Vaibhav Gumashta, Thejas Nair)

git-svn-id: https://svn.apache.org/repos/asf/hive/branches/branch-0.14@1632420 13f79535-47bb-0310-9956-ffa450edef68

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Hive JDBC should include username into open session request for non-sasl connection
                </div><div><b>description:</b> The only parameter from sessVars that's being set in HiveConnection.openSession() is HS2_PROXY_USER. 
HIVE_AUTH_USER must also be set.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                [~prasadm] The change looks good. Is it possible to stick the tests in one of the existing test case classes though? 

              </div></li><li><div>
                [~vaibhavgumashta] Thanks for taking a look.
The problem is the nosasl transport mode. It needs to be set via system property (till HIVE-6665 is committed) and 
restart the server. That's what I had to add it to a separate test.

              </div></li><li><div>
                [~prasadm] Thanks for the patch. Looks good to me.  +1

I have rebased it for the latest trunk.

              </div></li><li><div>
                HIVE-6715.3.patch - In current trunk, setting the auth property via conf for MiniHS2 is what works  (HiveAuthFactory no longer creates a new hiveconf). Updating test case.

              </div></li><li><div>
                [~vikram.dixit] This is a useful bug fix. It is also small and should not be destabilizing. If it is not too late, would like to include it in 0.14 .

              </div></li><li><div>
                +1 for 0.14
              </div></li><li><div>
                Thanks [~thejas]!
              </div></li><li><div>
                

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12675019/HIVE-6715.3.patch

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 6560 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_custom_key
org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_custom_key2
org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_custom_key3
org.apache.hive.beeline.TestSchemaTool.testSchemaInit
org.apache.hive.beeline.TestSchemaTool.testSchemaUpgrade
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1294/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1294/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1294/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12675019
 - PreCommit-HIVE-TRUNK-Build
              </div></li><li><div>
                Patch committed to trunk and 0.14 branch.
Thanks  [~prasadm]!

              </div></li><li><div><div><b>body:</b> This looks like it doesn't need any user documentation ... but I want to be sure.
                </div><div><b>label:</b> documentation
                </div></div></li><li><div><div><b>body:</b> It is a bug fix. No documentation required for this one.

                </div><div><b>label:</b> documentation
                </div></div></li><li><div>
                This has been fixed in 0.14 release. Please open new jira if you see any issues.

              </div></li></ol></div></div></html>