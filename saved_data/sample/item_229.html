<!DOCTYPE html><html><div class="item-title">
        Item 229
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
   * Checks whether this block has a Provided replica.
   * @return true if this block has a replica on Provided storage.
   
              </div></li><li><div>
                *
   * Striped blocks on Provided Storage is not supported. All blocks on
   * Provided storage are assumed to be "contiguous".
   
              </div></li><li><div>
                 block with only disk storage
              </div></li><li><div>
                 block with only provided storage
              </div></li><li><div>
                 now add provided storage
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HDFS-14889. Ability to check if a block has a replica on provided storage. Contributed by Ashvin Agrawal. (#1573)"
                </div><div><b>message:</b> HDFS-14889. Ability to check if a block has a replica on provided storage. Contributed by Ashvin Agrawal. (#1573)"

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> HDFS-14889. Ability to check if a block has a replica on provided storage.
                </div><div><b>body:</b> Addresses https://issues.apache.org/jira/browse/HDFS-14889.
Adding a method in `BlockInfo` to return true of the block has any replica on a Provided storage.
                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                :broken_heart: **-1 overall**






| Vote | Subsystem | Runtime | Comment |
|:----:|----------:|--------:|:--------|
| 0 | reexec | 39 | Docker mode activated. |
||| _ Prechecks _ |
| +1 | dupname | 0 | No case conflicting files found. |
| +1 | @author | 0 | The patch does not contain any @author tags. |
| +1 | test4tests | 0 | The patch appears to include 1 new or modified test files. |
||| _ trunk Compile Tests _ |
| +1 | mvninstall | 1081 | trunk passed |
| +1 | compile | 65 | trunk passed |
| +1 | checkstyle | 46 | trunk passed |
| +1 | mvnsite | 72 | trunk passed |
| +1 | shadedclient | 835 | branch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 84 | trunk passed |
| 0 | spotbugs | 169 | Used deprecated FindBugs config; considering switching to SpotBugs. |
| +1 | findbugs | 166 | trunk passed |
||| _ Patch Compile Tests _ |
| +1 | mvninstall | 63 | the patch passed |
| +1 | compile | 62 | the patch passed |
| +1 | javac | 62 | the patch passed |
| +1 | checkstyle | 39 | the patch passed |
| +1 | mvnsite | 63 | the patch passed |
| +1 | whitespace | 0 | The patch has no whitespace issues. |
| +1 | shadedclient | 778 | patch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 82 | the patch passed |
| +1 | findbugs | 173 | the patch passed |
||| _ Other Tests _ |
| -1 | unit | 5596 | hadoop-hdfs in the patch failed. |
| +1 | asflicense | 41 | The patch does not generate ASF License warnings. |
| | | 9372 | |


| Reason | Tests |
|-------:|:------|
| Failed junit tests | hadoop.hdfs.server.blockmanagement.TestUnderReplicatedBlocks |
|   | hadoop.hdfs.tools.TestDFSZKFailoverController |
|   | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |


| Subsystem | Report/Notes |
|----------:|:-------------|
| Docker | Client=19.03.1 Server=19.03.1 base: https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/1/artifact/out/Dockerfile |
| GITHUB PR | https://github.com/apache/hadoop/pull/1573 |
| Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient findbugs checkstyle |
| uname | Linux 04f898c3378b 4.15.0-58-generic #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | personality/hadoop.sh |
| git revision | trunk / 41440ec |
| Default Java | 1.8.0_222 |
| unit | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/1/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |
|  Test Results | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/1/testReport/ |
| Max. process+thread count | 4004 (vs. ulimit of 5500) |
| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |
| Console output | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/1/console |
| versions | git=2.7.4 maven=3.3.9 findbugs=3.1.0-RC1 |
| Powered by | Apache Yetus 0.10.0 http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                :broken_heart: **-1 overall**






| Vote | Subsystem | Runtime | Comment |
|:----:|----------:|--------:|:--------|
| 0 | reexec | 50 | Docker mode activated. |
||| _ Prechecks _ |
| +1 | dupname | 0 | No case conflicting files found. |
| +1 | @author | 0 | The patch does not contain any @author tags. |
| +1 | test4tests | 0 | The patch appears to include 1 new or modified test files. |
||| _ trunk Compile Tests _ |
| +1 | mvninstall | 1415 | trunk passed |
| +1 | compile | 72 | trunk passed |
| +1 | checkstyle | 53 | trunk passed |
| +1 | mvnsite | 81 | trunk passed |
| +1 | shadedclient | 985 | branch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 82 | trunk passed |
| 0 | spotbugs | 205 | Used deprecated FindBugs config; considering switching to SpotBugs. |
| +1 | findbugs | 202 | trunk passed |
||| _ Patch Compile Tests _ |
| +1 | mvninstall | 73 | the patch passed |
| +1 | compile | 64 | the patch passed |
| +1 | javac | 64 | the patch passed |
| +1 | checkstyle | 43 | the patch passed |
| +1 | mvnsite | 71 | the patch passed |
| +1 | whitespace | 0 | The patch has no whitespace issues. |
| -1 | shadedclient | 272 | patch has errors when building and testing our client artifacts. |
| +1 | javadoc | 90 | the patch passed |
| -1 | findbugs | 26 | hadoop-hdfs in the patch failed. |
||| _ Other Tests _ |
| -1 | unit | 25 | hadoop-hdfs in the patch failed. |
| 0 | asflicense | 14 | ASF License check generated no output? |
| | | 3669 | |


| Subsystem | Report/Notes |
|----------:|:-------------|
| Docker | Client=19.03.1 Server=19.03.1 base: https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/2/artifact/out/Dockerfile |
| GITHUB PR | https://github.com/apache/hadoop/pull/1573 |
| Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient findbugs checkstyle |
| uname | Linux ff81f9dd94c3 4.15.0-58-generic #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | personality/hadoop.sh |
| git revision | trunk / 685918e |
| Default Java | 1.8.0_222 |
| findbugs | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/2/artifact/out/patch-findbugs-hadoop-hdfs-project_hadoop-hdfs.txt |
| unit | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/2/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |
|  Test Results | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/2/testReport/ |
| Max. process+thread count | 411 (vs. ulimit of 5500) |
| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |
| Console output | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/2/console |
| versions | git=2.7.4 maven=3.3.9 findbugs=3.1.0-RC1 |
| Powered by | Apache Yetus 0.10.0 http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                :broken_heart: **-1 overall**






| Vote | Subsystem | Runtime | Comment |
|:----:|----------:|--------:|:--------|
| 0 | reexec | 41 | Docker mode activated. |
||| _ Prechecks _ |
| +1 | dupname | 0 | No case conflicting files found. |
| +1 | @author | 0 | The patch does not contain any @author tags. |
| +1 | test4tests | 0 | The patch appears to include 1 new or modified test files. |
||| _ trunk Compile Tests _ |
| +1 | mvninstall | 1083 | trunk passed |
| +1 | compile | 68 | trunk passed |
| +1 | checkstyle | 49 | trunk passed |
| +1 | mvnsite | 74 | trunk passed |
| +1 | shadedclient | 925 | branch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 92 | trunk passed |
| 0 | spotbugs | 168 | Used deprecated FindBugs config; considering switching to SpotBugs. |
| +1 | findbugs | 166 | trunk passed |
||| _ Patch Compile Tests _ |
| +1 | mvninstall | 64 | the patch passed |
| +1 | compile | 61 | the patch passed |
| +1 | javac | 61 | the patch passed |
| +1 | checkstyle | 40 | the patch passed |
| +1 | mvnsite | 64 | the patch passed |
| +1 | whitespace | 0 | The patch has no whitespace issues. |
| +1 | shadedclient | 807 | patch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 79 | the patch passed |
| +1 | findbugs | 169 | the patch passed |
||| _ Other Tests _ |
| -1 | unit | 5347 | hadoop-hdfs in the patch failed. |
| +1 | asflicense | 43 | The patch does not generate ASF License warnings. |
| | | 9239 | |


| Reason | Tests |
|-------:|:------|
| Failed junit tests | hadoop.hdfs.server.namenode.TestRedudantBlocks |
|   | hadoop.hdfs.tools.TestDFSZKFailoverController |
|   | hadoop.hdfs.server.namenode.ha.TestStandbyCheckpoints |
|   | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |


| Subsystem | Report/Notes |
|----------:|:-------------|
| Docker | Client=19.03.1 Server=19.03.1 base: https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/3/artifact/out/Dockerfile |
| GITHUB PR | https://github.com/apache/hadoop/pull/1573 |
| Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient findbugs checkstyle |
| uname | Linux 3924a8d6fc07 4.15.0-58-generic #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | personality/hadoop.sh |
| git revision | trunk / 4c24f24 |
| Default Java | 1.8.0_222 |
| unit | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/3/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |
|  Test Results | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/3/testReport/ |
| Max. process+thread count | 4100 (vs. ulimit of 5500) |
| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |
| Console output | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/3/console |
| versions | git=2.7.4 maven=3.3.9 findbugs=3.1.0-RC1 |
| Powered by | Apache Yetus 0.10.0 http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                :broken_heart: **-1 overall**






| Vote | Subsystem | Runtime | Comment |
|:----:|----------:|--------:|:--------|
| 0 | reexec | 426 | Docker mode activated. |
||| _ Prechecks _ |
| +1 | dupname | 0 | No case conflicting files found. |
| +1 | @author | 0 | The patch does not contain any @author tags. |
| +1 | test4tests | 0 | The patch appears to include 1 new or modified test files. |
||| _ trunk Compile Tests _ |
| +1 | mvninstall | 1215 | trunk passed |
| +1 | compile | 63 | trunk passed |
| +1 | checkstyle | 45 | trunk passed |
| +1 | mvnsite | 70 | trunk passed |
| +1 | shadedclient | 912 | branch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 79 | trunk passed |
| 0 | spotbugs | 175 | Used deprecated FindBugs config; considering switching to SpotBugs. |
| +1 | findbugs | 173 | trunk passed |
||| _ Patch Compile Tests _ |
| +1 | mvninstall | 66 | the patch passed |
| +1 | compile | 57 | the patch passed |
| +1 | javac | 57 | the patch passed |
| +1 | checkstyle | 40 | the patch passed |
| +1 | mvnsite | 65 | the patch passed |
| +1 | whitespace | 0 | The patch has no whitespace issues. |
| +1 | shadedclient | 840 | patch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 76 | the patch passed |
| +1 | findbugs | 176 | the patch passed |
||| _ Other Tests _ |
| -1 | unit | 5951 | hadoop-hdfs in the patch failed. |
| +1 | asflicense | 35 | The patch does not generate ASF License warnings. |
| | | 10364 | |


| Reason | Tests |
|-------:|:------|
| Failed junit tests | hadoop.hdfs.server.namenode.TestNameNodeMXBean |
|   | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |
|   | hadoop.hdfs.TestRollingUpgrade |


| Subsystem | Report/Notes |
|----------:|:-------------|
| Docker | Client=19.03.1 Server=19.03.1 base: https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/4/artifact/out/Dockerfile |
| GITHUB PR | https://github.com/apache/hadoop/pull/1573 |
| Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient findbugs checkstyle |
| uname | Linux dedb0fa0bade 4.15.0-54-generic #58-Ubuntu SMP Mon Jun 24 10:55:24 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | personality/hadoop.sh |
| git revision | trunk / a3fe404 |
| Default Java | 1.8.0_222 |
| unit | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/4/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |
|  Test Results | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/4/testReport/ |
| Max. process+thread count | 3070 (vs. ulimit of 5500) |
| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |
| Console output | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/4/console |
| versions | git=2.7.4 maven=3.3.9 findbugs=3.1.0-RC1 |
| Powered by | Apache Yetus 0.10.0 http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                :broken_heart: **-1 overall**






| Vote | Subsystem | Runtime | Comment |
|:----:|----------:|--------:|:--------|
| 0 | reexec | 365 | Docker mode activated. |
||| _ Prechecks _ |
| +1 | dupname | 0 | No case conflicting files found. |
| +1 | @author | 0 | The patch does not contain any @author tags. |
| +1 | test4tests | 0 | The patch appears to include 1 new or modified test files. |
||| _ trunk Compile Tests _ |
| +1 | mvninstall | 1456 | trunk passed |
| +1 | compile | 77 | trunk passed |
| +1 | checkstyle | 57 | trunk passed |
| +1 | mvnsite | 85 | trunk passed |
| +1 | shadedclient | 1007 | branch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 95 | trunk passed |
| 0 | spotbugs | 213 | Used deprecated FindBugs config; considering switching to SpotBugs. |
| +1 | findbugs | 210 | trunk passed |
||| _ Patch Compile Tests _ |
| +1 | mvninstall | 78 | the patch passed |
| +1 | compile | 68 | the patch passed |
| +1 | javac | 67 | the patch passed |
| +1 | checkstyle | 47 | the patch passed |
| +1 | mvnsite | 65 | the patch passed |
| +1 | whitespace | 0 | The patch has no whitespace issues. |
| +1 | shadedclient | 782 | patch has no errors when building and testing our client artifacts. |
| +1 | javadoc | 82 | the patch passed |
| +1 | findbugs | 195 | the patch passed |
||| _ Other Tests _ |
| -1 | unit | 5219 | hadoop-hdfs in the patch failed. |
| +1 | asflicense | 42 | The patch does not generate ASF License warnings. |
| | | 10008 | |


| Reason | Tests |
|-------:|:------|
| Failed junit tests | hadoop.hdfs.server.namenode.TestRedudantBlocks |
|   | hadoop.hdfs.server.namenode.ha.TestPendingCorruptDnMessages |
|   | hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots |
|   | hadoop.hdfs.TestReconstructStripedFile |
|   | hadoop.hdfs.server.blockmanagement.TestUnderReplicatedBlocks |
|   | hadoop.hdfs.TestDFSInotifyEventInputStreamKerberized |


| Subsystem | Report/Notes |
|----------:|:-------------|
| Docker | Client=19.03.1 Server=19.03.1 base: https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/5/artifact/out/Dockerfile |
| GITHUB PR | https://github.com/apache/hadoop/pull/1573 |
| Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient findbugs checkstyle |
| uname | Linux b3f859c79d77 4.15.0-58-generic #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | personality/hadoop.sh |
| git revision | trunk / a3fe404 |
| Default Java | 1.8.0_222 |
| unit | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/5/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt |
|  Test Results | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/5/testReport/ |
| Max. process+thread count | 4824 (vs. ulimit of 5500) |
| modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |
| Console output | https://builds.apache.org/job/hadoop-multibranch/job/PR-1573/5/console |
| versions | git=2.7.4 maven=3.3.9 findbugs=3.1.0-RC1 |
| Powered by | Apache Yetus 0.10.0 http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                Thanks for posting this @ashvina and the review @goiri . Merged this into trunk.
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div>
                Can we just set by default as false and not do it here?
              </div></li><li><div>
                Shouldn't this already guarantee is false?
              </div></li><li><div>
                I see is the other method which goes over each DN, nevermind.
              </div></li><li><div>
                High level javadoc.
              </div></li><li><div>
                Add a comment saying why it's never provided.
              </div></li><li><div>
                Can you go over the overhead added to the regular pipeline without Provided?
              </div></li><li><div>
                I removed it for now.
              </div></li><li><div>
                I removed the check and there is no invocation in the regular pipeline now.
              </div></li><li><div>
                Added the javadoc.
              </div></li><li><div>
                space after the for
              </div></li><li><div>
                Space after the if
              </div></li><li><div>
                Fixed
              </div></li><li><div>
                Fixed
              </div></li><li><div>
                What about splitting this test into two with a name that describes what we are testing in each?
Another option would be to just have a different blockInfo for the second chunk.
              </div></li><li><div>
                There exists a test for verifying behavior of add storage, `testAddStorage `. I had originally modified the original test and added the `isProvided` check. It seemed a bit confusing and out of place to me. So I added this test to clearly test both the scenarios. I would prefer this over two split methods. 
I can rename the second blockInfo if that adds value.
              </div></li><li><div>
                I'm more concerned about readability. Renaming the second one is fine with me.
              </div></li><li><div>
                Thanks !
I renamed it and added one more check. 
              </div></li><li><div>
                The test now appears splittable. Give me a sec and I will improve it.
              </div></li><li><div>
                Done. Please take a look.
              </div></li><li><div>
                LGTM
              </div></li></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>