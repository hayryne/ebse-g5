<!DOCTYPE html><html><div class="item-title">
        Item 32
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HBASE-18743 HFiles in use by a table which has the same name and namespace with a default table cloned from snapshot may be deleted when that snapshot and default table are deleted (wenbang)
                </div><div><b>message:</b> HBASE-18743 HFiles in use by a table which has the same name and namespace with a default table cloned from snapshot may be deleted when that snapshot and default table are deleted (wenbang)

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> HFiles in use by a table which has the same name and namespace with a default table cloned from snapshot may be deleted when that snapshot and default table are deleted
                </div><div><b>description:</b> We recently had a critical production issue in which HFiles that were still in use by a table were deleted.
This appears to have been caused by conditions in which table have the same namespace and name with a default table cloned from snapshot.when snapshot and default table be deleted,HFiles that are still in use may be deleted.
For example:
Table with default namespace is: "t1"
The namespace of the new table is the same as the name of the default table, and is generated by snapshot cloned : "t1: t1"
When the snapshot and the default namespace table are deleted, the new table is also deleted in the used HFiles
This is because the creation of the BackReferenceFile get the table Name is not normal, resulting in can not find the reference file, hfilecleaner to delete the HFiles in used, when the table has not been major compact

{code:java}
  public static boolean create(final Configuration conf, final FileSystem fs,
      final Path dstFamilyPath, final TableName linkedTable, final String linkedRegion,
      final String hfileName, final boolean createBackRef) throws IOException {
    String familyName = dstFamilyPath.getName();
    String regionName = dstFamilyPath.getParent().getName();
    String tableName = FSUtils.getTableName(dstFamilyPath.getParent().getParent())
        .getNameAsString();
{code}
{code:java}
  public static TableName getTableName(Path tablePath) {
    return TableName.valueOf(tablePath.getParent().getName(), tablePath.getName());
  }
{code}
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                added patch
              </div></li><li><div>
                Have you verified the patch in your cluster ?
              </div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 43s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green}  0m  0s{color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  3m 48s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 15s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 20s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 10s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 33s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 15s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 16s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 15s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 15s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 20s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m  9s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 32m 32s{color} | {color:green} Patch does not cause any errors with Hadoop 2.6.1 2.6.2 2.6.3 2.6.4 2.6.5 2.7.1 2.7.2 2.7.3 or 3.0.0-alpha4. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 40s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 15s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  2m 17s{color} | {color:green} hbase-common in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m  7s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 43m 13s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=17.03.0-ce Server=17.03.0-ce Image:yetus/hbase:47a5614 |
| JIRA Issue | HBASE-18743 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12885069/HBASE_18743.patch |
| Optional Tests |  asflicense  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  |
| uname | Linux 9bc202f9c1a9 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/component/dev-support/hbase-personality.sh |
| git revision | master / e1eb532 |
| Default Java | 1.8.0_144 |
| findbugs | v3.1.0-RC3 |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/8439/testReport/ |
| modules | C: hbase-common U: hbase-common |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/8439/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div><div><b>body:</b> Hi Ted Yu,I have verified the patch in our cluster and it appears to be OK.
Need i add a test to the patch?
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>body:</b> HFileLink#create() is static.

Can you come up with a test and add it to TestHFileLink ?

Thanks
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                update patch
              </div></li><li><div>
                When I apply the test change only, TestHFileLink still passes.

Can you check ?
              </div></li><li><div>
                Thank you Ted Yu. 
I checked and updated the patch
              </div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 24s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green}  0m  0s{color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 33s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  3m 58s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 56s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 39s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 25s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 59s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 45s{color} | {color:green} master passed {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 20s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 55s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 55s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 41s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 26s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 39m 54s{color} | {color:green} Patch does not cause any errors with Hadoop 2.6.1 2.6.2 2.6.3 2.6.4 2.6.5 2.7.1 2.7.2 2.7.3 or 3.0.0-alpha4. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 49s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  7s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  2m 42s{color} | {color:green} hbase-common in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}108m 46s{color} | {color:red} hbase-server in the patch failed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  1m  4s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black}172m  4s{color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| Timed out junit tests | org.apache.hadoop.hbase.regionserver.TestSplitLogWorker |
|   | org.apache.hadoop.hbase.coprocessor.TestHTableWrapper |
|   | org.apache.hadoop.hbase.regionserver.wal.TestFSHLog |
|   | org.apache.hadoop.hbase.snapshot.TestSnapshotClientRetries |
|   | org.apache.hadoop.hbase.TestHBaseTestingUtility |
|   | org.apache.hadoop.hbase.coprocessor.TestRegionObserverScannerOpenHook |
|   | org.apache.hadoop.hbase.wal.TestWALFiltering |
|   | org.apache.hadoop.hbase.coprocessor.TestCoprocessorMetrics |
|   | org.apache.hadoop.hbase.regionserver.wal.TestWALReplay |
|   | org.apache.hadoop.hbase.security.access.TestAccessController2 |
|   | org.apache.hadoop.hbase.replication.TestReplicationStateHBaseImpl |
|   | org.apache.hadoop.hbase.quotas.TestMasterSpaceQuotaObserver |
|   | org.apache.hadoop.hbase.wal.TestWALSplitCompressed |
|   | org.apache.hadoop.hbase.replication.regionserver.TestWALEntryStream |
|   | org.apache.hadoop.hbase.constraint.TestConstraint |
|   | org.apache.hadoop.hbase.mob.compactions.TestPartitionedMobCompactor |
|   | org.apache.hadoop.hbase.quotas.TestRegionSizeUse |
|   | org.apache.hadoop.hbase.coprocessor.TestMasterObserver |
|   | org.apache.hadoop.hbase.regionserver.TestRegionServerAbort |
|   | org.apache.hadoop.hbase.regionserver.TestCompactSplitThread |
|   | org.apache.hadoop.hbase.regionserver.wal.TestLogRollAbort |
|   | org.apache.hadoop.hbase.ipc.TestRpcClientLeaks |
|   | org.apache.hadoop.hbase.coprocessor.TestWALObserver |
|   | org.apache.hadoop.hbase.regionserver.TestWalAndCompactingMemStoreFlush |
|   | org.apache.hadoop.hbase.io.asyncfs.TestFanOutOneBlockAsyncDFSOutput |
|   | org.apache.hadoop.hbase.coprocessor.TestIncrementTimeRange |
|   | org.apache.hadoop.hbase.regionserver.TestSplitWalDataLoss |
|   | org.apache.hadoop.hbase.io.encoding.TestDataBlockEncoders |
|   | org.apache.hadoop.hbase.quotas.TestSpaceQuotas |
|   | org.apache.hadoop.hbase.mob.compactions.TestMobCompactor |
|   | org.apache.hadoop.hbase.quotas.TestQuotaObserverChoreWithMiniCluster |
|   | org.apache.hadoop.hbase.regionserver.wal.TestLogRolling |
|   | org.apache.hadoop.hbase.coprocessor.TestRegionObserverForAddingMutationsFromCoprocessors |
|   | org.apache.hadoop.hbase.regionserver.throttle.TestCompactionWithThroughputController |
|   | org.apache.hadoop.hbase.io.hfile.TestScannerSelectionUsingTTL |
|   | org.apache.hadoop.hbase.regionserver.wal.TestLogRollingNoCluster |
|   | org.apache.hadoop.hbase.regionserver.throttle.TestFlushWithThroughputController |
|   | org.apache.hadoop.hbase.mob.TestExpiredMobFileCleaner |
|   | org.apache.hadoop.hbase.security.access.TestAccessControlFilter |
|   | org.apache.hadoop.hbase.backup.TestHFileArchiving |
|   | org.apache.hadoop.hbase.TestNamespace |
|   | org.apache.hadoop.hbase.io.encoding.TestChangingEncoding |
|   | org.apache.hadoop.hbase.io.hfile.TestForceCacheImportantBlocks |
|   | org.apache.hadoop.hbase.TestMovedRegionsCleaner |
|   | org.apache.hadoop.hbase.coprocessor.TestOpenTableInCoprocessor |
|   | org.apache.hadoop.hbase.quotas.TestSpaceQuotasWithSnapshots |
|   | org.apache.hadoop.hbase.regionserver.TestRecoveredEdits |
|   | org.apache.hadoop.hbase.TestInfoServers |
|   | org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelReplicationWithExpAsString |
|   | org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsReplication |
|   | org.apache.hadoop.hbase.security.access.TestCellACLs |
|   | org.apache.hadoop.hbase.quotas.TestQuotaObserverChoreRegionReports |
|   | org.apache.hadoop.hbase.snapshot.TestMobRestoreFlushSnapshotFromClient |
|   | org.apache.hadoop.hbase.replication.TestReplicationTableBase |
|   | org.apache.hadoop.hbase.TestIOFencing |
|   | org.apache.hadoop.hbase.snapshot.TestRestoreFlushSnapshotFromClient |
|   | org.apache.hadoop.hbase.io.encoding.TestLoadAndSwitchEncodeOnDisk |
|   | org.apache.hadoop.hbase.io.hfile.TestCacheOnWrite |
|   | org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization |
|   | org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithRemove |
|   | org.apache.hadoop.hbase.TestHColumnDescriptorDefaultVersions |
|   | org.apache.hadoop.hbase.fs.TestBlockReorder |
|   | org.apache.hadoop.hbase.security.access.TestCoprocessorWhitelistMasterObserver |
|   | org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort |
|   | org.apache.hadoop.hbase.regionserver.wal.TestAsyncWALReplayCompressed |
|   | org.apache.hadoop.hbase.io.hfile.TestHFileBlock |
|   | org.apache.hadoop.hbase.snapshot.TestRegionSnapshotTask |
|   | org.apache.hadoop.hbase.replication.TestMultiSlaveReplication |
|   | org.apache.hadoop.hbase.coprocessor.TestMasterCoprocessorExceptionWithRemove |
|   | org.apache.hadoop.hbase.wal.TestBoundedRegionGroupingStrategy |
|   | org.apache.hadoop.hbase.wal.TestWALFactory |
|   | org.apache.hadoop.hbase.security.access.TestZKPermissionWatcher |
|   | org.apache.hadoop.hbase.quotas.TestQuotaAdmin |
|   | org.apache.hadoop.hbase.replication.regionserver.TestTableBasedReplicationSourceManagerImpl |
|   | org.apache.hadoop.hbase.regionserver.TestHRegionServerBulkLoad |
|   | org.apache.hadoop.hbase.replication.TestMasterReplication |
|   | org.apache.hadoop.hbase.replication.regionserver.TestReplicationSourceManagerZkImpl |
|   | org.apache.hadoop.hbase.regionserver.wal.TestSecureAsyncWALReplay |
|   | org.apache.hadoop.hbase.replication.TestReplicationSource |
|   | org.apache.hadoop.hbase.coprocessor.TestMasterCoprocessorExceptionWithAbort |
|   | org.apache.hadoop.hbase.tool.TestCanaryTool |
|   | org.apache.hadoop.hbase.io.TestFileLink |
|   | org.apache.hadoop.hbase.wal.TestWALSplit |
|   | org.apache.hadoop.hbase.io.encoding.TestEncodedSeekers |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hbase:47a5614 |
| JIRA Issue | HBASE-18743 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12885119/HBASE_18743_v1.patch |
| Optional Tests |  asflicense  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  |
| uname | Linux e39b625b3b67 3.13.0-116-generic #163-Ubuntu SMP Fri Mar 31 14:13:22 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build@2/component/dev-support/hbase-personality.sh |
| git revision | master / 7c51d3f |
| Default Java | 1.8.0_144 |
| findbugs | v3.1.0-RC3 |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/8446/artifact/patchprocess/patch-unit-hbase-server.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/8446/testReport/ |
| modules | C: hbase-common hbase-server U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/8446/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 18s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green}  0m  0s{color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 19s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  3m 34s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 53s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 40s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 25s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 38s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 44s{color} | {color:green} master passed {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 21s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 13s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 45s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 28s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 35m 37s{color} | {color:green} Patch does not cause any errors with Hadoop 2.6.1 2.6.2 2.6.3 2.6.4 2.6.5 2.7.1 2.7.2 2.7.3 or 3.0.0-alpha4. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 43s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 49s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  2m 18s{color} | {color:green} hbase-common in the patch passed. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 99m  9s{color} | {color:green} hbase-server in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 27s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black}155m 58s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=1.12.3 Server=1.12.3 Image:yetus/hbase:47a5614 |
| JIRA Issue | HBASE-18743 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12885124/HBASE_18743_v2.patch |
| Optional Tests |  asflicense  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  |
| uname | Linux 78e150d1cae1 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/component/dev-support/hbase-personality.sh |
| git revision | master / 7c51d3f |
| Default Java | 1.8.0_144 |
| findbugs | v3.1.0-RC3 |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/8447/testReport/ |
| modules | C: hbase-common hbase-server U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/8447/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                Nice find. Would you please close the github pull request?
              </div></li><li><div>
                The following test fails without the patch.
{code}
  @Test
  public void testValueOfNamespaceAndQualifier() {
    TableName name0 = TableName.valueOf("table");
    TableName name1 = TableName.valueOf("table", "table");
    assertEquals(NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR, name0.getNamespaceAsString());
    assertEquals("table", name0.getQualifierAsString());
    assertEquals("table", name0.getNameAsString());
    assertEquals("table", name1.getNamespaceAsString());
    assertEquals("table", name1.getQualifierAsString());
    assertEquals("table:table", name1.getNameAsString());
  }
{code}
+1 

              </div></li><li><div>
                Hi Chia-Ping Tsai,I have  closed the pull request.
              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-Trunk_matrix #3650 (See [https://builds.apache.org/job/HBase-Trunk_matrix/3650/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev 83175fdf8375527fb893debfa441e3862d5093b9)
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java

              </div></li><li><div>
                Patch doesn't apply to branch-1

Please attach patch for branch-1
              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-2.0 #449 (See [https://builds.apache.org/job/HBase-2.0/449/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev c762753b4ba98c4e17abb020d63d6f78abc61bc2)
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java

              </div></li><li><div>
                added patch to branch-1
thank you Chia-Ping Tsai,i have added the test.
              </div></li><li><div><div><b>body:</b> There is TestNamespace.

Can you move the test there ?
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |
| {color:red}-1{color} | {color:red} patch {color} | {color:red}  0m  4s{color} | {color:red} HBASE-18743 does not apply to master. Rebase required? Wrong Branch? See https://yetus.apache.org/documentation/0.4.0/precommit-patchnames for help. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Issue | HBASE-18743 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12885185/HBASE-18743_branch-1.patch |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/8457/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                move test to TestNamespace
              </div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |
| {color:red}-1{color} | {color:red} patch {color} | {color:red}  0m  5s{color} | {color:red} HBASE-18743 does not apply to master. Rebase required? Wrong Branch? See https://yetus.apache.org/documentation/0.4.0/precommit-patchnames for help. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Issue | HBASE-18743 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12885188/HBASE-18743_branch-1_v1.patch |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/8458/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                rename patch for branch-1
              </div></li><li><div>
                | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 38s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} hbaseanti {color} | {color:green}  0m  0s{color} | {color:green} Patch does not have any anti-patterns. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 33s{color} | {color:blue} Maven dependency ordering for branch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  2m 29s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 41s{color} | {color:green} branch-1 passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 38s{color} | {color:green} branch-1 passed with JDK v1.7.0_131 {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 15s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 54s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  5m 16s{color} | {color:green} branch-1 passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 26s{color} | {color:green} branch-1 passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 41s{color} | {color:green} branch-1 passed with JDK v1.7.0_131 {color} |
| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 15s{color} | {color:blue} Maven dependency ordering for patch {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 10s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 59s{color} | {color:green} the patch passed with JDK v1.8.0_144 {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 17s{color} | {color:green} hbase-common in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 42s{color} | {color:green} hbase-server-jdk1.8.0_144 with JDK v1.8.0_144 generated 0 new + 5 unchanged - 5 fixed = 5 total (was 10) {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  2s{color} | {color:green} the patch passed with JDK v1.7.0_131 {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 20s{color} | {color:green} hbase-common in the patch passed with JDK v1.7.0_131. {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 42s{color} | {color:green} hbase-server-jdk1.7.0_131 with JDK v1.7.0_131 generated 0 new + 5 unchanged - 5 fixed = 5 total (was 10) {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 48s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 31s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} hadoopcheck {color} | {color:green} 19m  8s{color} | {color:green} The patch does not cause any errors with Hadoop 2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.1 2.6.2 2.6.3 2.7.1. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 31s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 17s{color} | {color:green} hbase-common in the patch passed with JDK v1.8.0_144. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 31s{color} | {color:green} hbase-server-jdk1.8.0_144 with JDK v1.8.0_144 generated 0 new + 3 unchanged - 3 fixed = 3 total (was 6) {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 20s{color} | {color:green} hbase-common in the patch passed with JDK v1.7.0_131. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 41s{color} | {color:green} hbase-server-jdk1.7.0_131 with JDK v1.7.0_131 generated 0 new + 3 unchanged - 3 fixed = 3 total (was 6) {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  1m 52s{color} | {color:green} hbase-common in the patch passed. {color} |
| {color:red}-1{color} | {color:red} unit {color} | {color:red}105m 13s{color} | {color:red} hbase-server in the patch failed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 34s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black}155m 28s{color} | {color:black} {color} |
\\
\\
|| Reason || Tests ||
| Failed junit tests | hadoop.hbase.mapred.TestTableSnapshotInputFormat |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hbase:6f1cc2c |
| JIRA Issue | HBASE-18743 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12885190/HBASE-18743-branch-1.patch |
| Optional Tests |  asflicense  javac  javadoc  unit  findbugs  hadoopcheck  hbaseanti  checkstyle  compile  |
| uname | Linux 381fa4603f5e 3.13.0-116-generic #163-Ubuntu SMP Fri Mar 31 14:13:22 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/patchprocess/precommit/personality/hbase.sh |
| git revision | branch-1 / 6a5bb3b |
| Default Java | 1.7.0_131 |
| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_144 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_131 |
| findbugs | v3.0.0 |
| unit | https://builds.apache.org/job/PreCommit-HBASE-Build/8459/artifact/patchprocess/patch-unit-hbase-server.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HBASE-Build/8459/testReport/ |
| modules | C: hbase-common hbase-server U: . |
| Console output | https://builds.apache.org/job/PreCommit-HBASE-Build/8459/console |
| Powered by | Apache Yetus 0.4.0   http://yetus.apache.org |


This message was automatically generated.


              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-1.2-IT #951 (See [https://builds.apache.org/job/HBase-1.2-IT/951/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev 9b0f2fa3e225554f6b36028c276f056fe27dfe7e)
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/TestNamespace.java
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java

              </div></li><li><div>
                Thanks for the patch, wenbang.

Thanks for the review, Chia-ping.
              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-1.3-JDK7 #268 (See [https://builds.apache.org/job/HBase-1.3-JDK7/268/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev d59ca63237a064f18ca5b7069b558c3fb21cdfb4)
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/TestNamespace.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java

              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-1.3-IT #201 (See [https://builds.apache.org/job/HBase-1.3-IT/201/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev d59ca63237a064f18ca5b7069b558c3fb21cdfb4)
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/TestNamespace.java

              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-1.2-JDK7 #216 (See [https://builds.apache.org/job/HBase-1.2-JDK7/216/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev 9b0f2fa3e225554f6b36028c276f056fe27dfe7e)
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/TestNamespace.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java

              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-1.5 #46 (See [https://builds.apache.org/job/HBase-1.5/46/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev d5033fd3502e24af358dd208b39769bcaee2dc3a)
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/TestNamespace.java
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java

              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-1.4 #901 (See [https://builds.apache.org/job/HBase-1.4/901/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev c97f0f2f24ab760d61ac74d159ee4f47a7c7d2d6)
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/TestNamespace.java
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java

              </div></li><li><div>
                FAILURE: Integrated in Jenkins build HBase-1.2-JDK8 #213 (See [https://builds.apache.org/job/HBase-1.2-JDK8/213/])
HBASE-18743 HFiles in use by a table which has the same name and (tedyu: rev 9b0f2fa3e225554f6b36028c276f056fe27dfe7e)
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/TestNamespace.java
* (edit) hbase-common/src/main/java/org/apache/hadoop/hbase/TableName.java
* (edit) hbase-server/src/test/java/org/apache/hadoop/hbase/io/TestHFileLink.java

              </div></li></ol></div></div></html>