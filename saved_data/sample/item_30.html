<!DOCTYPE html><html><div class="item-title">
        Item 30
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
   * Temporary buffer used for various operations that would otherwise require a
   * small allocation.
   
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> THRIFT-3484 Consolidate temporary buffers in Java's TCompactProtocol
                </div><div><b>message:</b> THRIFT-3484 Consolidate temporary buffers in Java's TCompactProtocol
Client: Java
Patch: Tom Lee

This closes #738

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> THRIFT-3484 Consolidate temporary buffers in Java's TCompactProtocol
                </div><div><b>body:</b> TCompactProtocol allocates a number of small temporary buffers per-instance and, in some cases e.g. readDouble(), per-method-call. It's fairly trivial to consolidate these &amp; save maybe 32 bytes of overhead per TCompactProtocol instance and possibly a bunch more for structs that contain lots of doubles.

Seems like we can also avoid allocating empty ByteBuffers + byte[]s in readBinary() by returning singletons.

                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Consolidate temporary buffers in Java's TCompactProtocol
                </div><div><b>description:</b> TCompactProtocol allocates a number of small temporary buffers per-instance and, in some cases e.g. readDouble(), per-method-call. It's fairly trivial to consolidate these &amp; save maybe 32 bytes of overhead per TCompactProtocol instance and possibly a bunch more for structs that contain lots of doubles.

Seems like we can also avoid allocating empty ByteBuffers + byte[]s in readBinary() by returning singletons.

                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                GitHub user thomaslee opened a pull request:

    https://github.com/apache/thrift/pull/738

    THRIFT-3484 Consolidate temporary buffers in Java's TCompactProtocol

    TCompactProtocol allocates a number of small temporary buffers per-instance and, in some cases e.g. readDouble(), per-method-call. It's fairly trivial to consolidate these &amp; save maybe 32 bytes of overhead per TCompactProtocol instance and possibly a bunch more for structs that contain lots of doubles.
    
    Seems like we can also avoid allocating empty ByteBuffers + byte[]s in readBinary() by returning singletons.

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/thomaslee/thrift tcompact_temp

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/thrift/pull/738.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #738
    
----
commit 0c1ca80ad1c5c308126a55449a9185d285dc58f6
Author: Tom Lee &lt;github@tomlee.co&gt;
Date:   2015-12-10T08:10:30Z

    THRIFT-3484 Consolidate temporary buffers in Java's TCompactProtocol

----

              </div></li><li><div>
                Github user asfgit closed the pull request at:

    https://github.com/apache/thrift/pull/738

              </div></li><li><div>
                Committed, thanks Tom !
              </div></li><li><div>
                SUCCESS: Integrated in Thrift #1764 (See [https://builds.apache.org/job/Thrift/1764/])
THRIFT-3484 Consolidate temporary buffers in Java's TCompactProtocol (nsuke: rev 4f6138b7a2762f1937b49389f72b348736973e22)
* lib/java/src/org/apache/thrift/protocol/TCompactProtocol.java

              </div></li></ol></div></div></html>