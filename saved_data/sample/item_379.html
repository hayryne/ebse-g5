<!DOCTYPE html><html><div class="item-title">
        Item 379
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> [Carbondata-3954] Fix insertion from ORC table into carbon table when sort scope is global sort
                </div><div><b>message:</b> [Carbondata-3954] Fix insertion from ORC table into carbon table when sort scope is global sort

Why is this PR needed?
Loading records from ORC table having null values into carbon table having sort scope as global sort gives NPE.

What changes were proposed in this PR?
Added null check for arrayType and mapType before writing the data into byteArrays

Does this PR introduce any user interface change?
No

Is any new testcase added?
Yes

This closes #3979

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> [Carbondata-3954] Fix insertion from ORC table into carbon table when sort scope is global sort
                </div><div><b>body:</b> ### Why is this PR needed?
Loading records from ORC table having null values into carbon table having sort scope as global sort gives NPE.
 
 ### What changes were proposed in this PR?
Added null check for arrayType and mapType before writing the data into byteArrays

 ### Does this PR introduce any user interface change?
 - No

 ### Is any new testcase added?
 - Yes

    

                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                Build Success with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2622/

              </div></li><li><div>
                Build Success with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4372/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4436/

              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2683/

              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2765/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4519/

              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2778/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4532/

              </div></li><li><div>
                retest this please
              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2782/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4536/

              </div></li><li><div>
                retest this please
              </div></li><li><div>
                Build Success with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4558/

              </div></li><li><div>
                retest this please
              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2808/

              </div></li><li><div>
                retest this please
              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2817/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4569/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4574/

              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2825/

              </div></li><li><div>
                retest this please
              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4580/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4583/

              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2832/

              </div></li><li><div>
                retest this please
              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4625/

              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2870/

              </div></li><li><div>
                Build Failed  with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4641/

              </div></li><li><div>
                Build Failed  with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2885/

              </div></li><li><div>
                please fix scala style issue
              </div></li><li><div>
                Build Success with Spark 2.3.4, Please check CI http://121.244.95.60:12545/job/ApacheCarbonPRBuilder2.3/4657/

              </div></li><li><div>
                Build Success with Spark 2.4.5, Please check CI http://121.244.95.60:12545/job/ApacheCarbon_PR_Builder_2.4.5/2901/

              </div></li><li><div>
                LGTM
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div>
                please do a select query and compare orc and carbon table results 
              </div></li><li><div>
                after line 1011, add a check that if data type is array or struct or map and the data is null, return null to avoid changing many lines.
              </div></li><li><div>
                please handle and verify 4 scenarios by comparing with ORC.
a) local sort insert with complex type null value data
b) global sort insert with complex type null value data
c) same point a) with `carbon.enable.bad.record.handling.for.insert `as `true`
d) same point b) with `carbon.enable.bad.record.handling.for.insert` as `true`
              </div></li><li><div>
                Done
              </div></li><li><div>
                Done
              </div></li><li><div>
                Done
              </div></li><li><div>
                check with  objectDataType.isComplexType
              </div></li><li><div>
                DataType is a spark class here. It doesn't have isComplexType method.
              </div></li><li><div>
                ok
              </div></li></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>