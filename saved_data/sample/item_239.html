<!DOCTYPE html><html><div class="item-title">
        Item 239
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 dump period must be greater than or equals 10 milliseconds
              </div></li><li><div>
                 check data
              </div></li><li><div>
                 create task
              </div></li><li><div>
                 basic check
              </div></li><li><div>
                *
     * create new profile task
     * @param serviceId monitor service id
     * @param endpointName monitor endpoint name
     * @param monitorStartTime create fix start time task when it's bigger 0
     * @param monitorDuration monitor task duration(minute)
     * @param minDurationThreshold min duration threshold
     * @param dumpPeriod dump period
     * @return task create result
     
              </div></li><li><div>
                 calculate task execute range
              </div></li><li><div>
                 check limit
 The duration of the monitoring task cannot be greater than 15 minutes
              </div></li><li><div>
                 if any task time bucket in this range, means already have task, because time bucket is base on task end time
              </div></li><li><div>
                 Each service can monitor up to 1 endpoints during the execution of tasks
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * profile task database bean, use none stream
 *
 * @author MrPro
 
              </div></li><li><div>
                 if null or empty means the task create success, otherwise get create error reason
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                 get data id when create success
              </div></li><li><div>
                *
 * create profile task result
 *
 * @author MrPro
 
              </div></li><li><div>
                 add service name
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
     * search profile task list
     * @param serviceId monitor service
     * @param endpointName endpoint name to monitored
     * @return
     
              </div></li><li><div>
                *
 * handle profile task queries
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                *
     * search task list in appoint time bucket
     * @param serviceId monitor service id, maybe null
     * @param endpointName endpoint name, maybe empty
     * @param startTimeBucket time bucket bigger than or equals, nullable
     * @param endTimeBucket time bucket small than or equals, nullable
     * @param limit limit count, if null means query all
     * @return
     
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * process all profile task query
 *
 * @author MrPro
 
              </div></li><li><div>
                *
 * profile mutation GraphQL resolver
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * profile query GraphQL resolver
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * Profile task create need data
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
     * parse profile task data
     * @param data
     * @return
     
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                 set the system properties that can be used in test codes 
              </div></li><li><div>
                
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  
              </div></li><li><div>
                 substitute application.yml to be capable of cluster mode
              </div></li><li><div>
                !/usr/bin/env bash
 Licensed to the SkyAPM under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
              </div></li><li><div>
                !/usr/bin/env bash
 Licensed to the SkyAPM under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
              </div></li><li><div>
                 verify get task list
              </div></li><li><div>
                 create profile task
              </div></li><li><div>
                *
     * verify create profile task
     * @param minutesAgo
     * @throws Exception
     
              </div></li><li><div>
                        final String swWebappPort = System.getProperty("sw.webapp.port", "32783");
              </div></li><li><div>
                 verify create task
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author Mrpro
 
              </div></li><li><div>
                 verify basic info
              </div></li><li><div>
                 set the system properties that can be used in test codes 
              </div></li><li><div>
                
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  
              </div></li><li><div>
                !/usr/bin/env bash
 Licensed to the SkyAPM under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
              </div></li><li><div>
                 verify get task list
              </div></li><li><div>
                 create profile task
              </div></li><li><div>
                *
     * verify create profile task
     * @param minutesAgo
     * @throws Exception
     
              </div></li><li><div>
                        final String swWebappPort = System.getProperty("sw.webapp.port", "32783");
              </div></li><li><div>
                 verify create task
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author Mrpro
 
              </div></li><li><div>
                 verify basic info
              </div></li><li><div>
                 set the system properties that can be used in test codes 
              </div></li><li><div>
                
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  
              </div></li><li><div>
                 Download MySQL connector.
              </div></li><li><div>
                 Modify application.yml to set MySQL as storage provider.
              </div></li><li><div>
                !/usr/bin/env bash
 Licensed to the SkyAPM under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
              </div></li><li><div>
                !/usr/bin/env bash
 Licensed to the SkyAPM under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
              </div></li><li><div>
                 verify get task list
              </div></li><li><div>
                 create profile task
              </div></li><li><div>
                *
     * verify create profile task
     * @param minutesAgo
     * @throws Exception
     
              </div></li><li><div>
                        final String swWebappPort = System.getProperty("sw.webapp.port", "32783");
              </div></li><li><div>
                 verify create task
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author Mrpro
 
              </div></li><li><div>
                 verify basic info
              </div></li><li><div>
                
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * Profile client, use profile.graphqls, base on {@link SimpleQueryClient}
 *
 * @author MrPro
 
              </div></li><li><div>
                *
 * e2e profile, create profile task entity
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * e2e profile, create profile task result entity
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * wrap profile task create result, for profileTaskCreation.gql
 *
 * @author MrPro
 
              </div></li><li><div>
                *
 * Profile task bean for e2e GraphQL test result
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                *
 * profile query data
 *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 
              </div></li><li><div>
                *
 * @author MrPro
 
              </div></li><li><div>
                
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  
              </div></li><li><div>
                 add profile service implementations
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Provide thread monitor create task feature (#4145)
                </div><div><b>message:</b> Provide thread monitor create task feature (#4145)

* provide thread monitor task service to create

* provide thread monitor task GraphQL implements

* 1. change thread monitor field names
2. fix `getThreadMonitorTaskList` query time bucket error

* provide config stream processor

* update submodule `query-protocol`

* resolve e2e-mysql error

* remove useless storage interface method.

* rename `ThreadMonitorTask` to `ProfileTask`

* change e2e-profile to the top level

* fix profile test analyze error

* remove StringUtil#isBlank.

* 1. remove create profile task duration unit
2. remove GraphQL getTask list duration field
3. add `profileTaskQueryMaxSize` in `storage` -&gt; `elasticsearch(7)` configuration, default get 200 profile task

* provide e2e different storage tests

* 1. fix rat check
2. remove DurationUtils.java#toSecond
3. remove ProfileTaskQueryEs7DAO

* fix e2e code format error

* provide es6 and es7 storage e2e tests

* change e2e profile es module artifactId

Co-authored-by: kezhenxu94 &lt;kezhenxu94@163.com&gt;

                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>github_issues:</b> <ol><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li><li><div><div><b>title:</b> [FEATURE] Performance profile at method level in production environment
                </div><div><b>body:</b> Please answer these questions before submitting your issue.

- Why do you submit this issue?
- [ ] Question or discussion
- [ ] Bug
- [ ] Requirement
- [x] Feature or performance improvement

___
I wrote about the thread monitoring proposal in the mail list.
The doc is now complete to introduce this feature: https://docs.google.com/document/d/1rxMf1WN3PaFaZp7r8JmtwfdkmjLTcFW_ETAZv5FIU-s/edit


Because the amount of development is relatively large, I will divide the following steps into the development work:

Step 1: Save thread monitoring tasks to storage and corresponding graphQL
1. Define thread monitoring DAO, graphql, mainly including adding task interface
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage

Step 2: Downstream task to sniffer
1. Define the cache interface (CacheDAO), which can be used to query the cached data. Implementing JDBC storage
2. Complete queries in Elasticsearch and Elasticsearch 7
3. Create a CacheService and start a scheduled task to write data to the cache
4. Define the protocol file (query command) for OAP to communicate with the sniffer, and implement the gRPC server handler

Step 3: sniffer executes commands to monitor traces
1. Start timing tasks for command reading, and define the gRPC protocol (for snapshot upload)
2. Monitor trace generation and report data
3. Write Testcase (JUnit) to ensure that snapshots can be created and reported after receiving the command

Step 4: OAP saves thread snapshot
1. Define the receive module, define the interface for adding snapshots in the DAO, and receive the data save request passed by the sniffer
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Write Testcase, save operation based on received data

Step 5: Query data and display graphql
1. Define query interface and graphql for querying task list, related trace list, and snapshot
2. Implementing JDBC storage
3. Implementing Elasticsearch storage
4. Implementing Elastic-search 7 storage
5. Complete test code (e2e-cluster-test-runner)
                </div></div></li></ol></div><div><b>github_issues_comments:</b> <ol><li><div>
                Branch `profile` will be created after 6.6.0 release. PRs of all steps should send to there, after all features tested and e2e test setup, I will submit a `un-squash` merge PR to the master.

This is a very important feature, @apache/skywalking-committers, welcome and look forward all of you could take part in and help on review. Design doc should be ready.
              </div></li><li><div>
                To all in this thread

@mrproliu has made big progress in this feature. We miss the last step, then we could deliver the test env to UI team, @Fine0830.  
I have submitted the CFP about this for SRECon and JavaZone, I hope I could at least get one passed.
              </div></li><li><div>
                &gt; To all in this thread
&gt; 
&gt; @mrproliu has made big progress in this feature. We miss the last step, then we could deliver the test env to UI team, @Fine0830.
&gt; I have submitted the CFP about this for SRECon and JavaZone, I hope I could at least get one passed.

hmm...I don't understand what the test env is and what we need to do in UI.
              </div></li><li><div>
                &gt; hmm...I don't understand what the test env is and what we need to do in UI.

Test env is the one(by using docker), we will give you to set up locally, then you could easily query .

UI design is included in the Google doc, here are the links
1. Main page, https://bwd5l7.axshare.com/#id=8sgf47&amp;p=thread-monitor-page&amp;g=1
1. Add task page, https://bwd5l7.axshare.com/#id=61ddhs&amp;p=add-task-modal&amp;g=1

@Fine0830 The UI design is just a proposal and matched the proposal, for details, after you read, we could talk more.
              </div></li><li><div>
                All backend related PRs have been merged, and e2e tests passed. @mrproliu Next step, let's provide a local test image with data to the UI team(@Fine0830 ). Notice, the TTL should be set as long as possible to avoid the profile data being deleted.
              </div></li><li><div>
                The data is ready for the UI team(@Fine0830 ) to access.
- By running this command, you can start the OAP server locally, which already contains the data content:
`docker run -d -p 12800:12800 -p 9090:9090 mliu111477/profile-graphql:0.0.5`

- Data query related GraphQL has generated query related statements through postman(exclude create). [You can refer to this file](https://www.getpostman.com/collections/8f84a74da2bb9bb6f118). After importing, you can use.

              </div></li><li><div>
                @Fine0830 Above inform should be ready for your local run and test. UI draft is there if you have any issue, please ping me, we could discuss, especially about the UI design.

￼
              </div></li><li><div>
                I will review the UI design draft again tomorrow, and try to finalize with @mrproliu 
              </div></li><li><div>
                The UI design has been finished.
- Add task model:
![add-task-modal](https://user-images.githubusercontent.com/3417650/74311813-40cacb80-4dab-11ea-9d20-9568546cdc89.png)

- Profile main page:
![thread-monitor-page](https://user-images.githubusercontent.com/3417650/74311842-53450500-4dab-11ea-9c1e-ff21c26736f5.png)

              </div></li><li><div>
                @Fine0830 This is a backend performance benchmark for analysis button action.

https://cwiki.apache.org/confluence/display/SKYWALKING/Performance+profile+analyze+benchmark

Give the tips `The analysis usually takes 2-10s, please wait.`  when user confirms to do analysis action at the UI.
              </div></li><li><div>
                Hi, @Fine0830. I missed the profiled segment query in GraphQL, now has added. 
I create the new docker images, please running this command to run it.
`docker run -d -p 12800:12800 -p 9090:9090 mliu111477/profile-graphql:0.0.8`

The postman has also added this query:
https://www.getpostman.com/collections/8f84a74da2bb9bb6f118
              </div></li></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> documentation
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li><li><div><div><b>title:</b> Provide thread monitor create task feature
                </div><div><b>body:</b> Please answer these questions before submitting pull request

- Why submit this pull request?
- [ ] Bug fix
- [x] New feature provided
- [ ] Improve performance

- Related issues
#4104 
___
### New feature or improvement
- Follow step one, create and query thread monitor task according to graphql
                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                # [Codecov](https://codecov.io/gh/apache/skywalking/pull/4145?src=pr&amp;el=h1) Report
&gt; Merging [#4145](https://codecov.io/gh/apache/skywalking/pull/4145?src=pr&amp;el=desc) into [master](https://codecov.io/gh/apache/skywalking/commit/f64f3c14332b2c3808d86167d4b03ff096359aac?src=pr&amp;el=desc) will **decrease** coverage by `0.17%`.
&gt; The diff coverage is `0%`.

[![Impacted file tree graph](https://codecov.io/gh/apache/skywalking/pull/4145/graphs/tree.svg?width=650&amp;token=qrILxY5yA8&amp;height=150&amp;src=pr)](https://codecov.io/gh/apache/skywalking/pull/4145?src=pr&amp;el=tree)

```diff
@@            Coverage Diff             @@
##           master    #4145      +/-   ##
==========================================
- Coverage   27.03%   26.85%   -0.18%     
==========================================
  Files        1147     1156       +9     
  Lines       25141    25309     +168     
  Branches     3641     3674      +33     
==========================================
  Hits         6797     6797              
- Misses      17739    17907     +168     
  Partials      605      605
```


| [Impacted Files](https://codecov.io/gh/apache/skywalking/pull/4145?src=pr&amp;el=tree) | Coverage Δ | |
|---|---|---|
| [...kywalking/oap/server/core/query/DurationUtils.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItY29yZS9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvc2t5d2Fsa2luZy9vYXAvc2VydmVyL2NvcmUvcXVlcnkvRHVyYXRpb25VdGlscy5qYXZh) | `0% &lt;ø&gt; (ø)` | :arrow_up: |
| [...ing/oap/server/core/source/DefaultScopeDefine.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItY29yZS9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvc2t5d2Fsa2luZy9vYXAvc2VydmVyL2NvcmUvc291cmNlL0RlZmF1bHRTY29wZURlZmluZS5qYXZh) | `0% &lt;ø&gt; (ø)` | :arrow_up: |
| [...walking/oap/server/core/storage/StorageModule.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItY29yZS9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvc2t5d2Fsa2luZy9vYXAvc2VydmVyL2NvcmUvc3RvcmFnZS9TdG9yYWdlTW9kdWxlLmphdmE=) | `0% &lt;ø&gt; (ø)` | :arrow_up: |
| [...alking/oap/query/graphql/GraphQLQueryProvider.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItcXVlcnktcGx1Z2luL3F1ZXJ5LWdyYXBocWwtcGx1Z2luL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9za3l3YWxraW5nL29hcC9xdWVyeS9ncmFwaHFsL0dyYXBoUUxRdWVyeVByb3ZpZGVyLmphdmE=) | `0% &lt;0%&gt; (ø)` | :arrow_up: |
| [...lking/oap/query/graphql/resolver/ProfileQuery.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItcXVlcnktcGx1Z2luL3F1ZXJ5LWdyYXBocWwtcGx1Z2luL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9za3l3YWxraW5nL29hcC9xdWVyeS9ncmFwaHFsL3Jlc29sdmVyL1Byb2ZpbGVRdWVyeS5qYXZh) | `0% &lt;0%&gt; (ø)` | |
| [...ng/oap/query/graphql/resolver/ProfileMutation.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItcXVlcnktcGx1Z2luL3F1ZXJ5LWdyYXBocWwtcGx1Z2luL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9za3l3YWxraW5nL29hcC9xdWVyeS9ncmFwaHFsL3Jlc29sdmVyL1Byb2ZpbGVNdXRhdGlvbi5qYXZh) | `0% &lt;0%&gt; (ø)` | |
| [...oap/server/core/query/ProfileTaskQueryService.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItY29yZS9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvc2t5d2Fsa2luZy9vYXAvc2VydmVyL2NvcmUvcXVlcnkvUHJvZmlsZVRhc2tRdWVyeVNlcnZpY2UuamF2YQ==) | `0% &lt;0%&gt; (ø)` | |
| [...skywalking/oap/server/core/CoreModuleProvider.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItY29yZS9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvc2t5d2Fsa2luZy9vYXAvc2VydmVyL2NvcmUvQ29yZU1vZHVsZVByb3ZpZGVyLmphdmE=) | `0% &lt;0%&gt; (ø)` | :arrow_up: |
| [...rage/plugin/jdbc/h2/dao/H2ProfileTaskQueryDAO.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItc3RvcmFnZS1wbHVnaW4vc3RvcmFnZS1qZGJjLWhpa2FyaWNwLXBsdWdpbi9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvc2t5d2Fsa2luZy9vYXAvc2VydmVyL3N0b3JhZ2UvcGx1Z2luL2pkYmMvaDIvZGFvL0gyUHJvZmlsZVRhc2tRdWVyeURBTy5qYXZh) | `0% &lt;0%&gt; (ø)` | |
| [...king/oap/server/core/query/entity/ProfileTask.java](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree#diff-b2FwLXNlcnZlci9zZXJ2ZXItY29yZS9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvc2t5d2Fsa2luZy9vYXAvc2VydmVyL2NvcmUvcXVlcnkvZW50aXR5L1Byb2ZpbGVUYXNrLmphdmE=) | `0% &lt;0%&gt; (ø)` | |
| ... and [19 more](https://codecov.io/gh/apache/skywalking/pull/4145/diff?src=pr&amp;el=tree-more) | |

------

[Continue to review full report at Codecov](https://codecov.io/gh/apache/skywalking/pull/4145?src=pr&amp;el=continue).
&gt; **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)
&gt; `Δ = absolute &lt;relative&gt; (impact)`, `ø = not affected`, `? = missing data`
&gt; Powered by [Codecov](https://codecov.io/gh/apache/skywalking/pull/4145?src=pr&amp;el=footer). Last update [f64f3c1...0c7617a](https://codecov.io/gh/apache/skywalking/pull/4145?src=pr&amp;el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).

              </div></li><li><div>
                This is for step 1?
              </div></li><li><div>
                The e2e tests are keeping failure, we need to figure out why first.
              </div></li><li><div>
                &gt; This is for step 1?

Yes, this is for task creation and query.
              </div></li><li><div>
                I have a suggestion for `e2e-profile `. I think we should add `ThreadMonitorTask` to`e2e-cluster e2e-mysql e2e-single-service` instead of adding a new e2e.
              </div></li><li><div><div><b>body:</b> &gt; I have a suggestion for `e2e-profile `. I think we should add `ThreadMonitorTask` to`e2e-cluster e2e-mysql e2e-single-service` instead of adding a new e2e.

At present, it's only graphql in OAP to add query test, but the interaction in sniffer will be integrated later. I think it's better to use a new E2E
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                @kezhenxu94 I can't find anything related to the e2e failure in the log, even no error logs from OAP. Could you check why? Or do we miss some logs?
              </div></li><li><div>
                &gt; @kezhenxu94 I can't find anything related to the e2e failure in the log, even no error logs from OAP. Could you check why? Or do we miss some logs?

The failures of the E2E tests are due to the missing update of the submodule (protocol), thus missing the newly-added file `query-protocol/profile.graphqls`, @mrproliu please update the submodule in this PR
              </div></li><li><div>
                The failure should be discoverable and reproducible in your local machine, if you make sure that your codes are the same with the remote repo @mrproliu 

              </div></li><li><div>
                @kezhenxu94 He sent me this directly, that is why I asked.
![image](https://user-images.githubusercontent.com/5441976/71555072-71a4aa80-2a62-11ea-9421-91aa47fb1b89.png)

              </div></li><li><div>
                &gt; The failure should be discoverable and reproducible in your local machine, if you make sure that your codes are the same with the remote repo @mrproliu

OK, I have submitted it. 
              </div></li><li><div>
                Oh, you didn't update the submodule, strange, why log can't show this?
              </div></li><li><div>
                &gt; Oh, you didn't update the submodule, strange, why log can't show this?

The failure is due to timeout and the e2e-container is killed by the plugin, so we have no chance to `cat` the logs
              </div></li><li><div>
                &gt; The failure is due to timeout and the e2e-container is killed by the plugin, so we have no chance to cat the logs

So, if we face the OAP bootstrap issue, then this error shows up without the logs. Could I make this as a conclusion of a possible case? Could we make this a part of e2e test faq?
              </div></li><li><div>
                &gt; &gt; I have a suggestion for `e2e-profile `. I think we should add `ThreadMonitorTask` to`e2e-cluster e2e-mysql e2e-single-service` instead of adding a new e2e.
&gt; 
&gt; At present, it's only graphql in OAP to add query test, but the interaction in sniffer will be integrated later. I think it's better to use a new E2E

But `es` and `mysql` is not covered,  need to be added? @wu-sheng @kezhenxu94 
              </div></li><li><div>
                &gt; So, if we face the OAP bootstrap issue, then this error shows up without the logs. Could I make this as a conclusion of a possible case? 

Yes I agree.

Because bootstrap failure should be always stable to reproduce, and should be discovered when establishing a new E2E case, my assumption is that the contributor should verify locally, and guaranteed the codes are all pushed to remote repo, unlike this case :)

&gt; Could we make this a part of e2e test faq?

Sure, or maybe as an important note to contribute new E2E cases
              </div></li><li><div>
                &gt; Sure, or maybe as an important note to contribute new E2E cases

Could you submit a separated PR about this?
              </div></li><li><div><div><b>body:</b> Before the further change, please make sure we have consistent name. Let's remove thread monitor in all names, only keep profile in name, including Graphql protocol. They are used randomly.
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div><div><b>body:</b> This should be top level e2e test, like `Compatibilities` test.
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                Why do we need both methods? 
              </div></li><li><div><div><b>body:</b> They have very similar parameter, but different logic? It is hard to understand.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                they are using different logic.
`getTaskListSearchOnStartTime`: It will use on creating a new task to check limit, Each service can monitor up to 1 endpoints during the execution of tasks. search time range on task start time.
`getTaskList`: It will use on the UI level GraphQL searching. search time range on time bucket.
At present, I don't have any good way to optimize these two methods.
              </div></li><li><div>
                Ok. I will change it after the e2e task failed issue resolved.
              </div></li><li><div><div><b>body:</b> These two names show no difference. The storage implementor must be confused.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                The point is storage should consider data query only. You could query the list, then check. I still don’t see the difference. You are talking using in different places. But this is wrong as two separated methods.

You should provide a method a query existing task list based on given conditions, that is all. This method is not matching the UI query or create task. It is a storage interface.
              </div></li><li><div><div><b>body:</b> There is already `StringUtil#isEmpty`. This is duplicated.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Reading this makes me feel, we should set the duration in minute level only, and remove the step in the protocol. @kezhenxu94 @arugal  What do you think?
              </div></li><li><div>
                I think we need a `sourceBuilder.size(limit);` here, right? @kezhenxu94 Otherwise, ES query will only get top 10? 
              </div></li><li><div>
                Yes, we get 10 docuemnts only by default. 
              </div></li><li><div>
                Profile should be tested in every storage. H2, MySQL, es6, es7.
              </div></li><li><div><div><b>body:</b> &gt; Reading this makes me feel, we should set the duration in minute level only, and remove the step in the protocol. @kezhenxu94 @arugal What do you think?

Make sense to me, but `minute` level seems too large in time span, what about making it `second` level?
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                &gt; There is already `StringUtil#isEmpty`. This is duplicated.

They're different (trivial though) IMO, `StringUtil.isEmpty("  \t") == false` while `StringUtil.isBlank("  \t") == true`
              </div></li><li><div><div><b>body:</b> That's true. I think to get 10 doc it's enough. Should I add a size limit?
                </div><div><b>label:</b> documentation
                </div></div></li><li><div>
                I highly doubt this is the purpose of creating this API..
              </div></li><li><div>
                Why 10 is enough? I don't remember we limit the task amount.
              </div></li><li><div>
                Maybe I should do String#trim on GrapthQL resolver?
              </div></li><li><div>
                Why do you need a trim? Who will send an empty string?
              </div></li><li><div>
                According to https://github.com/apache/skywalking-query-protocol/blob/master/profile.graphqls#L25-L26, this duration is for the task, I think minute makes more sense.
              </div></li><li><div>
                This threshold for segment(nothing related to span) is minDurationThreshold, refer to https://github.com/apache/skywalking-query-protocol/blob/master/profile.graphqls#L30
              </div></li><li><div>
                Oh, I just think is using on the task creation limit check, forget it will use on GraphQL. Should I add a limit and from param in the GraphQL?
              </div></li><li><div>
                You could have a limit in DAO interface level, but for UI, if we want to set the limit, we should set paging in the GraphQL parameter 
              </div></li><li><div>
                Because if we set a limit in UI without paging, people would not see the full list forever. I still think the full list is enough for UI as the profiling task should not a long list.
              </div></li><li><div>
                One more thing, as we have TTL for profile task, we could remove the duration here, https://github.com/apache/skywalking-query-protocol/blob/master/profile.graphqls#L68. We should always show the full list. Any suggestion? @arugal @kezhenxu94 
              </div></li><li><div>
                Do we need to support order by `time`?
              </div></li><li><div>
                Yes, should order by start time `DESC`
              </div></li><li><div>
                &gt; Why do you need a trim? Who will send an empty string?

@wu-sheng As long as the string is typed by the users, it's totally possible that it will include blank characters, or even unprintable/invisible characters, we're suffering from this because the users copy-and-pastes from else where (especially Windows users, `\r` is painful), another solution is to trim and validate the input  in the frontend, but we may have other user interface, CLI I mean
              </div></li><li><div>
                If that is the concern, `trim` the data in the GraphQL service level, this kind of blank issue clearly is related to humans, not to codes. 
              </div></li><li><div><div><b>body:</b> I think this method is not necessary as the duration unit has been removed from the protocol
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Does this DAO have any different with ES6's?  
              </div></li><li><div>
                They are the same. I deleted, use `ProfileTaskQueryEsDAO` on the es7 module provides.
              </div></li></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>