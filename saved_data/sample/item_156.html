<!DOCTYPE html><html><div class="item-title">
        Item 156
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> commit 468ca72f2f025906cbf114f2ad62ea5e4361c5fb
                </div><div><b>message:</b> commit 468ca72f2f025906cbf114f2ad62ea5e4361c5fb
Author: Devaraj Das &lt;ddas@yahoo-inc.com&gt;
Date:   Mon Jun 28 12:05:46 2010 -0700

    MAPREDUCE:1900 from https://issues.apache.org/jira/secure/attachment/12448230/mapred-fs-close.patch
    
    +++ b/YAHOO-CHANGES.txt
    +    MAPREDUCE-1900. Makes JobTracker/TaskTracker close filesystems, created
    +    on behalf of users, when they are no longer needed. (ddas)
    +


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/branch-0.20-security-patches@1077564 13f79535-47bb-0310-9956-ffa450edef68

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div><div><b>label:</b> test
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li><li><div><div><b>summary:</b> MapReduce daemons should close FileSystems that are not needed anymore
                </div><div><b>description:</b> Related to HADOOP-6843, this jira is to make MapReduce behave better with respect to closing FileSystems when they are not needed anymore.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                Patch for Y20S. The patch basically closes the filesystems, created during the job execution, at the end of the job.
              </div></li><li><div>
                //sigh. Had we implemented ref-counted fs cache (HADOOP-4665) and call close() every time a local context finishes using an fs instance, we are unlikely hit this problem.
              </div></li><li><div>
                I mean to say HADOOP-4655 instead of HADOOP-4665.
              </div></li><li><div>
                Missed one case. This patch fixes it.
              </div></li><li><div>
                a port for trunk.
              </div></li><li><div>
                Here is the test-patch result. Also ran ant test and test-contrib. TestSimulatorDeterministicReplay failed, but it also fails without the patch. Other tests are passing.

     [exec] -1 overall.
     [exec]
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec]
     [exec]     -1 tests included.  The patch doesn't appear to include any new or modified tests.
     [exec]                         Please justify why no new tests are needed for this patch.
     [exec]                         Also please list what manual steps were performed to verify this patch.
     [exec]
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec]
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec]
     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.
     [exec]
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.



              </div></li><li><div><div><b>body:</b> +1 patch looks good.
"Please justify why no new tests are needed for this patch.
Also please list what manual steps were performed to verify this patch."
                </div><div><b>label:</b> test
                </div></div></li><li><div>
                The patch was tested manually on Yahoo clusters. I just committed this. Thanks, Kan for the trunk patch.
              </div></li><li><div>
                This patch breaks hadoop for me.  Can we reconsider it?

It is not safe to call

      FileSystem.closeAllForUGI(UserGroupInformation.getCurrentUser());

in order to close one filesystem connection.

See MAPREDUCE-2060

It causes the parent JobTracker's FileSystem object to be closed as well, making it impossible (for me) to successfully submit a job.
              </div></li><li><div>
                Integrated in Hadoop-Mapreduce-trunk-Commit #523 (See [https://hudson.apache.org/hudson/job/Hadoop-Mapreduce-trunk-Commit/523/])
    
              </div></li></ol></div></div></html>