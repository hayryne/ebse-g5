<!DOCTYPE html><html><div class="item-title">
        Item 246
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Fix compilation error fix #3365 (#3366)
                </div><div><b>message:</b> Fix compilation error fix #3365 (#3366)


                </div></div></li></ol></div><div><b>github_issues:</b> <ol><li><div><div><b>title:</b> Fail UT about DubboMonitorTest#testCount
                </div><div><b>body:</b> - [ ] I have searched the [issues](https://github.com/apache/incubator-dubbo/issues) of this repository and believe that this is not a duplicate.
- [ ] I have checked the [FAQ](https://github.com/apache/incubator-dubbo/blob/master/FAQ.md) of this repository and believe that this is not a duplicate.

### Environment

* Dubbo version: 2.7.0
* Operating System version: xxx
* Java version: 

### Steps to reproduce this issue

I merged the code about #3327, but still UT failed.

Travis CI failed with the following log
https://api.travis-ci.org/v3/job/484984836/log.txt

Pls. provide [GitHub address] to reproduce this issue.

### Expected Result

CI pass

### Actual Result

CI fail


```bash
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.105 s - in org.apache.dubbo.monitor.dubbo.[1mStatisticsTest[m
[[1;34mINFO[m] Running org.apache.dubbo.monitor.dubbo.[1mDubboMonitorFactoryTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.919 s - in org.apache.dubbo.monitor.dubbo.[1mDubboMonitorFactoryTest[m
[[1;34mINFO[m] Running org.apache.dubbo.monitor.dubbo.[1mDubboMonitorTest[m
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m5[m, [1;31mFailures: [0;1;31m1[m, Errors: 0, Skipped: 0, Time elapsed: 1.028 s[1;31m &lt;&lt;&lt; FAILURE![m - in org.apache.dubbo.monitor.dubbo.[1mDubboMonitorTest[m
[[1;31mERROR[m] testCount  Time elapsed: 0.043 s  &lt;&lt;&lt; FAILURE!
org.opentest4j.AssertionFailedError: expected: &lt;1&gt; but was: &lt;0&gt;
	at org.apache.dubbo.monitor.dubbo.DubboMonitorTest.testCount(DubboMonitorTest.java:117)
```

If there is an exception, please attach the exception trace:

```
Just put your stack trace here!
```

                </div></div></li><li><div><div><b>title:</b> Fail UT about DubboMonitorTest#testCount
                </div><div><b>body:</b> - [ ] I have searched the [issues](https://github.com/apache/incubator-dubbo/issues) of this repository and believe that this is not a duplicate.
- [ ] I have checked the [FAQ](https://github.com/apache/incubator-dubbo/blob/master/FAQ.md) of this repository and believe that this is not a duplicate.

### Environment

* Dubbo version: 2.7.0
* Operating System version: xxx
* Java version: 

### Steps to reproduce this issue

I merged the code about #3327, but still UT failed.

Travis CI failed with the following log
https://api.travis-ci.org/v3/job/484984836/log.txt

Pls. provide [GitHub address] to reproduce this issue.

### Expected Result

CI pass

### Actual Result

CI fail


```bash
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.105 s - in org.apache.dubbo.monitor.dubbo.[1mStatisticsTest[m
[[1;34mINFO[m] Running org.apache.dubbo.monitor.dubbo.[1mDubboMonitorFactoryTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.919 s - in org.apache.dubbo.monitor.dubbo.[1mDubboMonitorFactoryTest[m
[[1;34mINFO[m] Running org.apache.dubbo.monitor.dubbo.[1mDubboMonitorTest[m
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m5[m, [1;31mFailures: [0;1;31m1[m, Errors: 0, Skipped: 0, Time elapsed: 1.028 s[1;31m &lt;&lt;&lt; FAILURE![m - in org.apache.dubbo.monitor.dubbo.[1mDubboMonitorTest[m
[[1;31mERROR[m] testCount  Time elapsed: 0.043 s  &lt;&lt;&lt; FAILURE!
org.opentest4j.AssertionFailedError: expected: &lt;1&gt; but was: &lt;0&gt;
	at org.apache.dubbo.monitor.dubbo.DubboMonitorTest.testCount(DubboMonitorTest.java:117)
```

If there is an exception, please attach the exception trace:

```
Just put your stack trace here!
```

                </div></div></li><li><div><div><b>title:</b> Fail UT about DubboMonitorTest#testCount
                </div><div><b>body:</b> - [ ] I have searched the [issues](https://github.com/apache/incubator-dubbo/issues) of this repository and believe that this is not a duplicate.
- [ ] I have checked the [FAQ](https://github.com/apache/incubator-dubbo/blob/master/FAQ.md) of this repository and believe that this is not a duplicate.

### Environment

* Dubbo version: 2.7.0
* Operating System version: xxx
* Java version: 

### Steps to reproduce this issue

I merged the code about #3327, but still UT failed.

Travis CI failed with the following log
https://api.travis-ci.org/v3/job/484984836/log.txt

Pls. provide [GitHub address] to reproduce this issue.

### Expected Result

CI pass

### Actual Result

CI fail


```bash
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.105 s - in org.apache.dubbo.monitor.dubbo.[1mStatisticsTest[m
[[1;34mINFO[m] Running org.apache.dubbo.monitor.dubbo.[1mDubboMonitorFactoryTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.919 s - in org.apache.dubbo.monitor.dubbo.[1mDubboMonitorFactoryTest[m
[[1;34mINFO[m] Running org.apache.dubbo.monitor.dubbo.[1mDubboMonitorTest[m
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m5[m, [1;31mFailures: [0;1;31m1[m, Errors: 0, Skipped: 0, Time elapsed: 1.028 s[1;31m &lt;&lt;&lt; FAILURE![m - in org.apache.dubbo.monitor.dubbo.[1mDubboMonitorTest[m
[[1;31mERROR[m] testCount  Time elapsed: 0.043 s  &lt;&lt;&lt; FAILURE!
org.opentest4j.AssertionFailedError: expected: &lt;1&gt; but was: &lt;0&gt;
	at org.apache.dubbo.monitor.dubbo.DubboMonitorTest.testCount(DubboMonitorTest.java:117)
```

If there is an exception, please attach the exception trace:

```
Just put your stack trace here!
```

                </div></div></li></ol></div><div><b>github_issues_comments:</b> <ol><li><div>
                I am compiling errors when running this UT

`Error:(38, 46) java: Êâæ‰∏çÂà∞Á¨¶Âè∑
  Á¨¶Âè∑:   Á±ª ZookeeperTransporter
  ‰ΩçÁΩÆ: Á±ª org.apache.dubbo.metadata.store.test.JTestMetadataReport4Test`
`Error:(29, 13) java: Êâæ‰∏çÂà∞Á¨¶Âè∑
  Á¨¶Âè∑:   Á±ª ZookeeperTransporter
  ‰ΩçÁΩÆ: Á±ª org.apache.dubbo.metadata.store.test.JTestMetadataReportFactory4Test`
              </div></li></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> Fix random ut falling in DubboMonitorTest
                </div><div><b>body:</b> ## What is the purpose of the change

Fix random ut falling in DubboMonitorTest
Fix wrong parameter order of `assertEquals("expected", "actual")`

## Brief changelog

`DubboMonitor#send()` may not executed after ` monitor.collect(statistics);`
Then subsequent assertion may fail.
So manual trigger `send()` after `collect()` in `DubboMonitorTest#testCount()`.

## Verifying this change

UT should always pass on jdk11

Follow this checklist to help us incorporate your contribution quickly and easily:

- [x] Make sure there is a [GITHUB_issue](https://github.com/apache/incubator-dubbo/issues) field for the change (usually before you start working on it). Trivial changes like typos do not require a GITHUB issue. Your pull request should address just this issue, without pulling in other changes - one PR resolves one issue.
- [ ] Format the pull request title like `[Dubbo-XXX] Fix UnknownException when host config not exist #XXX`. Each commit in the pull request should have a meaningful subject line and body.
- [ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.
- [ ] Write necessary unit-test to verify your logic correction, more mock a little better when cross module dependency exist. If the new feature or significant change is committed, please remember to add integration-test in [test module](https://github.com/apache/incubator-dubbo/tree/master/dubbo-test).
- [ ] Run `mvn clean install -DskipTests=false` &amp; `mvn clean test-compile failsafe:integration-test` to make sure unit-test and integration-test pass.
- [ ] If this contribution is large, please follow the [Software Donation Guide](https://github.com/apache/incubator-dubbo/wiki/Software-donation-guide).

                </div></div></li><li><div><div><b>title:</b> Fix random ut falling in DubboMonitorTest
                </div><div><b>body:</b> ## What is the purpose of the change

Fix random ut falling in DubboMonitorTest
Fix wrong parameter order of `assertEquals("expected", "actual")`

## Brief changelog

`DubboMonitor#send()` may not executed after ` monitor.collect(statistics);`
Then subsequent assertion may fail.
So manual trigger `send()` after `collect()` in `DubboMonitorTest#testCount()`.

## Verifying this change

UT should always pass on jdk11

Follow this checklist to help us incorporate your contribution quickly and easily:

- [x] Make sure there is a [GITHUB_issue](https://github.com/apache/incubator-dubbo/issues) field for the change (usually before you start working on it). Trivial changes like typos do not require a GITHUB issue. Your pull request should address just this issue, without pulling in other changes - one PR resolves one issue.
- [ ] Format the pull request title like `[Dubbo-XXX] Fix UnknownException when host config not exist #XXX`. Each commit in the pull request should have a meaningful subject line and body.
- [ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.
- [ ] Write necessary unit-test to verify your logic correction, more mock a little better when cross module dependency exist. If the new feature or significant change is committed, please remember to add integration-test in [test module](https://github.com/apache/incubator-dubbo/tree/master/dubbo-test).
- [ ] Run `mvn clean install -DskipTests=false` &amp; `mvn clean test-compile failsafe:integration-test` to make sure unit-test and integration-test pass.
- [ ] If this contribution is large, please follow the [Software Donation Guide](https://github.com/apache/incubator-dubbo/wiki/Software-donation-guide).

                </div></div></li><li><div><div><b>title:</b> Fix random ut falling in DubboMonitorTest
                </div><div><b>body:</b> ## What is the purpose of the change

Fix random ut falling in DubboMonitorTest
Fix wrong parameter order of `assertEquals("expected", "actual")`

## Brief changelog

`DubboMonitor#send()` may not executed after ` monitor.collect(statistics);`
Then subsequent assertion may fail.
So manual trigger `send()` after `collect()` in `DubboMonitorTest#testCount()`.

## Verifying this change

UT should always pass on jdk11

Follow this checklist to help us incorporate your contribution quickly and easily:

- [x] Make sure there is a [GITHUB_issue](https://github.com/apache/incubator-dubbo/issues) field for the change (usually before you start working on it). Trivial changes like typos do not require a GITHUB issue. Your pull request should address just this issue, without pulling in other changes - one PR resolves one issue.
- [ ] Format the pull request title like `[Dubbo-XXX] Fix UnknownException when host config not exist #XXX`. Each commit in the pull request should have a meaningful subject line and body.
- [ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.
- [ ] Write necessary unit-test to verify your logic correction, more mock a little better when cross module dependency exist. If the new feature or significant change is committed, please remember to add integration-test in [test module](https://github.com/apache/incubator-dubbo/tree/master/dubbo-test).
- [ ] Run `mvn clean install -DskipTests=false` &amp; `mvn clean test-compile failsafe:integration-test` to make sure unit-test and integration-test pass.
- [ ] If this contribution is large, please follow the [Software Donation Guide](https://github.com/apache/incubator-dubbo/wiki/Software-donation-guide).

                </div></div></li><li><div><div><b>title:</b> Fix random ut falling in DubboMonitorTest
                </div><div><b>body:</b> ## What is the purpose of the change

Fix random ut falling in DubboMonitorTest
Fix wrong parameter order of `assertEquals("expected", "actual")`

## Brief changelog

`DubboMonitor#send()` may not executed after ` monitor.collect(statistics);`
Then subsequent assertion may fail.
So manual trigger `send()` after `collect()` in `DubboMonitorTest#testCount()`.

## Verifying this change

UT should always pass on jdk11

Follow this checklist to help us incorporate your contribution quickly and easily:

- [x] Make sure there is a [GITHUB_issue](https://github.com/apache/incubator-dubbo/issues) field for the change (usually before you start working on it). Trivial changes like typos do not require a GITHUB issue. Your pull request should address just this issue, without pulling in other changes - one PR resolves one issue.
- [ ] Format the pull request title like `[Dubbo-XXX] Fix UnknownException when host config not exist #XXX`. Each commit in the pull request should have a meaningful subject line and body.
- [ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.
- [ ] Write necessary unit-test to verify your logic correction, more mock a little better when cross module dependency exist. If the new feature or significant change is committed, please remember to add integration-test in [test module](https://github.com/apache/incubator-dubbo/tree/master/dubbo-test).
- [ ] Run `mvn clean install -DskipTests=false` &amp; `mvn clean test-compile failsafe:integration-test` to make sure unit-test and integration-test pass.
- [ ] If this contribution is large, please follow the [Software Donation Guide](https://github.com/apache/incubator-dubbo/wiki/Software-donation-guide).

                </div></div></li><li><div><div><b>title:</b> Fix random ut falling in DubboMonitorTest
                </div><div><b>body:</b> ## What is the purpose of the change

Fix random ut falling in DubboMonitorTest
Fix wrong parameter order of `assertEquals("expected", "actual")`

## Brief changelog

`DubboMonitor#send()` may not executed after ` monitor.collect(statistics);`
Then subsequent assertion may fail.
So manual trigger `send()` after `collect()` in `DubboMonitorTest#testCount()`.

## Verifying this change

UT should always pass on jdk11

Follow this checklist to help us incorporate your contribution quickly and easily:

- [x] Make sure there is a [GITHUB_issue](https://github.com/apache/incubator-dubbo/issues) field for the change (usually before you start working on it). Trivial changes like typos do not require a GITHUB issue. Your pull request should address just this issue, without pulling in other changes - one PR resolves one issue.
- [ ] Format the pull request title like `[Dubbo-XXX] Fix UnknownException when host config not exist #XXX`. Each commit in the pull request should have a meaningful subject line and body.
- [ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.
- [ ] Write necessary unit-test to verify your logic correction, more mock a little better when cross module dependency exist. If the new feature or significant change is committed, please remember to add integration-test in [test module](https://github.com/apache/incubator-dubbo/tree/master/dubbo-test).
- [ ] Run `mvn clean install -DskipTests=false` &amp; `mvn clean test-compile failsafe:integration-test` to make sure unit-test and integration-test pass.
- [ ] If this contribution is large, please follow the [Software Donation Guide](https://github.com/apache/incubator-dubbo/wiki/Software-donation-guide).

                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Fix random ut falling in DubboMonitorTest
                </div><div><b>body:</b> ## What is the purpose of the change

Fix random ut falling in DubboMonitorTest
Fix wrong parameter order of `assertEquals("expected", "actual")`

## Brief changelog

`DubboMonitor#send()` may not executed after ` monitor.collect(statistics);`
Then subsequent assertion may fail.
So manual trigger `send()` after `collect()` in `DubboMonitorTest#testCount()`.

## Verifying this change

UT should always pass on jdk11

Follow this checklist to help us incorporate your contribution quickly and easily:

- [x] Make sure there is a [GITHUB_issue](https://github.com/apache/incubator-dubbo/issues) field for the change (usually before you start working on it). Trivial changes like typos do not require a GITHUB issue. Your pull request should address just this issue, without pulling in other changes - one PR resolves one issue.
- [ ] Format the pull request title like `[Dubbo-XXX] Fix UnknownException when host config not exist #XXX`. Each commit in the pull request should have a meaningful subject line and body.
- [ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.
- [ ] Write necessary unit-test to verify your logic correction, more mock a little better when cross module dependency exist. If the new feature or significant change is committed, please remember to add integration-test in [test module](https://github.com/apache/incubator-dubbo/tree/master/dubbo-test).
- [ ] Run `mvn clean install -DskipTests=false` &amp; `mvn clean test-compile failsafe:integration-test` to make sure unit-test and integration-test pass.
- [ ] If this contribution is large, please follow the [Software Donation Guide](https://github.com/apache/incubator-dubbo/wiki/Software-donation-guide).

                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                LGTM
              </div></li><li><div>
                Hi, would you please also confirm whether a pull request is needed for 2.6.x branch?
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div>
                What is the role of swapping positions here?
              </div></li><li><div><div><b>body:</b> Expected value should be the first parameter of `asertEquals`.
for example, this is current error message which `expected` value and `actual` value was swapped:
```
[[1;31mERROR[m] testCount  Time elapsed: 0.075 s  &lt;&lt;&lt; FAILURE!
org.opentest4j.AssertionFailedError: expected: &lt;0&gt; but was: &lt;1&gt;
	at org.apache.dubbo.monitor.dubbo.DubboMonitorTest.testCount(DubboMonitorTest.java:116)
```
it should be:
"expected: &lt;1&gt; but was: &lt;0&gt;"
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>