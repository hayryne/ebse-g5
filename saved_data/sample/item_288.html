<!DOCTYPE html><html><div class="item-title">
        Item 288
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div><div><b>comment:</b>  Actual mod time is not computed because it's expensive and rarely needed.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                 dirInfo is a static definition of a directory.
              </div></li><li><div>
                 dir is an opened dir instance.
              </div></li><li><div>
                 skip
              </div></li><li><div>
                
 The 1-level down paths are needed since the
 remainder are covered by the http filesystems

              </div></li><li><div>
                
Based on the union fs function available at
https://github.com/shurcooL/httpfs/blob/master/union/union.go
(Licenced under MIT)

              </div></li><li><div>
                 Position within entries for Seek and Readdir.
              </div></li><li><div>
                
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

              </div></li><li><div>
                 Find the module dir..
              </div></li><li><div>
                
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

              </div></li><li><div>
                 Save the original directory the process started in.
              </div></li><li><div>
                 vfsgen۰Dir is an opened dir instance.
              </div></li><li><div>
                 assets statically implements the virtual filesystem provided to vfsgen.
              </div></li><li><div>
                 Code generated by vfsgen; DO NOT EDIT.
              </div></li><li><div>
                 Actual gr uncompressed position.
 Seek uncompressed position.
              </div></li><li><div>
                 vfsgen۰CompressedFile is an opened compressedFile instance.
              </div></li><li><div>
                 This should never happen because we generate only the above types.
              </div></li><li><div>
                 Rewind to beginning.
              </div></li><li><div>
                 vfsgen۰CompressedFileInfo is a static definition of a gzip compressed file.
              </div></li><li><div>
                 This should never happen because we generate the gzip bytes such that they are always valid.
              </div></li><li><div>
                 Position within entries for Seek and Readdir.
              </div></li><li><div>
                
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

              </div></li><li><div>
                 Fast-forward.
              </div></li><li><div>
                 vfsgen۰DirInfo is a static definition of a directory.
              </div></li><li><div>
                 directory needs the slash on the end
              </div></li><li><div>
                 need to get to at least the same directory as the required files
              </div></li><li><div>
                
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

              </div></li><li><div>
                
go:generate go run ../../cmd/util/vfs-gen deploy config

 ResourcesWithPrefix lists all file names that begins with the give path prefix
 If pathPrefix is a path of directories then be sure to end it with a '/'
              </div></li><li><div>
                
 Requires directory to find the files in

              </div></li><li><div>
                !/bin/bash
              </div></li><li><div>
                
 Destination file for the generated resources

              </div></li><li><div>
                
 Filter un-interesting files

              </div></li><li><div>
                
 Post-process the final resource file

              </div></li><li><div>
                
 Generate the assets

              </div></li><li><div>
                
go:generate go run ../../cmd/util/vfs-gen deploy config

 ResourcesWithPrefix lists all file names that begins with the give path prefix
 If pathPrefix is a path of directories then be sure to end it with a '/'
              </div></li><li><div>
                
 Requires directory to find the files in

              </div></li><li><div>
                !/bin/bash
              </div></li><li><div><div><b>comment:</b> 
 Use the triage directory for building the csv to avoid
 overwriting the CRDs and needlessly changing their format

                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                 Post-process source
              </div></li><li><div>
                 Remove the copy as no longer required
              </div></li><li><div><div><b>comment:</b>  cleanup working directory in $apidir
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                 Make a copy to serve as the base for post-processing
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Feature #1820: Refactor resources to make config / operator-sdk basis for CSV
                </div><div><b>message:</b> Feature #1820: Refactor resources to make config / operator-sdk basis for CSV

* deploy resources duplicated in config now removed

* multidir
 * Provides a vfs-gen virtual resource generator that generates from separate
   directories but doesn't reference those directories

* config/manifest/...clusterserviceversion.yaml
 * Adds in extra metadata

* deploy/olm-catalog/...
 * The creation of the CSV is retained for older OLM installations with
   bundle generation for newer ones.
 * Since operator-sdk is now used for csv generation, the metadata and
   naming has changed in minor ways:
   * camel-k-dev.package.yaml
   * renaming of deploy crd files

* pkg/base/root.go
 * Provides global var GoModDirectory that defines the location of the
   root module directory

* pkg/resources/...
 * Moves code out of deploy into resources since its independent of both
   deploy and config directories
 * Provides a ResourcesWithPrefix function for finding all resources with
   a specific prefix saving on duplicated code
 * go:generate annotation used for executing vfs-gen

* Makefile
 * go generate used for executing vfs-gen virtual resource generation
 * add_createdAt.sh adds in createdAt datetimes for CSV which is not
   generated by the operator-sdk

* script/build-olm.sh
 * Updates from operator-sdk generate command in older version to new
   command in 1.0+

* script/gen_crd.sh
 * Makes config the destination for crd generation
 * Renames the deploy/olm-catalog crd copies to match that created when
   running 	`make build-olm`

* script/gen_olm.sh
 * Migrates to new command for generating CSV using operator-sdk
 * Uses triage directory to avoid needless format changes to CRDs already
   generated by controller-gen

                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>github_issues:</b> <ol><li><div><div><b>title:</b> Refactor artifacts of deploy directory and continue alignment towards operator-sdk &amp; kustomize
                </div><div><b>body:</b> Following on from #1743 ....

* Refactor and remove any duplication between the `deploy` and `config` directories;
* The `config` directory should now become the source of truth for the artifacts, where applicable, retargetting the kamel CLI accordingly;
* Make clear in README that the bundle directory should be generated on an as-needed basis rather than being checked-in (the CSV manifest resources are checked-in);

***UPDATE: splitting below off to #1979***
* Start to offer camel-k as an install with kustomize rather than needing to download the `kamel cli`, allowing install with standard tools;
  - This will require consideration of different production setups, tailoring the `config` directory to support patches for different use-cases, eg. including addons, installing on different types of cluster;
  - Need to gauge any comparable loss of flexibility as compared to the kamel cli;
                </div></div></li><li><div><div><b>title:</b> Refactor artifacts of deploy directory and continue alignment towards operator-sdk &amp; kustomize
                </div><div><b>body:</b> Following on from #1743 ....

* Refactor and remove any duplication between the `deploy` and `config` directories;
* The `config` directory should now become the source of truth for the artifacts, where applicable, retargetting the kamel CLI accordingly;
* Make clear in README that the bundle directory should be generated on an as-needed basis rather than being checked-in (the CSV manifest resources are checked-in);

***UPDATE: splitting below off to #1979***
* Start to offer camel-k as an install with kustomize rather than needing to download the `kamel cli`, allowing install with standard tools;
  - This will require consideration of different production setups, tailoring the `config` directory to support patches for different use-cases, eg. including addons, installing on different types of cluster;
  - Need to gauge any comparable loss of flexibility as compared to the kamel cli;
                </div></div></li><li><div><div><b>title:</b> Refactor artifacts of deploy directory and continue alignment towards operator-sdk &amp; kustomize
                </div><div><b>body:</b> Following on from #1743 ....

* Refactor and remove any duplication between the `deploy` and `config` directories;
* The `config` directory should now become the source of truth for the artifacts, where applicable, retargetting the kamel CLI accordingly;
* Make clear in README that the bundle directory should be generated on an as-needed basis rather than being checked-in (the CSV manifest resources are checked-in);

***UPDATE: splitting below off to #1979***
* Start to offer camel-k as an install with kustomize rather than needing to download the `kamel cli`, allowing install with standard tools;
  - This will require consideration of different production setups, tailoring the `config` directory to support patches for different use-cases, eg. including addons, installing on different types of cluster;
  - Need to gauge any comparable loss of flexibility as compared to the kamel cli;
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>title:</b> Refactor artifacts of deploy directory and continue alignment towards operator-sdk &amp; kustomize
                </div><div><b>body:</b> Following on from #1743 ....

* Refactor and remove any duplication between the `deploy` and `config` directories;
* The `config` directory should now become the source of truth for the artifacts, where applicable, retargetting the kamel CLI accordingly;
* Make clear in README that the bundle directory should be generated on an as-needed basis rather than being checked-in (the CSV manifest resources are checked-in);

***UPDATE: splitting below off to #1979***
* Start to offer camel-k as an install with kustomize rather than needing to download the `kamel cli`, allowing install with standard tools;
  - This will require consideration of different production setups, tailoring the `config` directory to support patches for different use-cases, eg. including addons, installing on different types of cluster;
  - Need to gauge any comparable loss of flexibility as compared to the kamel cli;
                </div></div></li></ol></div><div><b>github_issues_comments:</b> <ol><li><div>
                Due to large change required for initial part of this issue, am splitting off kustomize effort into separate issue #1979.
              </div></li><li><div>
                This's been fixed by #1978.
              </div></li></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>