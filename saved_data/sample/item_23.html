<!DOCTYPE html><html><div class="item-title">
        Item 23
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                 Test in third and forth, make sure third is returned
              </div></li><li><div>
                 Test after forth make sure forth is returned
              </div></li><li><div>
                 Test in second and third, make sure second is returned
              </div></li><li><div>
                 Test at forth make sure forth is returned
              </div></li><li><div>
                 set block size to 64 to making 2 kvs into one block, bypassing the walkForwardInSingleRow
 in Store.rowAtOrBeforeFromStoreFile
              </div></li><li><div>
                 Test at third make sure third is returned
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> HBASE-9502. HStore.seekToScanner should handle magic value (Liang Xie)
                </div><div><b>message:</b> HBASE-9502. HStore.seekToScanner should handle magic value (Liang Xie)

git-svn-id: https://svn.apache.org/repos/asf/hbase/trunk@1546925 13f79535-47bb-0310-9956-ffa450edef68

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> HStore.seekToScanner should handle magic value
                </div><div><b>description:</b> due to faked key, the seekTo probably reture -2, and HStore.seekToScanner should handle this corner case.
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12602558/HBASE-9502.txt
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 3 new or modified tests.

    {color:green}+1 hadoop1.0{color}.  The patch compiles against the hadoop 1.0 profile.

    {color:green}+1 hadoop2.0{color}.  The patch compiles against the hadoop 2.0 profile.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 lineLengths{color}.  The patch does not introduce lines longer than 100

  {color:green}+1 site{color}.  The mvn site goal succeeds with this patch.

    {color:green}+1 core tests{color}.  The patch passed unit tests in .

Test results: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html
Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/7148//console

This message is automatically generated.
              </div></li><li><div>
                

Patch looks good to me.  [~xieliang007] High-level, what does this solve?  We are getting back wrong answer?  Thanks.

[~jdcryans] This have any relation to your half-file messing from a few weeks back?
              </div></li><li><div><div><b>body:</b> What's up with all the changes in TestFromClientSide?

I think some comments in the code would help its readability, like the fact that we are expecting -2 or a value equal or greater to 0.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                I changed the case, to:
1) let block size to smaller, such that each block could have 2 kv at least, else "walkForwardInSingleRow" will take effect:)
2) let the seekTo can reture -2(I just realize our internal generate faked key algo seems more aggressive, so it's easy to repro, i'll file another jira for that, and after that patch, you'll find without this change, the case will be fail always)
              </div></li><li><div>
                see HBASE-9518
              </div></li><li><div>
                [~stack] w/o this patch, we probably couldn't get the target row, e.g. for the updated case, w/o the change, we'll get NPE which means can't get any suitable row.
              </div></li><li><div>
                [~xieliang007] So, I can run the test and it will fail w/o this patch?  Thanks.
              </div></li><li><div>
                Hi [~stack], i thought you need to patch HBASE-9518 first, then run this test, and i thought it'll fail w/o the patch.
              </div></li><li><div>
                any more comments? thanks
              </div></li><li><div><div><b>body:</b> [~xieliang007] please fix the indentation in TestFromClientSide.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>body:</b> v2 fixed the style, thanks for reminding:)
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>body:</b> {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12604061/HBASE-9502-v2.txt
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 3 new or modified tests.

    {color:green}+1 hadoop1.0{color}.  The patch compiles against the hadoop 1.0 profile.

    {color:green}+1 hadoop2.0{color}.  The patch compiles against the hadoop 2.0 profile.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 lineLengths{color}.  The patch does not introduce lines longer than 100

  {color:green}+1 site{color}.  The mvn site goal succeeds with this patch.

    {color:green}+1 core tests{color}.  The patch passed unit tests in .

Test results: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html
Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/7301//console

This message is automatically generated.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                [~stack], [~jdcryans], could you help to review the latest patch ?  thanks
              </div></li><li><div>
                any more comments?
              </div></li><li><div>
                any update?
              </div></li><li><div>
                HBASE-9518 has been committed. Based on the above discussion and HadoopQA results, this patch is good to go. The patch applies with some fuzz. I'm going to regenerate it and submit it to HadoopQA again for another round of tests against current trunk. Assuming to commit afterward.
              </div></li><li><div>
                {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12616502/9502-v2.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 3 new or modified tests.

    {color:green}+1 hadoop1.0{color}.  The patch compiles against the hadoop 1.0 profile.

    {color:green}+1 hadoop2.0{color}.  The patch compiles against the hadoop 2.0 profile.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 lineLengths{color}.  The patch does not introduce lines longer than 100

    {color:red}-1 site{color}.  The patch appears to cause mvn site goal to fail.

    {color:green}+1 core tests{color}.  The patch passed unit tests in .

Test results: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html
Console output: https://builds.apache.org/job/PreCommit-HBASE-Build/8037//console

This message is automatically generated.
              </div></li><li><div>
                Committed to trunk.

bq. So, I can run the test and it will fail w/o this patch?

Yes.
              </div></li><li><div>
                Thanks for the patch [~xieliang007]
              </div></li><li><div>
                SUCCESS: Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #860 (See [https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/860/])
HBASE-9502. HStore.seekToScanner should handle magic value (Liang Xie) (apurtell: rev 1546925)
* /hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java
* /hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java

              </div></li><li><div>
                SUCCESS: Integrated in HBase-TRUNK #4707 (See [https://builds.apache.org/job/HBase-TRUNK/4707/])
HBASE-9502. HStore.seekToScanner should handle magic value (Liang Xie) (apurtell: rev 1546925)
* /hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java
* /hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java

              </div></li><li><div>
                This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).
              </div></li></ol></div></div></html>