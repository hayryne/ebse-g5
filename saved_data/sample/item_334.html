<!DOCTYPE html><html><div class="item-title">
        Item 334
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
 * Class which keep the information about the rows
 * while got deleted
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * Below method will be used to insert the rows
   * which are deleted
   *
   * @param data
   
              </div></li><li><div>
                *
   * below method will be used to check the row is deleted or not
   *
   * @param counter
   * @return
   
              </div></li><li><div>
                *
   * deleted rows bitset
   
              </div></li><li><div>
                *
 * class to hold information about delete delta files
 
              </div></li><li><div>
                
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 
              </div></li><li><div>
                *
   * delete delta files
   
              </div></li><li><div>
                *
   * latest delete delta file timestamp
   
              </div></li><li><div>
                *
   * @param deletedRowsMap
   
              </div></li><li><div>
                *
   * map of blockletidAndPageId to
   * deleted rows
   
              </div></li><li><div>
                *
   * @return latest deleted delta timestamp
   
              </div></li><li><div>
                *
   * @return the deleted record for block map
   
              </div></li><li><div>
                *
   * last fetch delete deltaFile timestamp
   
              </div></li><li><div>
                *
   * set the latest delete delta timestamp
   * @param deleteDeltaTimestamp
   
              </div></li><li><div>
                *
   * delete delta files path for this block
   
              </div></li><li><div>
                *
   * Below method will be used to get the latest delete delta file timestamp
   * @param deleteDeltaFiles
   * @return latest delete delta file time stamp
   
              </div></li><li><div>
                *
   * Below method will be used to read the delete delta files
   * and get the map of blockletid and page id mapping to deleted
   * rows
   *
   * @param deltaFiles delete delta files array
   * @return map of blockletid_pageid to deleted rows
   
              </div></li><li><div>
                *
   * @return deleted record map
   
              </div></li><li><div>
                *
   * @return delete delta files
   
              </div></li><li><div>
                *
   * set the delete delta files
   * @param deleteDeltaFilePath
   
              </div></li><li><div>
                *
   * @param deletedRecordsMap
   
              </div></li><li><div>
                *
   * delete delta file path
   
              </div></li><li><div>
                *
   * actual blocklet number
   
              </div></li><li><div>
                *
   * Below method will be used to check row got deleted
   *
   * @param rowId
   * @return is present in deleted row
   
              </div></li><li><div>
                *
   * blockletid+pageumber to deleted reocrd map
   
              </div></li><li><div>
                *
   * current page delete delta vo
   
              </div></li><li><div>
                 if deleted recors map is present for this block
 then get the first page deleted vo
              </div></li><li><div>
                 get the lock object so in case of concurrent query only one task will read the delete delta
 files other tasks will wait
              </div></li><li><div>
                 read the delete delta files
              </div></li><li><div>
                 if datablock deleted delta timestamp is more then the current delete delta files timestamp
 then return the current deleted rows
              </div></li><li><div>
                 set the deleted row to block execution info
              </div></li><li><div>
                 double checking
              </div></li><li><div>
                 check if timestamp of data block is less than the latest delete delta timestamp
 then update the delete delta details and timestamp in data block
              </div></li><li><div>
                 read and get the delete detail block details
              </div></li><li><div>
                 if lock object is null then add a lock object
              </div></li><li><div>
                 check the timestamp again
              </div></li><li><div>
                *
   * Below method will be used to get the delete delta rows for a block
   *
   * @param dataBlock       data block
   * @param deleteDeltaInfo delete delta info
   * @return blockid+pageid to deleted row mapping
   
              </div></li><li><div>
                 double checking to check the deleted rows is already present or not
              </div></li><li><div>
                 remove the lock
              </div></li><li><div>
                 if not then acquire the lock
              </div></li><li><div>
                 if delete delta file is present
              </div></li><li><div>
                *
   * Below method will be used to set deleted records map to data block
   * based on latest delta file timestamp
   *
   * @param deleteDeltaInfo
   * @param deletedRecordsMap
   * @param dataBlock
   
              </div></li><li><div>
                *
   * Below method will be used to get all the delete delta files based on block name
   *
   * @param blockFilePath actual block filePath
   * @return all delete delta files
   * @throws Exception
   
              </div></li><li><div>
                *
   * list of delete delta files for split
   
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue. This closes #1019
                </div><div><b>message:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue. This closes #1019

                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>title:</b> [CARBONDATA-1156]Improve IUD performance and fixed synchronization issue
                </div><div><b>body:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>github_pulls_comments:</b> <ol><li><div>
                
Refer to this link for build results (access rights to CI server needed): 
https://builds.apache.org/job/carbondata-pr-spark-1.6/264/

              </div></li><li><div>
                Build Failed  with Spark 2.1.0, Please check CI http://136.243.101.176:8080/job/ApacheCarbonPRBuilder/2385/

              </div></li><li><div>
                
Refer to this link for build results (access rights to CI server needed): 
https://builds.apache.org/job/carbondata-pr-spark-1.6/266/

              </div></li><li><div>
                Build Success with Spark 2.1.0, Please check CI http://136.243.101.176:8080/job/ApacheCarbonPRBuilder/2387/

              </div></li><li><div>
                
Refer to this link for build results (access rights to CI server needed): 
https://builds.apache.org/job/carbondata-pr-spark-1.6/287/

              </div></li><li><div>
                Build Failed  with Spark 2.1.0, Please check CI http://136.243.101.176:8080/job/ApacheCarbonPRBuilder/2408/

              </div></li><li><div>
                LGTM
              </div></li></ol></div><div><b>github_pulls_reviews:</b> <ol><li><div>
                remove semicolon
              </div></li><li><div>
                Again do `deleteDeltaToLockObjectMap.get(deleteDeltaInfo);` to avoid null pointer exception
              </div></li><li><div>
                ok. I missed it:)
              </div></li></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> IUD Performance Improvement And Synchonizaion issue 
                </div><div><b>description:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div></div></li><li><div><div><b>summary:</b> IUD Performance Improvement And Synchonizaion issue 
                </div><div><b>description:</b> Delete delta file loading is taking more time as it is read for blocklet level. Now added code to read block level.
In current IUD design delete delta files are getting listed for each block in executor level in case of parallel query and iud operation it may give wrong result. Now passing delete delta information from driver to executor
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol></ol></div></div></html>