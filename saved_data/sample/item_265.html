<!DOCTYPE html><html><div class="item-title">
        Item 265
      </div> <div class="item-details"><div><b>git_comments:</b> <ol><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 
              </div></li><li><div>
                 TODO :
 1. extract JavaDocs and put them into XML comments
 2. if _type = html -&gt; convert the XML buil here using MH's stylesheet
 3. generate grammars 
              </div></li><li><div>
                *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 
              </div></li><li><div>
                        System.out.println(r.getEntity().toString());
        File f = new File("test.xml");
        f.delete();
        f.createNewFile();
        System.out.println(f.getAbsolutePath());
        FileOutputStream fos = new FileOutputStream(f);
        fos.write(r.getEntity().toString().getBytes());
        fos.flush();
        fos.close();
              </div></li></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> Merged revisions 784184 via svnmerge from 
                </div><div><b>message:</b> Merged revisions 784184 via svnmerge from 
https://svn.apache.org/repos/asf/cxf/trunk

........
  r784184 | sergeyb | 2009-06-12 17:35:32 +0100 (Fri, 12 Jun 2009) | 1 line
  
  CXF-1695 : prototyping initial WADL support, a lot more to be done
........


git-svn-id: https://svn.apache.org/repos/asf/cxf/branches/2.2.x-fixes@785738 13f79535-47bb-0310-9956-ffa450edef68

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Service listings for JAX-RS endpoints
                </div><div><b>description:</b> The /services path does not work for listing JAX-RS services. Ultimately listing these endpoints along with the SOAP endpoints, et el, would be ideal
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                Same here. I'm using CXF 2.1.2
It will be nice if at least CXF didn't show an exception when I try to access "/services".

java.lang.NullPointerException
	at org.apache.cxf.service.model.EndpointInfo.getInterface(EndpointInfo.java:54)
	at org.apache.cxf.transport.servlet.ServletController$1.compare(ServletController.java:218)
	at org.apache.cxf.transport.servlet.ServletController$1.compare(ServletController.java:217)
...

              </div></li><li><div>
                Just to clarify, the /services path does not work AT ALL, and causes an NPE (see above comment), if you have JAX-RS services enabled.  It's not just that it doesn't list JAX-RS services, it doesn't work period if there are any JAX-RS services configured. 

While it would be convenient to list both types, WS and RS, it might also be good just to fix this so that WS services are still listed (even if RS aren't) -  when a project has RS services enabled (just ignore the RS ones for now). 
              </div></li><li><div>
                Why is this an "Improvement"??? This is clearly a bug, because that's a feature that does not work at all if you have just one REST service implemented. It does not work but fails with an NPE visible to the End-User. 

IMHO this should be a "major bug" the way it currently fails. 
              </div></li><li><div><div><b>body:</b> Sure - I've updated the level. 

The questions is what should be the default 'view', once the link pointing to a given JAXRS endpoint is selected

- 1.JavaDocs ?
- 2.WADL ?
- 3.Human readable description in the form of tables showing what methods are suppoted, content-type/accept values, etc

We expect some WADL support coming in but most likely for 2.2.1 or so.
Option 1 is probably the simplest one, while option 3 can be done on top of 2.

All options can be implemented as blocking CXF JAXRS RequestFilter implementations handling query like _javadocs, _wadl, _info

Unfortunately it's unlikely I will be able to allocate the time till 2.2 gets released on this issue.

Thus a patch will be welcomed if it's critical
  

                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                
Until JAX-RS supports something like WADL, it would be fine by me to just NOT show any of the jaxrs services.   Just show the jaxws stuff.


              </div></li><li><div><div><b>body:</b> Please take into account that I am relatively new to REST, so I may talk rubbish. :-)

It would be nice if the content you are showing is depending to the accept header of the request. If it's "text/html" go for 3. If it's "application/xml" or something go for 2. 

But that's not the point of my initial comment. It's not acceptable that a product crashes hard with an NPE just by using it correctly. This is simply a bug and should be fixed. As already suggested: Just ignore the REST services for the first fix, but don't crash. 

Implementing the features you've mentioned would be very nice but that's clearly an improvement and can be done later. This issue should be split up into a bug and an improvement issue. This would be totally ok for me.
                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                Andreas - NPE will go away in 2.2/2.1.5. We'll look seriously into enabling jaxrs services listings after 2.2 gets released
              </div></li><li><div><div><b>body:</b> Any news for this bug? 

CXF 2.2 ist out, but it still crashes hard with an NPE if the services URL ist called. Gives me a pretty hard stand to justify the usage of CXF in a productive environment here. 

Is it really this hard just to ignore REST services when creating the content for the services URL?

                </div><div><b>label:</b> code-design
                </div></div></li><li><div>
                It was really lame. I did reproduce NPE and thought I fixed it when adding a previous comment - but I think in that case it was just a single endpoint that was used, so another lurking NPE in compare() was ignored - fingers crossed, it's fixed now - will merge shortly. Also added a simple check to ensure no NPE occurs.
thanks for you patience :-)
              </div></li><li><div>
                We have an issues which is related to this bug.
Our REST URL looks like this:
   localhost:8280/website/getWebsiteByUrlZone/url/zone/

The method getWebsiteByUrlZone
gets two String parameters: url and zone
Now we have the situation in productions, that some users use a zone named 'services'
Now our Interface does not work any more.
Also switching the list functionality off in web.xml using "hide-service-list-page" does not work at inside the Code this is totally hardcoded:

ServletController.java:
                if (request.getRequestURI().endsWith("/services")
                    || request.getRequestURI().endsWith("/services/")

This statement:
     if (!isHideServiceList) {
should be put directly inside the invoke method, before the url is checked



              </div></li><li><div>
                
it's unfortunate... Perhaps switching the services listings did work for JAXWS services... Apart from fixing this actual 'switching off' bug, what we also need to do is to introduce some sort of 'classifier', with 'services' being the default value, but for users be able to provide custom values like '/listings' ...
For JAXRS-only services, we will support system queries like _services or _documentation, etc, but for JAXWS/JAXRS services having a custom classifier should help...
              </div></li><li><div>
                yes, I fully agree.
What about using a servlet init param like

&lt;init-param&gt; 
            &lt;param-name&gt;service-classifier-url-extension&lt;/param-name&gt; 
            &lt;param-value&gt;_services&lt;/param-value&gt; 
&lt;/init-param&gt; 
              </div></li><li><div>
                This is now done, HTML view for WADL instances will be done later.

'service-list-path' servlet parameter can be used to overwrite the default 'services' .
"hide-service-list-page" has the expected effect too
              </div></li></ol></div></div></html>