<!DOCTYPE html><html><div class="item-title">
        Item 183
      </div> <div class="item-details"><div><b>git_comments:</b> <ol></ol></div><div><b>git_commits:</b> <ol><li><div><div><b>summary:</b> fix for GROOVY-3214. Another fix caused lists in general to be wrapped a second time if they are of length 1 and if they are used in a enum. Such lists are also used for map elements in a putAt, which resulted in a map[1] beeing seen as map[([1])].
                </div><div><b>message:</b> fix for GROOVY-3214. Another fix caused lists in general to be wrapped a second time if they are of length 1 and if they are used in a enum. Such lists are also used for map elements in a putAt, which resulted in a map[1] beeing seen as map[([1])].

git-svn-id: http://svn.codehaus.org/groovy/branches/GROOVY_1_5_X/groovy@14480 a5544e8c-8a19-0410-ba12-f9af4593a198

                </div></div></li></ol></div><div><b>github_issues:</b> <ol></ol></div><div><b>github_issues_comments:</b> <ol></ol></div><div><b>github_pulls:</b> <ol></ol></div><div><b>github_pulls_comments:</b> <ol></ol></div><div><b>github_pulls_reviews:</b> <ol></ol></div><div><b>jira_issues:</b> <ol><li><div><div><b>summary:</b> Strange Groovy bug for Maps in a Enums method
                </div><div><b>description:</b> This was originally reported on the Grails JIRA at

http://jira.codehaus.org/browse/GRAILS-3716

The Groovy version which has this bug is thus the one bundled with Grails-1.1-beta-1, not sure of the actual version.

The attached app (Grails app) demonstrates the problem: call the something action on the main controller, and the assertion will fail. It is really strange, it seems the key of the Map is not "taku" but "[taku]"...
                </div></div></li></ol></div><div><b>jira_issues_comments:</b> <ol><li><div>
                fixed
              </div></li><li><div><div><b>body:</b> Exactly, you spotted the relevant code, and yes, the ARIAL element is not needed. And yes, this only happens with Enums, not classes
                </div><div><b>label:</b> code-design
                </div></div></li><li><div><div><b>body:</b> If I understand you right, then the relevant code should be {code:Java}public enum FontFamily
{
	ARIAL

	static public void obtainMyMap()
	{
		Map map = [:]
		map["taku"] = "dio"
		assert map.taku == "dio"
	}
}
FontFamily.obtainMyMap()
{code}

I can reproduce the problem with that, the ARIAL element is not needed, the problem goes away if FonFamily is a normal class
                </div><div><b>label:</b> code-design
                </div></div></li></ol></div></div></html>